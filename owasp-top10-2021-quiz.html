<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OWASP Top 10:2021 Knowledge Quiz</title>
<style>
    @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Source+Sans+3:wght@400;600;700;900&display=swap');
    :root { --header:#1a1a2e; --bg:#0f0f1a; --white:#16213e; --primary:#e94560; --success:#0f9b58; --danger:#e94560; --warning:#f5a623; --text:#e0e0e0; --card:#16213e; --accent:#533483; --border:#2a2a4a; }
    ::-webkit-scrollbar { width:10px; } ::-webkit-scrollbar-track { background:#0a0a15; } ::-webkit-scrollbar-thumb { background:#533483; border-radius:5px; border:2px solid #0a0a15; }
    * { box-sizing:border-box; }
    body { font-family:'Source Sans 3',sans-serif; background:var(--bg); color:var(--text); margin:0; display:flex; flex-direction:column; height:100vh; overflow:hidden; }
    .header { background:linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%); color:#fff; padding:15px 30px; display:flex; justify-content:space-between; align-items:center; box-shadow:0 4px 20px rgba(233,69,96,0.15); flex-shrink:0; z-index:10; border-bottom:2px solid var(--primary); }
    .header-title { font-family:'JetBrains Mono',monospace; font-size:1.4em; font-weight:700; letter-spacing:1px; }
    .header-title span { color:var(--primary); }
    .progress-text { font-family:'JetBrains Mono',monospace; font-size:1.1em; font-weight:700; color:var(--warning); background:rgba(0,0,0,0.4); padding:6px 18px; border-radius:6px; border:1px solid rgba(245,166,35,0.3); }
    .main { display:flex; flex:1; overflow:hidden; }
    .sidebar { width:260px; background:#111125; border-right:1px solid var(--border); overflow-y:auto; padding:12px; display:grid; grid-template-columns:repeat(5,1fr); gap:6px; align-content:start; flex-shrink:0; }
    .nav-btn { height:34px; border:1px solid var(--border); background:#1a1a2e; cursor:pointer; font-weight:700; font-size:0.82em; border-radius:5px; transition:all 0.15s; color:#8888aa; font-family:'JetBrains Mono',monospace; }
    .nav-btn:hover { background:#2a2a4a; color:#ccc; border-color:#533483; }
    .nav-btn.active { background:var(--primary); color:white; border-color:var(--primary); box-shadow:0 0 10px rgba(233,69,96,0.4); }
    .nav-btn.answered-correct { background:#0d2818; border-color:var(--success); color:#4ade80; }
    .nav-btn.answered-wrong { background:#2d1018; border-color:var(--danger); color:#f87171; }
    .nav-btn.flagged { border:2px solid var(--warning); box-shadow:0 0 8px rgba(245,166,35,0.3); }
    .content { flex:1; padding:35px; overflow-y:auto; display:flex; justify-content:center; align-items:flex-start; }
    .card { background:var(--card); max-width:900px; width:100%; padding:45px; border-radius:12px; box-shadow:0 8px 32px rgba(0,0,0,0.3); margin-bottom:40px; border:1px solid var(--border); }
    .q-meta { display:flex; justify-content:space-between; align-items:center; margin-bottom:22px; border-bottom:1px solid var(--border); padding-bottom:14px; }
    .tag { background:var(--primary); color:white; padding:5px 14px; border-radius:20px; font-size:0.8em; font-weight:700; text-transform:uppercase; letter-spacing:1px; font-family:'JetBrains Mono',monospace; }
    .q-num { color:#666; font-family:'JetBrains Mono',monospace; font-size:0.9em; }
    .q-text { font-size:1.25em; font-weight:600; margin-bottom:30px; line-height:1.55; color:#e8e8e8; }
    .option { width:100%; text-align:left; padding:16px 22px; margin-bottom:12px; background:#111125; border:2px solid var(--border); border-radius:8px; cursor:pointer; font-size:1.05em; transition:all 0.2s; color:#c0c0d0; display:block; font-family:'Source Sans 3',sans-serif; }
    .option:hover:not(.locked) { border-color:#533483; background:#1a1a35; color:#e0e0e0; }
    .option.locked { cursor:default; }
    .option.opt-correct { border-color:var(--success); background:rgba(15,155,88,0.15); color:#4ade80; font-weight:700; }
    .option.opt-wrong { border-color:var(--danger); background:rgba(233,69,96,0.1); color:#f87171; }
    .option.opt-dim { opacity:0.5; }
    .explanation-box { margin-top:24px; padding:18px 22px; background:rgba(83,52,131,0.15); border:1px solid rgba(83,52,131,0.3); border-radius:8px; font-size:1em; color:#c8c0d8; line-height:1.6; }
    .explanation-box strong { color:#e0d0f0; }
    .next-btn-wrap { text-align:center; margin-top:22px; }
    .footer { background:#111125; padding:14px 35px; border-top:1px solid var(--border); display:flex; justify-content:space-between; align-items:center; flex-shrink:0; }
    .btn { padding:11px 28px; border:none; border-radius:6px; font-size:1.05em; font-weight:700; cursor:pointer; color:white; font-family:'Source Sans 3',sans-serif; transition:all 0.2s; }
    .btn:hover { transform:translateY(-1px); }
    .btn-s { background:#2a2a4a; } .btn-s:hover { background:#3a3a5a; }
    .btn-p { background:var(--primary); } .btn-p:hover { background:#d13555; }
    .btn-w { background:var(--warning); color:#111; } .btn-w:hover { background:#e09515; }
    .btn-g { background:var(--success); } .btn-g:hover { background:#0d8a4e; }
    #start-screen, #results-screen { position:fixed; top:0; left:0; width:100%; height:100%; background:var(--bg); z-index:2000; overflow-y:auto; }
    .center-wrapper { display:flex; flex-direction:column; align-items:center; justify-content:center; min-height:100vh; padding:40px; box-sizing:border-box; }
    .start-box { background:var(--card); padding:60px; border-radius:16px; box-shadow:0 20px 60px rgba(0,0,0,0.4); max-width:850px; text-align:center; border:1px solid var(--border); position:relative; overflow:hidden; }
    .start-box::before { content:''; position:absolute; top:0; left:0; right:0; height:4px; background:linear-gradient(90deg, var(--primary), var(--accent), var(--primary)); }
    .start-box h1 { color:#fff; margin-bottom:8px; font-size:2.8em; font-family:'JetBrains Mono',monospace; letter-spacing:2px; }
    .start-box h1 span { color:var(--primary); }
    .start-box .subtitle { font-size:1em; color:#666; margin-bottom:30px; font-family:'JetBrains Mono',monospace; letter-spacing:3px; text-transform:uppercase; }
    .start-box p { font-size:1.15em; line-height:1.7; color:#999; margin:25px 0; }
    .start-box .stats { display:flex; justify-content:center; gap:40px; margin:30px 0; }
    .start-box .stat { text-align:center; }
    .start-box .stat-num { font-size:2.2em; font-weight:900; color:var(--primary); font-family:'JetBrains Mono',monospace; }
    .start-box .stat-label { font-size:0.85em; color:#666; text-transform:uppercase; letter-spacing:2px; margin-top:4px; }
    .score-circle { width:200px; height:200px; border-radius:50%; display:flex; justify-content:center; align-items:center; font-size:3.8em; font-weight:900; color:white; margin:20px auto; box-shadow:0 10px 30px rgba(0,0,0,0.3); font-family:'JetBrains Mono',monospace; background:linear-gradient(135deg, var(--accent), #3a2066); border:6px solid #2a1850; }
    .review-item { text-align:left; background:var(--card); padding:22px; margin-bottom:16px; border-radius:10px; border-left:6px solid #444; width:100%; max-width:800px; box-shadow:0 2px 10px rgba(0,0,0,0.2); border:1px solid var(--border); }
    .review-item.correct { border-left-color:var(--success); }
    .review-item.wrong { border-left-color:var(--danger); }
    .review-item strong { color:#e0e0e0; }
    .review-explanation { margin-top:12px; font-size:0.92em; color:#aaa; background:rgba(83,52,131,0.15); padding:14px; border-radius:6px; border:1px solid rgba(83,52,131,0.3); }
    #status { font-weight:700; color:#666; font-size:1.05em; font-family:'JetBrains Mono',monospace; }
</style>
</head>
<body>

<div id="start-screen">
    <div class="center-wrapper">
        <div class="start-box">
            <h1><span>OWASP</span> Top 10:2021</h1>
            <div class="subtitle">Web Application Security Risks</div>
            <div class="stats">
                <div class="stat"><div class="stat-num">120</div><div class="stat-label">Questions</div></div>
                <div class="stat"><div class="stat-num">Self-paced</div><div class="stat-label">No Timer</div></div>
            </div>
            <p>
                Covers all 10 categories: Broken Access Control, Cryptographic Failures, Injection,
                Insecure Design, Security Misconfiguration, Vulnerable Components, Authentication Failures,
                Software Integrity Failures, Logging Failures &amp; SSRF.<br>
                <em style="color:#666;">Questions selected from a pool of 230+. Explanation shown after each answer.</em>
            </p>
            <button class="btn btn-p" onclick="initExam()" style="padding:16px 55px; font-size:1.25em; margin-top:10px;">Start Quiz</button>
        </div>
    </div>
</div>

<div class="header">
    <div class="header-title"><span>OWASP</span> Top 10 Quiz</div>
    <div id="progress-display" class="progress-text">0 / 120</div>
</div>

<div class="main" id="exam-ui" style="display:none;">
    <div class="sidebar" id="sidebar"></div>
    <div class="content" id="question-container"></div>
</div>

<div class="footer" id="footer" style="display:none;">
    <div><button class="btn btn-s" onclick="nav(-1)">Previous</button> <button class="btn btn-w" onclick="flag()" style="margin-left:10px;">Flag</button></div>
    <div id="status">Q 1 / 120</div>
    <div><button class="btn btn-g" id="finish-btn" onclick="finish()" style="display:none;">Finish Quiz</button></div>
</div>

<div id="results-screen" style="display:none;">
    <div class="center-wrapper" style="justify-content:flex-start; padding-top:50px;">
        <div style="background:var(--card); padding:40px; border-radius:12px; max-width:800px; width:100%; box-shadow:0 10px 40px rgba(0,0,0,0.3); text-align:center; border:1px solid var(--border);">
            <h1 style="margin:0; color:#fff; font-family:'JetBrains Mono',monospace;">Quiz Results</h1>
            <div id="score-circle" class="score-circle">0%</div>
            <div id="raw-score" style="font-size:1.2em; color:#aaa; margin-bottom:25px; font-family:'JetBrains Mono',monospace;"></div>
            <button class="btn btn-p" onclick="location.reload()">Take New Quiz</button>
        </div>
        <div id="review-list" style="width:100%; max-width:800px; margin-top:25px;"></div>
    </div>
</div>

<script>
// ==============================================================
// QUESTIONS - OWASP TOP 10:2021 - ALL OPTIONS LENGTH-BALANCED
// ==============================================================
const pool_part_1 = [
    // --- A01: BROKEN ACCESS CONTROL (25) ---
    {c:"A01 Broken Access Control", q:"In the OWASP Top 10:2021, which position does Broken Access Control hold?", a:"A01 — first position, up from fifth in 2017.", d:["A03 — third position, up from seventh in 2017.", "A05 — fifth position, unchanged from 2017.", "A07 — seventh position, down from fifth in 2017."], e:"Broken Access Control moved up from fifth in 2017 to the number one position in 2021."},
    {c:"A01 Broken Access Control", q:"How many CWEs are mapped to the A01:2021 Broken Access Control category?", a:"34 CWEs are mapped to this category.", d:["10 CWEs are mapped to this category.", "22 CWEs are mapped to this category.", "40 CWEs are mapped to this category."], e:"A01 has 34 mapped CWEs, more occurrences in applications than any other category with over 318k."},
    {c:"A01 Broken Access Control", q:"Which three notable CWEs does OWASP highlight for A01:2021?", a:"CWE-200 (Info Exposure), CWE-201 (Sent Data Leak), CWE-352 (CSRF).", d:["CWE-79 (Stored XSS), CWE-89 (SQL Injection), CWE-94 (Code Injection).", "CWE-259 (Hardcoded Creds), CWE-327 (Risky Crypto), CWE-331 (Low Entropy).", "CWE-502 (Deserialization), CWE-829 (Untrusted Include), CWE-494 (No Integrity)."], e:"OWASP specifically lists CWE-200, CWE-201, and CWE-352 as notable CWEs for Broken Access Control."},
    {c:"A01 Broken Access Control", q:"What percentage of applications were tested for broken access control in the 2021 dataset?", a:"94% of applications were tested.", d:["50% of applications were tested.", "75% of applications were tested.", "82% of applications were tested."], e:"94% of applications were tested for broken access control, with an average incidence rate of 3.81%."},
    {c:"A01 Broken Access Control", q:"According to OWASP, what is the recommended default access control policy?", a:"Deny by default except for resources intended to be publicly accessible.", d:["Allow by default with explicit denials only for the most sensitive resources.", "Grant read access to authenticated users and restrict writes to admins.", "Use role-based access with broad initial roles that narrow over time."], e:"OWASP recommends the principle of least privilege or deny by default for access control."},
    {c:"A01 Broken Access Control", q:"An attacker modifies a URL parameter from acct=myacct to acct=notmyacct to view another user's data. Which vulnerability is this?", a:"Insecure Direct Object Reference under Broken Access Control (A01).", d:["Server-Side Request Forgery exploiting internal parameter handling (A10).", "Injection via parameter tampering of the query string value (A03).", "Security Misconfiguration due to exposed URL parameters (A05)."], e:"This is OWASP scenario #1 for A01: using unverified data in a SQL call to access another user's account."},
    {c:"A01 Broken Access Control", q:"Which of the following is a Broken Access Control vulnerability according to OWASP?", a:"CORS misconfiguration that permits API access from untrusted origins.", d:["Password storage using MD5 without any salting or stretching applied.", "Failing to sanitize XML input that enables entity expansion attacks.", "Absence of logging on failed authentication attempts to the system."], e:"CORS misconfiguration is explicitly listed as a common access control vulnerability in A01."},
    {c:"A01 Broken Access Control", q:"OWASP recommends that access control mechanisms should be implemented in what manner?", a:"Implemented once centrally and then re-used across the application.", d:["Custom-built individually for each endpoint and resource type.", "Handled entirely client-side using JavaScript validation functions.", "Delegated to external third-party middleware and proxy services."], e:"OWASP states: implement access control mechanisms once and re-use them throughout the application."},
    {c:"A01 Broken Access Control", q:"What does OWASP recommend regarding JWT tokens to prevent access control attacks?", a:"Make stateless JWTs short-lived and use OAuth standards for revocation.", d:["Set JWTs to never expire so users avoid repeated re-authentication.", "Store JWTs in browser localStorage for long-term session persistence.", "Share JWT signing secrets across all microservices for consistency."], e:"Short-lived JWTs minimize the window of opportunity for attackers; OAuth standards help revoke longer lived tokens."},
    {c:"A01 Broken Access Control", q:"An unauthenticated user accesses /app/admin_getappInfo directly. What type of flaw is this?", a:"Force browsing to privileged pages without any authentication check.", d:["CORS misconfiguration exposing admin endpoints to external origins.", "JWT metadata manipulation to bypass role-based access restrictions.", "Insecure Direct Object Reference exposing admin data via an API."], e:"This is OWASP scenario #2: force browsing to admin pages that should require authentication and authorization."},
    {c:"A01 Broken Access Control", q:"Which CWE describes the forced browsing vulnerability listed under A01?", a:"CWE-425: Direct Request, commonly known as Forced Browsing.", d:["CWE-89: Improper Neutralization of SQL Query Special Elements.", "CWE-79: Improper Neutralization of Input During Web Page Output.", "CWE-502: Deserialization of Untrusted Data from External Sources."], e:"CWE-425 specifically covers forced browsing, which is mapped to the A01 Broken Access Control category."},
    {c:"A01 Broken Access Control", q:"What does OWASP recommend regarding web server directory listings?", a:"Disable directory listing and remove .git and backup files from web roots.", d:["Enable directory listings only for users with valid session credentials.", "Allow directory listings but apply a filter to show only HTML documents.", "Place a CAPTCHA challenge on all directory listing and index pages."], e:"OWASP explicitly recommends disabling directory listings and removing sensitive metadata from web roots."},
    {c:"A01 Broken Access Control", q:"How should access control failures be handled according to OWASP prevention guidance?", a:"Log each failure event and alert administrators on repeated attempts.", d:["Silently deny the request without recording any log entries at all.", "Show the user a detailed error page explaining why access was refused.", "Redirect to a public landing page without creating an audit record."], e:"Logging failures and alerting admins enables detection of potential attacks against access controls."},
    {c:"A01 Broken Access Control", q:"Which access control vulnerability involves replaying or tampering with a JWT token to elevate privileges?", a:"Metadata manipulation, including JWT, cookie, and hidden field abuse.", d:["Force browsing via direct URL access to restricted admin endpoints.", "CORS misconfiguration enabling cross-origin API calls from attackers.", "Insecure Direct Object Reference through predictable resource paths."], e:"OWASP lists metadata manipulation including JWT tampering, cookie manipulation, and hidden field abuse under A01."},
    {c:"A01 Broken Access Control", q:"What does OWASP say about where access control should be enforced?", a:"Server-side code or serverless API, where attackers cannot modify checks.", d:["Client-side JavaScript for responsive and immediate user feedback.", "Browser-level HTML5 form validation before any request is submitted.", "CDN edge layer to intercept requests before reaching the application."], e:"Access control is only effective when enforced server-side where attackers cannot tamper with it."},
    {c:"A01 Broken Access Control", q:"OWASP recommends model access controls should enforce what principle?", a:"Record ownership, so users can only access their own data records.", d:["Universal read permissions with write restrictions for admin accounts.", "Time-based expiry where record access is revoked after thirty days.", "Geographic restrictions that limit data access based on user IP range."], e:"Enforcing record ownership ensures users can only access their own data, preventing horizontal privilege escalation."},
    {c:"A01 Broken Access Control", q:"What testing approach does OWASP recommend for access control?", a:"Include functional access control unit and integration tests in the SDLC.", d:["Rely solely on annual penetration testing performed by external firms.", "Use automated vulnerability scanning tools as the only testing method.", "Conduct manual code review exclusively without any automated testing."], e:"OWASP explicitly recommends functional access control unit and integration tests in the development process."},
    {c:"A01 Broken Access Control", q:"Accessing an API with missing access controls for POST, PUT, and DELETE is an example of which vulnerability?", a:"Broken Access Control — missing function-level controls on API methods.", d:["Injection — API parameter manipulation through crafted request bodies.", "Security Misconfiguration — incorrect HTTP method definitions on server.", "Insecure Design — absent API gateway and request validation middleware."], e:"Missing access controls on API HTTP methods is explicitly listed as a common access control vulnerability in A01."},
    {c:"A01 Broken Access Control", q:"Which CWE mapped to A01 describes authorization bypass through a user-controlled key?", a:"CWE-639: Authorization Bypass Through User-Controlled Key.", d:["CWE-352: Cross-Site Request Forgery via State-Changing Requests.", "CWE-601: URL Redirection to Untrusted Site via Open Redirect.", "CWE-548: Exposure of Information Through Directory Listing Page."], e:"CWE-639 covers scenarios where users manipulate keys/IDs to access other users' resources (IDOR pattern)."},
    {c:"A01 Broken Access Control", q:"What was the average incidence rate for Broken Access Control in the 2021 dataset?", a:"3.81% average incidence rate.", d:["0.50% average incidence rate.", "10.2% average incidence rate.", "19.0% average incidence rate."], e:"A01 had an average incidence rate of 3.81% across 94% of tested applications, with over 318k total occurrences."},
    {c:"A01 Broken Access Control", q:"CWE-601, mapped to A01, describes which vulnerability?", a:"URL Redirection to Untrusted Site, also called Open Redirect.", d:["Improper Neutralization of SQL Elements in Database Queries.", "Improper Neutralization of Input During Web Page Generation.", "Improper Limitation of Pathname to a Restricted Directory."], e:"CWE-601 covers open redirect vulnerabilities where users are redirected to untrusted external sites."},
    {c:"A01 Broken Access Control", q:"What OWASP recommendation helps minimize harm from automated attack tooling against access controls?", a:"Rate limit API and controller access to slow automated attacks.", d:["Implement CAPTCHA challenges on every user-facing page interaction.", "Switch from REST APIs to WebSocket connections for all endpoints.", "Apply symmetric encryption to all URL parameters before transmission."], e:"Rate limiting is specifically recommended by OWASP to minimize harm from automated tools targeting access controls."},
    {c:"A01 Broken Access Control", q:"Which CWE under A01 relates to sensitive cookie handling?", a:"CWE-1275: Sensitive Cookie with Improper SameSite Attribute.", d:["CWE-79: Cross-Site Scripting via Reflected Input in Response.", "CWE-327: Use of a Broken or Risky Cryptographic Algorithm.", "CWE-502: Deserialization of Untrusted Data from User Input."], e:"CWE-1275 is mapped to A01 and addresses cookies that lack proper SameSite attributes, enabling CSRF-style attacks."},
    {c:"A01 Broken Access Control", q:"What does elevation of privilege mean in the context of A01?", a:"Acting as a user without login, or as an admin from a standard account.", d:["Gaining root access to the operating system of the underlying server.", "Escalating network-level privileges through VLAN hopping techniques.", "Obtaining physical access to the server hardware in the data centre."], e:"OWASP defines elevation of privilege as acting without login or as admin when authenticated as a regular user."},
    {c:"A01 Broken Access Control", q:"Which CWE under A01 covers Path Traversal attacks?", a:"CWE-22: Improper Limitation of Pathname to a Restricted Directory.", d:["CWE-200: Exposure of Sensitive Information to an Unauthorized Actor.", "CWE-352: Cross-Site Request Forgery on State-Changing Operations.", "CWE-913: Improper Control of Dynamically-Managed Code Resources."], e:"CWE-22 covers path traversal attacks and is mapped to the A01 Broken Access Control category."},

    // --- A02: CRYPTOGRAPHIC FAILURES (23) ---
    {c:"A02 Cryptographic Failures", q:"What was A02:2021 formerly known as in the 2017 Top 10?", a:"A3:2017 Sensitive Data Exposure, which described the symptom rather than cause.", d:["A6:2017 Security Misconfiguration, which was merged with crypto failures.", "A2:2017 Broken Authentication, which included credential storage flaws.", "A9:2017 Using Known Vulnerable Components with outdated cipher suites."], e:"Cryptographic Failures was previously called Sensitive Data Exposure; the rename shifts focus from symptom to root cause."},
    {c:"A02 Cryptographic Failures", q:"Which three notable CWEs does OWASP highlight for A02:2021?", a:"CWE-259 (Hardcoded Password), CWE-327 (Risky Crypto), CWE-331 (Low Entropy).", d:["CWE-200 (Info Exposure), CWE-201 (Sent Data Leak), CWE-352 (CSRF).", "CWE-79 (Stored XSS), CWE-89 (SQL Injection), CWE-94 (Code Injection).", "CWE-502 (Deserialization), CWE-829 (Untrusted Include), CWE-494 (No Integrity)."], e:"OWASP lists CWE-259, CWE-327, and CWE-331 as notable CWEs for Cryptographic Failures."},
    {c:"A02 Cryptographic Failures", q:"What is the first step OWASP recommends for preventing cryptographic failures?", a:"Determine the protection needs of data both in transit and at rest.", d:["Install the latest version of all cryptographic libraries and drivers.", "Enforce TLS 1.3 on every server endpoint within the organisation.", "Engage an external cryptography consultant for an architecture review."], e:"The first step is classifying data and identifying protection needs before selecting controls."},
    {c:"A02 Cryptographic Failures", q:"Which of the following is a cryptographic failure according to OWASP?", a:"Using an insecure block cipher mode of operation such as ECB.", d:["Using AES-256 with GCM mode and authenticated encryption throughout.", "Implementing TLS 1.3 with only AEAD cipher suites on all endpoints.", "Generating all cryptographic keys using a secure CSPRNG function."], e:"ECB mode encrypts identical plaintext blocks to identical ciphertext blocks, leaking patterns."},
    {c:"A02 Cryptographic Failures", q:"How many CWEs are mapped to A02:2021 Cryptographic Failures?", a:"29 CWEs are mapped to this category.", d:["10 CWEs are mapped to this category.", "22 CWEs are mapped to this category.", "40 CWEs are mapped to this category."], e:"A02 has 29 mapped CWEs covering various cryptographic weaknesses."},
    {c:"A02 Cryptographic Failures", q:"Which of the following is a data-in-transit cryptographic failure according to OWASP?", a:"Transmitting data in cleartext via HTTP, SMTP, or FTP protocols.", d:["Transmitting data encrypted via TLS 1.2 with a strong cipher suite.", "Sending encrypted API payloads over HTTPS with certificate pinning.", "Forwarding logs through an encrypted syslog channel using TLS 1.3."], e:"OWASP lists clear-text transmission using HTTP, SMTP, and FTP as a common cryptographic failure."},
    {c:"A02 Cryptographic Failures", q:"OWASP recommends which type of algorithms for password hashing?", a:"Adaptive salted hashing: Argon2, scrypt, bcrypt, or PBKDF2.", d:["Fast general-purpose hashes: SHA-256 with a static application salt.", "Keyed HMAC using SHA-512 with a server-side secret key applied.", "Unsalted hashing with multiple iterations of the MD5 hash function."], e:"OWASP recommends strong adaptive and salted hashing functions with a work factor for password storage."},
    {c:"A02 Cryptographic Failures", q:"What does OWASP say about using a cryptographic hash directly as a key derivation function for passwords?", a:"It is a failure — a dedicated password-based KDF should be used instead.", d:["It is acceptable when the original password exceeds twenty characters.", "It is recommended as the simplest approach for small-scale applications.", "It is fine as long as the password has been salted before being hashed."], e:"Using a cryptographic hash function directly rather than a password-based KDF is explicitly a failure."},
    {c:"A02 Cryptographic Failures", q:"In OWASP scenario #1 for A02, what does a TLS downgrade attack expose?", a:"The user's session cookie, which an attacker replays to hijack the session.", d:["The user's bcrypt password hash stored in the application's database.", "The server's private TLS certificate key used for session negotiation.", "The database's column-level encryption key used for data-at-rest protection."], e:"In the TLS downgrade scenario, the attacker intercepts and replays the session cookie."},
    {c:"A02 Cryptographic Failures", q:"What is OWASP's primary recommendation for sensitive data that is not needed?", a:"Do not store it — data that is not retained cannot be stolen later.", d:["Store it in an encrypted archive with a rotated key and audit log.", "Move it to air-gapped cold storage with restricted physical access.", "Anonymize it using tokenization then store it in a separate database."], e:"OWASP emphasizes not retaining unnecessary data as the most effective protection."},
    {c:"A02 Cryptographic Failures", q:"According to OWASP, what should be verified about encryption key management?", a:"Keys should be generated properly and stored securely with rotation in place.", d:["Keys should be embedded in source code for consistent access by services.", "Keys should be shared across all environments to simplify deployment.", "Keys only need to be created once and reused indefinitely across systems."], e:"Proper key generation, secure storage, and key rotation are all part of OWASP's prevention guidance."},
    {c:"A02 Cryptographic Failures", q:"OWASP lists which of the following as deprecated cryptographic elements?", a:"MD5, SHA-1, and PKCS #1 v1.5 padding are listed as deprecated.", d:["AES-256, SHA-512, and RSA-OAEP padding are listed as deprecated.", "ChaCha20, Poly1305, and Ed25519 signatures are listed as deprecated.", "Argon2, HKDF, and X25519 key exchange are listed as deprecated."], e:"OWASP explicitly lists MD5, SHA-1, and PKCS number 1 v1.5 as deprecated cryptographic functions and padding."},
    {c:"A02 Cryptographic Failures", q:"Why was Sensitive Data Exposure renamed to Cryptographic Failures in 2021?", a:"To focus on root cause (crypto failures) instead of the symptom (data exposure).", d:["Because the category was merged with A01 Broken Access Control findings.", "Because sensitive data protection is no longer a significant application risk.", "To align OWASP terminology with PCI DSS requirement naming conventions."], e:"The rename shifts focus from the broad symptom of data exposure to the specific root cause of cryptographic failures."},
    {c:"A02 Cryptographic Failures", q:"In OWASP scenario #1 for A02, what enables an attacker to retrieve credit card numbers from a database?", a:"Automatic decryption on retrieval combined with a SQL injection flaw.", d:["A cross-site scripting flaw that exfiltrates card data from the DOM.", "Broken authentication allowing unauthenticated access to the API.", "An insecure design flaw in the payment processing workflow logic."], e:"In scenario #1, the database auto-decrypts on retrieval, so a SQL injection flaw directly exposes plaintext card numbers."},
    {c:"A02 Cryptographic Failures", q:"OWASP scenario #3 for A02 describes a password database using what flawed approach?", a:"Unsalted or simple hashes, which are vulnerable to rainbow table attacks.", d:["Over-salted bcrypt hashes that exceed the maximum 72-byte input limit.", "AES-encrypted passwords stored with the encryption key in the same row.", "Plaintext passwords stored in an unencrypted flat file on the server."], e:"Scenario #3 describes a database using unsalted hashes that a GPU farm can crack with rainbow tables."},
    {c:"A02 Cryptographic Failures", q:"Which OWASP recommendation addresses protecting data in transit?", a:"Encrypt all data in transit with TLS and enforce it using HSTS headers.", d:["Compress all data in transit with gzip to reduce interception surface.", "Obfuscate data in transit using Base64 encoding before transmission.", "Sign all data in transit using HMAC but transmit over plain HTTP."], e:"OWASP recommends encrypting data in transit with secure protocols like TLS, with enforcement via directives like HSTS."},
    {c:"A02 Cryptographic Failures", q:"What does OWASP say about initialization vectors for cryptographic operations?", a:"Use proper initialization vectors appropriate to the mode of operation.", d:["Reuse the same initialization vector for all operations with one key.", "Use a fixed all-zeroes initialization vector for deterministic results.", "Skip initialization vectors entirely when using block cipher algorithms."], e:"OWASP specifies that appropriate IVs must be used, and that their configuration must match the mode of operation."},
    {c:"A02 Cryptographic Failures", q:"What does OWASP recommend about caching responses containing sensitive data?", a:"Disable caching for responses that carry any sensitive or personal data.", d:["Cache sensitive responses for up to five minutes to reduce server load.", "Cache all responses by default and purge cache entries once per day.", "Allow caching only at the CDN level with encrypted cache storage."], e:"OWASP recommends disabling caching for responses containing sensitive data to prevent exposure via cache stores."},
    {c:"A02 Cryptographic Failures", q:"According to OWASP, which data classification categories require cryptographic protection?", a:"Data covered by privacy laws, regulations, or specific business needs.", d:["Only data classified as top-secret under government security schemes.", "Only personally identifiable information stored in relational databases.", "Only financial transaction records processed through payment gateways."], e:"OWASP recommends classifying data per privacy laws, regulatory requirements, or business needs to determine protection."},
    {c:"A02 Cryptographic Failures", q:"What is the maximum incidence rate for A02 Cryptographic Failures in the 2021 dataset?", a:"46.44% maximum incidence across tested applications.", d:["19.09% maximum incidence across tested applications.", "10.25% maximum incidence across tested applications.", "67.31% maximum incidence across tested applications."], e:"A02 had a maximum incidence rate of 46.44% across the applications tested."},
    {c:"A02 Cryptographic Failures", q:"OWASP warns against using which type of encryption for sensitive data at rest?", a:"Deprecated algorithms such as DES, MD5, and SHA-1 for any protection.", d:["Modern algorithms such as AES-256, ChaCha20, and SHA-3 for protection.", "Authenticated encryption modes like GCM combined with AEAD ciphers.", "Post-quantum algorithms such as CRYSTALS-Kyber for key encapsulation."], e:"OWASP warns against using old or deprecated algorithms including DES, MD5, and SHA-1."},
    {c:"A02 Cryptographic Failures", q:"How does OWASP recommend handling encryption key generation?", a:"Always generate keys using cryptographically secure pseudo-random number generators.", d:["Derive keys deterministically from the application's database connection string.", "Use the current timestamp as a seed for standard pseudo-random generators.", "Generate keys from user-chosen passphrases hashed once with MD5 or SHA-1."], e:"OWASP requires that encryption keys be created using CSPRNGs to ensure sufficient entropy and unpredictability."},
    {c:"A02 Cryptographic Failures", q:"What does OWASP say about using authenticated encryption versus just encryption?", a:"Always use authenticated encryption rather than plain encryption alone.", d:["Use plain encryption without authentication for better performance.", "Authentication is only needed for data in transit, not data at rest.", "Authenticated encryption is optional and adds unnecessary complexity."], e:"OWASP explicitly recommends always using authenticated encryption instead of just encryption."},

    // --- A03: INJECTION (24) ---
    {c:"A03 Injection", q:"What position did Injection hold in the 2017 Top 10 compared to 2021?", a:"It was A1 in 2017 and dropped to A3 in 2021.", d:["It was A3 in 2017 and remained at A3 in 2021.", "It was A7 in 2017 and rose to A3 in 2021.", "It was A5 in 2017 and moved to A3 in 2021."], e:"Injection dropped from the number one position in 2017 to third in 2021."},
    {c:"A03 Injection", q:"Which previously separate category was merged into A03:2021 Injection?", a:"A7:2017 Cross-Site Scripting (XSS) was folded into Injection.", d:["A4:2017 XML External Entities was folded into Injection.", "A5:2017 Broken Access Control was folded into Injection.", "A8:2017 Insecure Deserialization was folded into Injection."], e:"XSS was merged into the Injection category in 2021 as it is fundamentally an injection vulnerability."},
    {c:"A03 Injection", q:"What is the maximum incidence rate for A03 Injection in the 2021 dataset?", a:"19.09% maximum incidence across tested applications.", d:["3.81% maximum incidence across tested applications.", "46.44% maximum incidence across tested applications.", "32.75% maximum incidence across tested applications."], e:"A03 had a 19% maximum incidence rate, with 94% of applications tested for some form of injection."},
    {c:"A03 Injection", q:"Which notable CWEs does OWASP highlight for A03:2021 Injection?", a:"CWE-79 (XSS), CWE-89 (SQL Injection), and CWE-73 (External Control).", d:["CWE-200 (Info Exposure), CWE-201 (Data Leak), and CWE-352 (CSRF).", "CWE-259 (Hardcoded Password), CWE-327 (Risky Crypto), CWE-331 (Entropy).", "CWE-502 (Deserialization), CWE-829 (Untrusted Include), CWE-494 (Integrity)."], e:"OWASP highlights CWE-79 (XSS), CWE-89 (SQL Injection), and CWE-73 (External Control of File Name) for A03."},
    {c:"A03 Injection", q:"What is OWASP's primary prevention recommendation against injection attacks?", a:"Use parameterized queries or prepared statements to separate data from commands.", d:["Validate all input using client-side JavaScript before form submission occurs.", "Encode all output to HTML entities regardless of the output context type.", "Implement a Web Application Firewall as the sole line of injection defence."], e:"Parameterized queries/prepared statements are OWASP's top recommendation as they keep data separate from commands."},
    {c:"A03 Injection", q:"Which OWASP-recommended approach uses stored procedures safely to prevent SQL injection?", a:"Parameterized stored procedures that do not include dynamic SQL construction.", d:["Stored procedures that concatenate user input directly into query strings.", "Stored procedures that rely on input validation only, not parameterization.", "Stored procedures that use EXECUTE IMMEDIATE with sanitized user variables."], e:"Stored procedures are safe only when they use parameterized queries and avoid constructing dynamic SQL internally."},
    {c:"A03 Injection", q:"According to OWASP, what server-side validation approach helps prevent injection?", a:"Use positive allow-list input validation as an additional defence layer.", d:["Use a deny-list of known bad characters as the primary defence layer.", "Rely on the database driver's built-in auto-escaping for all queries.", "Perform input validation only at the client-side boundary for efficiency."], e:"OWASP recommends positive server-side input validation as additional defence, noting it's not complete since many apps need special characters."},
    {c:"A03 Injection", q:"For dynamic queries where parameterization is not possible, what does OWASP recommend?", a:"Escape special characters using the specific escape syntax for that interpreter.", d:["Concatenate user input directly but wrap it in single quotes for safety.", "Use Base64 encoding on all user inputs before inserting them into queries.", "Apply SHA-256 hashing to user inputs before passing them to the database."], e:"When parameterized queries aren't available, OWASP recommends interpreter-specific escaping of special characters."},
    {c:"A03 Injection", q:"How many CWEs are mapped to the A03:2021 Injection category?", a:"33 CWEs are mapped to this category.", d:["11 CWEs are mapped to this category.", "22 CWEs are mapped to this category.", "44 CWEs are mapped to this category."], e:"A03 has 33 mapped CWEs covering SQL, NoSQL, OS command, LDAP, XSS, and other injection types."},
    {c:"A03 Injection", q:"OWASP recommends using which SQL clause to limit mass data disclosure from injection?", a:"LIMIT and other SQL controls to restrict the number of records returned.", d:["DISTINCT to eliminate duplicate records from the injection result set.", "GROUP BY to aggregate leaked records into less useful summary format.", "ORDER BY with OFFSET to paginate results so fewer appear at one time."], e:"OWASP recommends LIMIT and similar SQL controls to prevent mass disclosure of records in case of injection."},
    {c:"A03 Injection", q:"A web form passes user input directly into an LDAP query without sanitization. Which injection type is this?", a:"LDAP injection, which is covered under the A03 Injection category.", d:["SQL injection, which targets relational databases through query manipulation.", "XSS injection, which targets client-side browsers through script insertion.", "Command injection, which targets the operating system's command interpreter."], e:"LDAP injection occurs when user input is directly inserted into LDAP queries without sanitization."},
    {c:"A03 Injection", q:"What does OWASP say about source code review in relation to injection prevention?", a:"Source code review is the best method for detecting injection vulnerabilities.", d:["Source code review is only useful for detecting XSS, not other injections.", "Automated DAST scanning alone is sufficient for detecting all injections.", "Source code review should be replaced entirely by runtime WAF protection."], e:"OWASP states that source code review is the best method of detecting if applications are vulnerable to injections."},
    {c:"A03 Injection", q:"Which testing approach does OWASP recommend alongside source code review for injection?", a:"Thorough automated testing of all parameters, headers, and cookies via DAST.", d:["Manual penetration testing of the login page and password reset flow only.", "Static analysis of JavaScript files on the client side for DOM-based XSS.", "Load testing and performance profiling to identify timeout-based injections."], e:"OWASP recommends thorough automated testing of all parameters, headers, URL, cookies, JSON, SOAP, and XML inputs."},
    {c:"A03 Injection", q:"In OWASP scenario #1 for A03, vulnerable SQL uses string concatenation of which variable?", a:"An untrusted 'id' parameter taken directly from the HTTP request object.", d:["A server-generated session token stored in an encrypted cookie value.", "A database-derived foreign key passed through a validated ORM mapper.", "An internal configuration value read from an environment variable file."], e:"Scenario #1 shows: String query = 'SELECT * FROM accounts WHERE custID=' + request.getParameter('id');"},
    {c:"A03 Injection", q:"What does OWASP scenario #2 for A03 demonstrate about framework trust?", a:"Blind trust in frameworks can still yield injectable queries, e.g. HQL injection.", d:["All ORM frameworks are immune to injection when used with any query syntax.", "Switching from SQL to HQL eliminates all forms of injection automatically.", "Framework-generated queries are always parameterized and therefore always safe."], e:"Scenario #2 shows HQL injection is possible even with Hibernate if queries use string concatenation."},
    {c:"A03 Injection", q:"CWE-79, now part of A03 Injection, covers which vulnerability type?", a:"Cross-Site Scripting: improper neutralization of input in web page output.", d:["SQL Injection: improper neutralization of special elements in SQL queries.", "OS Command Injection: improper neutralization in operating system commands.", "LDAP Injection: improper neutralization of special elements in LDAP queries."], e:"CWE-79 is Cross-Site Scripting, which was merged into the Injection category from its own A7:2017 category."},
    {c:"A03 Injection", q:"What percentage of applications were tested for injection vulnerabilities in the 2021 dataset?", a:"94% of applications were tested for some form of injection.", d:["50% of applications were tested for some form of injection.", "67% of applications were tested for some form of injection.", "82% of applications were tested for some form of injection."], e:"94% of applications were tested for injection with a max incidence rate of 19% and average of 3.37%."},
    {c:"A03 Injection", q:"Which injection type targets the operating system through an application?", a:"OS command injection, where user input is passed to system shell commands.", d:["SQL injection, where user input is embedded in database query statements.", "XPath injection, where user input is inserted into XML query expressions.", "Expression Language injection, where input reaches a template engine evaluator."], e:"OS command injection is one of the injection types covered under A03, targeting the operating system layer."},
    {c:"A03 Injection", q:"What role does output encoding play in preventing injection according to OWASP?", a:"It prevents injected data from being interpreted as commands or markup in output.", d:["It replaces the need for parameterized queries entirely in all injection cases.", "It is only useful for preventing SQL injection, not other injection categories.", "It converts malicious input into safe binary before it enters the data store."], e:"Output encoding ensures that user-supplied data is treated as display text rather than executable code in the output context."},
    {c:"A03 Injection", q:"An application passes user input directly to Runtime.getRuntime().exec(). What type of injection risk is this?", a:"OS command injection — user input reaches the system shell interpreter.", d:["SQL injection — user input reaches the relational database query engine.", "LDAP injection — user input reaches the directory services query handler.", "XSS injection — user input reaches the client browser's rendering engine."], e:"Passing unsanitized input to exec() allows attackers to inject operating system commands."},
    {c:"A03 Injection", q:"OWASP notes that injection vulnerabilities are easy to find using what method?", a:"Source code examination combined with automated scanners and fuzzers.", d:["Manual black-box penetration testing without access to application code.", "Reviewing server access logs for unusual patterns in past HTTP requests.", "Interviewing developers about their coding practices during design review."], e:"OWASP notes injection flaws are easy to find via examining source code, and scanners/fuzzers help testers."},
    {c:"A03 Injection", q:"What does CWE-89, a key CWE under A03, specifically describe?", a:"Improper neutralization of special elements used in SQL commands (SQLi).", d:["Improper neutralization of input during web page generation process (XSS).", "Improper neutralization of special elements in an OS command call (CMDi).", "Improper control of resource identifiers leading to path traversal attacks."], e:"CWE-89 is specifically SQL Injection — the improper neutralization of special elements in SQL commands."},
    {c:"A03 Injection", q:"Which of the following is NOT an injection type covered under A03:2021?", a:"Deserialization of untrusted data, which falls under A08 Integrity Failures.", d:["SQL injection targeting relational database management systems via queries.", "Expression Language injection targeting server-side template engine evaluators.", "NoSQL injection targeting document-oriented database query interfaces."], e:"Insecure deserialization was moved to A08 Software and Data Integrity Failures, not A03 Injection."},
    {c:"A03 Injection", q:"When an application uses an ORM like Hibernate, is it automatically safe from injection?", a:"No — ORMs can still allow injection if queries use string concatenation.", d:["Yes — all ORM frameworks generate fully parameterized queries by default.", "Yes — ORMs sanitize all inputs automatically before building any queries.", "No — but this is only a concern with legacy ORMs, not modern frameworks."], e:"OWASP scenario #2 explicitly shows that HQL injection is possible even when using Hibernate if queries concatenate user input."},

    // --- A04: INSECURE DESIGN (21) ---
    {c:"A04 Insecure Design", q:"A04:2021 Insecure Design was new in the 2021 Top 10. What does it focus on?", a:"Risks related to design and architectural flaws rather than implementation bugs.", d:["Risks related to outdated third-party component versions in production.", "Risks related to missing server hardening and default configuration values.", "Risks related to insufficient logging of security-relevant application events."], e:"A04 is a new category focusing on risks from flawed design, distinguishing design flaws from implementation bugs."},
    {c:"A04 Insecure Design", q:"How many CWEs are mapped to A04:2021 Insecure Design?", a:"40 CWEs are mapped to this category, the most of any.", d:["10 CWEs are mapped to this category, among the fewest.", "22 CWEs are mapped to this category, roughly the average.", "34 CWEs are mapped to this category, tied with A01."], e:"A04 has 40 mapped CWEs, more than any other category in the 2021 Top 10."},
    {c:"A04 Insecure Design", q:"What does OWASP distinguish between insecure design and insecure implementation?", a:"Insecure design cannot be fixed by perfect implementation — it needs redesign.", d:["Insecure design is always fixable by improving the code implementation.", "There is no meaningful difference; both terms describe the same defects.", "Insecure design refers only to UI layout issues, not security architecture."], e:"OWASP emphasizes that insecure design has inherent flaws that cannot be resolved by perfect implementation alone."},
    {c:"A04 Insecure Design", q:"Which practice does OWASP recommend as essential for addressing Insecure Design?", a:"Threat modelling during design to identify and mitigate risks before coding.", d:["Penetration testing after deployment to discover design flaws in production.", "Code review during implementation to catch design errors in source code.", "Dependency scanning in CI/CD to detect vulnerable third-party components."], e:"Threat modelling is a key OWASP recommendation for identifying design-level security issues before implementation."},
    {c:"A04 Insecure Design", q:"What does OWASP recommend using to establish a secure development lifecycle?", a:"A secure development lifecycle with AppSec professionals for design evaluation.", d:["A waterfall development process with a single security gate before release.", "An agile process that defers security reviews until the final sprint cycle.", "A DevOps pipeline focused solely on automated scanning without design review."], e:"OWASP recommends a secure development lifecycle with AppSec professionals to help evaluate and design security controls."},
    {c:"A04 Insecure Design", q:"What type of patterns does OWASP recommend establishing for secure design?", a:"A library of secure design patterns or paved road components ready for use.", d:["A library of penetration testing scripts to verify designs after deployment.", "A library of incident response playbooks to handle design flaw exploits.", "A library of compliance checklists to audit designs against regulations."], e:"OWASP recommends creating a library of secure design patterns or paved road ready-to-use components."},
    {c:"A04 Insecure Design", q:"In OWASP scenario #1 for A04, what insecure design flaw affects a cinema chain?", a:"The booking system lacks a deposit mechanism, enabling mass fake reservations.", d:["The booking system stores credit cards in plain text within its database.", "The booking system exposes an admin API endpoint without authentication.", "The booking system transmits ticket data over unencrypted HTTP connections."], e:"Scenario #1 describes a cinema chain allowing bulk booking without deposits, which bots exploit for scalping."},
    {c:"A04 Insecure Design", q:"OWASP scenario #2 for A04 describes a retail chain missing which security control?", a:"Protection against bots — scalpers buy all high-end video cards at launch.", d:["SQL injection filtering — attackers dump the product pricing database.", "Rate limiting on login — brute force attacks compromise admin accounts.", "TLS enforcement on checkout — payment card data is intercepted in transit."], e:"Scenario #2 describes a retail site with no bot protection, allowing scalpers to buy all inventory."},
    {c:"A04 Insecure Design", q:"What does OWASP recommend regarding user stories in a secure development lifecycle?", a:"Integrate security constraints and controls into each user story definition.", d:["Keep security requirements in a separate document from user stories.", "Add security stories only after all functional stories are completed.", "Defer security constraints until the penetration testing phase begins."], e:"OWASP recommends integrating security language and controls directly into user stories."},
    {c:"A04 Insecure Design", q:"Which OWASP scenario for A04 involves a credential recovery flow design flaw?", a:"Scenario #3: security questions for password recovery using knowledge-based answers.", d:["Scenario #1: a booking system that permits mass fake cinema reservations.", "Scenario #2: a retail chain without bot protection at product launch.", "Scenario #4: a financial API missing rate limits on transfer endpoints."], e:"Scenario #3 describes the insecure design of using knowledge-based questions for credential recovery."},
    {c:"A04 Insecure Design", q:"What does OWASP recommend for limiting resource consumption in secure design?", a:"Implement resource limits per user or service to prevent excessive consumption.", d:["Allow unlimited resource usage and scale infrastructure horizontally instead.", "Apply resource limits only to unauthenticated sessions, not logged-in users.", "Restrict resource limits to database queries only, not API or file requests."], e:"OWASP recommends limiting resource consumption by user or service as a design-level control."},
    {c:"A04 Insecure Design", q:"How does OWASP recommend validating business logic flows to prevent abuse?", a:"Use plausibility checks at each tier to validate that actions make business sense.", d:["Validate only the final step of a flow to ensure the end state is correct.", "Rely on client-side form validation to enforce business logic constraints.", "Allow all actions and use post-hoc log analysis to detect abuse patterns."], e:"OWASP recommends plausibility checks at the tier level to verify business logic consistency."},
    {c:"A04 Insecure Design", q:"What is the average incidence rate for A04 Insecure Design in the 2021 dataset?", a:"3.00% average incidence across tested applications.", d:["0.50% average incidence across tested applications.", "8.75% average incidence across tested applications.", "15.0% average incidence across tested applications."], e:"A04 had an average incidence rate of 3.00% in the contributed dataset."},
    {c:"A04 Insecure Design", q:"OWASP distinguishes A04 from A05 Security Misconfiguration in what way?", a:"A04 is a design-level flaw; A05 is an implementation or configuration error.", d:["A04 covers server hardening; A05 covers application architecture defects.", "A04 applies to APIs only; A05 applies to all types of web applications.", "A04 is detected by SAST tools; A05 is detected only by manual review."], e:"Insecure design is a fundamental architecture flaw, while security misconfiguration is an implementation/configuration error."},
    {c:"A04 Insecure Design", q:"What does OWASP recommend regarding error messages in the context of Insecure Design?", a:"Segregate tenant access and design error messages that do not leak sensitive data.", d:["Display verbose error details to users so they can report bugs effectively.", "Log errors to the client console only, with no server-side error capture.", "Show full stack traces in production to aid developers in rapid debugging."], e:"OWASP recommends designing systems that segregate tenants and limit sensitive data in error messages."},
    {c:"A04 Insecure Design", q:"How does OWASP recommend handling authentication design for critical flows?", a:"Design authentication flows that resist credential stuffing and brute force.", d:["Allow unlimited login attempts to avoid locking out legitimate users.", "Implement client-side rate limiting using JavaScript timers on the form.", "Use single-factor authentication for simplicity across all account types."], e:"OWASP recommends designing authentication to resist automated attacks like credential stuffing and brute force."},
    {c:"A04 Insecure Design", q:"What development methodology does OWASP promote to address insecure design?", a:"Shift-left security: integrate security activities early in the development process.", d:["Shift-right security: defer all security testing until production monitoring.", "Test-driven security: write penetration tests before writing any code.", "Compliance-driven security: implement controls only when regulations require."], e:"OWASP promotes shift-left security, bringing security into the earliest phases of development."},
    {c:"A04 Insecure Design", q:"What does OWASP recommend for evaluating the security of application architecture?", a:"Use threat modelling for authentication, access control, and business logic flows.", d:["Conduct only network-level penetration tests against the production environment.", "Review only the source code of authentication modules, skipping other areas.", "Run automated DAST scans against staging and accept the results as sufficient."], e:"OWASP specifically recommends threat modelling for critical authentication, access control, business logic, and key flows."},
    {c:"A04 Insecure Design", q:"Which CWE example falls under A04 Insecure Design?", a:"CWE-209: Generation of Error Message Containing Sensitive Information.", d:["CWE-89: Improper Neutralization of Special Elements in SQL Commands.", "CWE-79: Improper Neutralization of Input During Web Page Generation.", "CWE-502: Deserialization of Untrusted Data from External User Input."], e:"CWE-209 is mapped to A04 as it represents a design-level failure in how error messages are generated."},
    {c:"A04 Insecure Design", q:"OWASP says that a missing or ineffective control design for a specific flow is an example of what?", a:"Insecure design — the absence of a control that should have been designed in.", d:["Security misconfiguration — a control exists but was configured incorrectly.", "Vulnerable component — the control's library has a known published exploit.", "Injection — the control was present but bypassed through malformed input."], e:"OWASP explicitly defines insecure design as including missing or ineffective controls that should have been designed."},
    {c:"A04 Insecure Design", q:"What is the maximum incidence rate for A04 Insecure Design in the 2021 dataset?", a:"24.19% maximum incidence across tested applications.", d:["3.00% maximum incidence across tested applications.", "46.44% maximum incidence across tested applications.", "67.31% maximum incidence across tested applications."], e:"A04 had a maximum incidence rate of 24.19% in the contributed dataset."},
];

const pool_part_2 = [
    // --- A05: SECURITY MISCONFIGURATION (20) ---
    {c:"A05 Security Misconfiguration", q:"What previous category was merged into A05:2021 Security Misconfiguration?", a:"A4:2017 XML External Entities (XXE) was absorbed into this category.", d:["A7:2017 Cross-Site Scripting (XSS) was absorbed into this category.", "A8:2017 Insecure Deserialization was absorbed into this category.", "A2:2017 Broken Authentication was absorbed into this category."], e:"XXE was merged into Security Misconfiguration in 2021 as it is fundamentally a configuration issue."},
    {c:"A05 Security Misconfiguration", q:"What is the average incidence rate for A05 in the 2021 dataset?", a:"4.51% average incidence across tested applications.", d:["1.25% average incidence across tested applications.", "8.75% average incidence across tested applications.", "19.0% average incidence across tested applications."], e:"A05 had an average incidence rate of 4.51% with a maximum of 19.84%."},
    {c:"A05 Security Misconfiguration", q:"Which of the following is a Security Misconfiguration according to OWASP?", a:"Unnecessary features enabled in production, such as debugging or sample accounts.", d:["Using parameterized queries for all database interactions in the application.", "Storing passwords with Argon2 and a per-user salt with a high work factor.", "Implementing Content Security Policy headers with strict source directives."], e:"OWASP lists unnecessary features, ports, services, pages, accounts, and privileges as security misconfiguration."},
    {c:"A05 Security Misconfiguration", q:"OWASP recommends what approach to reduce the attack surface from misconfiguration?", a:"A minimal platform without unnecessary features, components, or documentation.", d:["A fully-featured platform with all modules enabled for maximum flexibility.", "A platform with default settings preserved to avoid breaking functionality.", "A platform that exposes all configuration in the admin UI for easy auditing."], e:"OWASP recommends a minimal platform that does not include unnecessary features, components, documentation, or samples."},
    {c:"A05 Security Misconfiguration", q:"What does OWASP recommend regarding default accounts on security platforms?", a:"Change or disable all default credentials before deploying to any environment.", d:["Keep default credentials as a backup in case admin accounts are locked out.", "Change defaults only in production but leave them in staging environments.", "Document the default credentials in the application's help pages for users."], e:"OWASP recommends changing or disabling default account credentials to prevent easy unauthorized access."},
    {c:"A05 Security Misconfiguration", q:"What does OWASP recommend for verifying configuration across all environments?", a:"An automated repeatable hardening process across dev, QA, and production.", d:["A manual checklist completed by a single engineer once before each release.", "A quarterly audit by an external firm reviewing production settings only.", "An annual compliance review that samples configuration from random servers."], e:"OWASP recommends a repeatable hardening process that makes it fast and easy to deploy properly locked down environments."},
    {c:"A05 Security Misconfiguration", q:"Which of the following does OWASP list as a misconfiguration related to cloud storage?", a:"Improperly configured permissions on cloud services such as S3 bucket policies.", d:["Encrypting all cloud storage objects with customer-managed encryption keys.", "Enabling versioning on S3 buckets to preserve historical object revisions.", "Using IAM roles with least-privilege policies for all cloud service access."], e:"OWASP lists improper cloud permissions (e.g., open S3 buckets) as a common security misconfiguration."},
    {c:"A05 Security Misconfiguration", q:"How does OWASP recommend handling error messages to prevent information leakage?", a:"Configure error handling to avoid exposing stack traces or framework details.", d:["Display full stack traces so developers can diagnose issues in production.", "Return detailed error codes including internal function names to the client.", "Log error details to the browser console for easy end-user bug reporting."], e:"OWASP recommends proper error handling that doesn't reveal stack traces or overly informative error messages."},
    {c:"A05 Security Misconfiguration", q:"What does OWASP recommend regarding security headers?", a:"Send security directives and headers with appropriate hardened values in responses.", d:["Omit security headers to reduce response size and improve page load latency.", "Set all security headers to their most permissive values for compatibility.", "Only configure security headers on the login page, not on other endpoints."], e:"OWASP recommends sending security headers and directives with proper values as part of secure configuration."},
    {c:"A05 Security Misconfiguration", q:"OWASP scenario #1 for A05 describes what misconfiguration?", a:"A sample application left on the production server with known security flaws.", d:["A firewall rule that blocks all outbound traffic from the application server.", "A database backup script that encrypts all exports with AES-256-GCM mode.", "An SSL certificate installed with a 4096-bit RSA key and SHA-256 signature."], e:"Scenario #1 describes sample applications on the production server that attackers can exploit."},
    {c:"A05 Security Misconfiguration", q:"What does OWASP recommend about XML processor configuration to prevent XXE?", a:"Disable XML external entity processing and DTD processing in all XML parsers.", d:["Enable XML external entity processing for interoperability with legacy feeds.", "Allow DTD processing only for internal XML documents signed by the server.", "Configure XML parsers to fetch external entities via HTTPS connections only."], e:"Disabling XXE and DTD processing is OWASP's recommendation, as XXE was merged into A05."},
    {c:"A05 Security Misconfiguration", q:"How many CWEs are mapped to A05:2021 Security Misconfiguration?", a:"20 CWEs are mapped to this category.", d:["5 CWEs are mapped to this category.", "33 CWEs are mapped to this category.", "40 CWEs are mapped to this category."], e:"A05 has 20 mapped CWEs covering various misconfiguration scenarios."},
    {c:"A05 Security Misconfiguration", q:"What does OWASP recommend as a segmented application architecture approach?", a:"Use segmentation and containerization to separate components and tenant access.", d:["Deploy all services on a single monolithic server for simplified management.", "Share database credentials across all application tiers for convenience.", "Run all microservices under the same OS user account for easy permissions."], e:"OWASP recommends segmented application architecture through containerization or cloud security groups."},
    {c:"A05 Security Misconfiguration", q:"Which OWASP scenario for A05 involves detailed error messages revealing information?", a:"Scenario #2: an application server returning detailed stack traces to users.", d:["Scenario #1: a sample application left active on a production web server.", "Scenario #3: a cloud storage bucket with public read access misconfigured.", "Scenario #4: a default admin account left active in the admin dashboard."], e:"Scenario #2 describes error messages that return detailed stack traces, potentially revealing underlying issues."},
    {c:"A05 Security Misconfiguration", q:"What does OWASP say about directory listing as a misconfiguration?", a:"Directory listing should be disabled on the server to prevent file enumeration.", d:["Directory listing should be enabled and protected with HTTP Basic auth only.", "Directory listing is acceptable as long as all listed files are read-only.", "Directory listing configuration has no security relevance for web servers."], e:"OWASP lists directory listing as a misconfiguration that can reveal sensitive files and server structure."},
    {c:"A05 Security Misconfiguration", q:"OWASP recommends sending what type of directives to client agents?", a:"Security directives such as Content-Security-Policy and X-Content-Type-Options.", d:["Performance directives such as Cache-Control and Content-Encoding headers.", "Analytics directives such as custom tracking headers for usage monitoring.", "Branding directives such as Server and X-Powered-By with version details."], e:"OWASP specifically mentions sending security directives/headers to clients as a prevention measure."},
    {c:"A05 Security Misconfiguration", q:"What is the maximum incidence rate for A05 in the 2021 dataset?", a:"19.84% maximum incidence across tested applications.", d:["4.51% maximum incidence across tested applications.", "46.44% maximum incidence across tested applications.", "67.31% maximum incidence across tested applications."], e:"A05 had a maximum incidence rate of 19.84% in the contributed data."},
    {c:"A05 Security Misconfiguration", q:"OWASP recommends reviewing configurations how often for cloud-hosted applications?", a:"Regularly review and update configurations as part of patch management cycles.", d:["Review configurations only once during the initial deployment of the service.", "Review configurations only after a security breach has been reported.", "Review configurations every five years in line with compliance audit timelines."], e:"OWASP recommends regular review and updating of configurations across all environments."},
    {c:"A05 Security Misconfiguration", q:"What type of software installation does OWASP warn against in the context of A05?", a:"Unnecessary software, frameworks, or features that are installed but not required.", d:["Essential runtime dependencies required for the application to function properly.", "Operating system security patches and critical vendor-supplied hotfix updates.", "Monitoring agents that provide real-time visibility into application health."], e:"OWASP warns against installing software or features that are not needed, as they increase attack surface."},
    {c:"A05 Security Misconfiguration", q:"OWASP recommends what approach for managing configuration across different environments?", a:"Use identical security configuration in dev, staging, and production environments.", d:["Apply strict security only in production and relax it in dev and staging.", "Configure each environment independently with no standardized baseline.", "Maintain security configuration only in production and skip other environments."], e:"OWASP recommends consistent security configuration across all environments to prevent deployment-related issues."},

    // --- A06: VULNERABLE AND OUTDATED COMPONENTS (19) ---
    {c:"A06 Vulnerable Components", q:"What notable characteristic does OWASP mention about CVE/CVSS data for A06?", a:"A06 is the only category without any CVEs mapped to its included CWEs.", d:["A06 has the highest number of CVEs mapped across all ten categories.", "A06 has exactly the same CVE count as A01 Broken Access Control.", "A06 has CVEs mapped only for open-source components, not commercial."], e:"A06 is unique in that it has no CVEs directly mapped to its CWEs, relying on default exploit/impact weights."},
    {c:"A06 Vulnerable Components", q:"Which of the following indicates vulnerability to A06 according to OWASP?", a:"You do not know the versions of all components used, both client and server side.", d:["You maintain a complete software bill of materials for every deployed component.", "You subscribe to security advisories for all frameworks in your tech stack.", "You run automated dependency scans on every pull request in your CI pipeline."], e:"Not knowing component versions (client-side and server-side, including nested dependencies) is a key indicator."},
    {c:"A06 Vulnerable Components", q:"What does OWASP recommend for managing component vulnerabilities?", a:"Monitor CVE and NVD databases and subscribe to email alerts for used components.", d:["Check for component updates only during annual compliance audit activities.", "Rely on the component vendor to push automatic patches without monitoring.", "Review component security only when a customer reports an active exploit."], e:"OWASP recommends continuously monitoring sources like CVE and NVD for vulnerabilities in components you use."},
    {c:"A06 Vulnerable Components", q:"OWASP recommends obtaining components from what type of source?", a:"Official sources over secure links, preferring signed packages to reduce risk.", d:["Any available mirror regardless of signature verification or link security.", "Community forks on GitHub that have more recent activity than official repos.", "Cached copies from internal developer machines to avoid network dependencies."], e:"OWASP recommends using official sources over secure links and preferring signed packages."},
    {c:"A06 Vulnerable Components", q:"What does OWASP recommend removing from applications to reduce A06 risk?", a:"Unused dependencies, unnecessary features, components, files, and documentation.", d:["All third-party dependencies in favour of writing everything from scratch.", "Logging and monitoring libraries to reduce the application's code footprint.", "Authentication libraries in favour of custom-built credential management."], e:"OWASP recommends removing unused dependencies, unnecessary features, components, files, and documentation."},
    {c:"A06 Vulnerable Components", q:"What is a software bill of materials (SBOM) in the context of A06?", a:"An inventory of all components and their versions used in an application.", d:["A financial document listing the cost of all software licences purchased.", "A deployment manifest that maps components to specific cloud instances.", "A test report summarizing the results of automated security scans."], e:"An SBOM provides a comprehensive inventory of components, enabling vulnerability tracking and management."},
    {c:"A06 Vulnerable Components", q:"In OWASP scenario #1 for A06, what is the risk of using components with known vulnerabilities?", a:"Components run with the same privileges as the application, so flaws can be severe.", d:["Components always run in an isolated sandbox with no application access at all.", "Components cannot affect the application because they execute in separate threads.", "Components are statically linked so vulnerabilities cannot be exploited at runtime."], e:"OWASP notes that components typically run with same privileges as the application, making flaws potentially severe."},
    {c:"A06 Vulnerable Components", q:"What position did A06 hold in the 2017 Top 10?", a:"A9:2017 — Using Components with Known Vulnerabilities, now moved to A06.", d:["A6:2017 — it kept the same number between the two editions of the list.", "A3:2017 — it dropped from third position in 2017 to sixth in 2021.", "A1:2017 — it dropped from first position in 2017 to sixth in 2021."], e:"A06 was previously A9:2017 Using Components with Known Vulnerabilities."},
    {c:"A06 Vulnerable Components", q:"How many CWEs are mapped to A06:2021?", a:"3 CWEs are mapped to this category, the fewest of any.", d:["20 CWEs are mapped to this category, around the average.", "33 CWEs are mapped to this category, among the highest.", "40 CWEs are mapped to this category, tied with A04."], e:"A06 has only 3 mapped CWEs, the fewest of any category in the 2021 Top 10."},
    {c:"A06 Vulnerable Components", q:"OWASP scenario #2 for A06 references which real-world vulnerability?", a:"CVE-2017-5638, a Struts 2 remote code execution flaw causing major breaches.", d:["CVE-2021-44228, a Log4j remote code execution flaw called Log4Shell.", "CVE-2014-0160, an OpenSSL memory leak vulnerability known as Heartbleed.", "CVE-2017-0144, a Windows SMB vulnerability exploited by the EternalBlue tool."], e:"OWASP references CVE-2017-5638 (Struts 2 RCE) which was linked to significant breaches."},
    {c:"A06 Vulnerable Components", q:"What does OWASP say about the effort required to exploit known component vulnerabilities?", a:"Many exploits are already written and available — attackers just run the exploit code.", d:["Exploiting known vulnerabilities always requires custom zero-day research work.", "Known component flaws require physical access to the server to be exploited.", "Component vulnerabilities can only be exploited after social engineering an admin."], e:"OWASP notes that exploits for known vulnerabilities are often already written, requiring minimal attacker effort."},
    {c:"A06 Vulnerable Components", q:"What does OWASP recommend as an ongoing governance process for A06?", a:"Maintain a plan for monitoring, triaging, and applying updates over the application lifetime.", d:["Freeze all component versions at initial release and never apply updates.", "Update components only when migrating to a new major application version.", "Delegate all component management to the cloud provider's managed service."], e:"OWASP recommends an ongoing plan for monitoring, triaging, and applying updates or config changes for the application lifetime."},
    {c:"A06 Vulnerable Components", q:"What is the average incidence rate for A06 in the 2021 dataset?", a:"6.35% average incidence across tested applications.", d:["0.50% average incidence across tested applications.", "15.0% average incidence across tested applications.", "27.3% average incidence across tested applications."], e:"A06 had an average incidence rate of 6.35% in the contributed dataset."},
    {c:"A06 Vulnerable Components", q:"OWASP recommends what type of testing related to component configuration?", a:"Ensure effective monitoring, configuration, and security of components in use.", d:["Test only the application code while ignoring third-party component settings.", "Skip component testing if the vendor provides a signed security certificate.", "Restrict testing to frontend components and trust all backend dependencies."], e:"OWASP recommends ensuring effective monitoring, configuration, and security for deployed components."},
    {c:"A06 Vulnerable Components", q:"According to OWASP, what makes nested dependencies particularly dangerous for A06?", a:"You may not be aware of nested transitive dependencies or their known vulnerabilities.", d:["Nested dependencies are always isolated in their own security sandbox at runtime.", "Nested dependencies are automatically updated when the parent package is patched.", "Nested dependencies cannot introduce vulnerabilities because they are compiled out."], e:"Nested/transitive dependencies are dangerous because organisations often don't track them or their vulnerabilities."},
    {c:"A06 Vulnerable Components", q:"What scanning approach does OWASP recommend for detecting vulnerable components?", a:"Use software composition analysis (SCA) tools to automate dependency vulnerability detection.", d:["Perform manual code review of all third-party library source code before each build.", "Rely on runtime application self-protection (RASP) to block all component exploits.", "Use dynamic application security testing (DAST) which comprehensively covers components."], e:"SCA tools automate the detection of known vulnerabilities in dependencies and are recommended by OWASP."},
    {c:"A06 Vulnerable Components", q:"OWASP warns that vulnerability in which scenario is particularly concerning for A06?", a:"Software that is unsupported, out of date, or unpatched by the vendor.", d:["Software that has been recently released with a first stable version number.", "Software that is open-source with an active community and weekly releases.", "Software that receives long-term support from the vendor with a clear roadmap."], e:"OWASP warns about unsupported, out-of-date, or vulnerable software including OS, web/app server, DBMS, and libraries."},
    {c:"A06 Vulnerable Components", q:"What does OWASP recommend as an alternative if patching a component is not immediately possible?", a:"Apply a virtual patch using a web application firewall rule to mitigate the exposure.", d:["Ignore the vulnerability and accept the risk until the next scheduled release.", "Remove the entire application from production until the component is updated.", "Replace the component with an unvetted alternative immediately without testing."], e:"OWASP recommends virtual patching through WAF rules as an interim mitigation when immediate patching isn't possible."},
    {c:"A06 Vulnerable Components", q:"What is the maximum incidence rate for A06 in the 2021 dataset?", a:"27.96% maximum incidence across tested applications.", d:["6.35% maximum incidence across tested applications.", "46.44% maximum incidence across tested applications.", "67.31% maximum incidence across tested applications."], e:"A06 had a maximum incidence rate of 27.96% in the contributed data."},

    // --- A07: IDENTIFICATION AND AUTHENTICATION FAILURES (21) ---
    {c:"A07 Auth Failures", q:"What was A07:2021 previously called in the 2017 Top 10?", a:"A2:2017 Broken Authentication — renamed and moved from second to seventh.", d:["A5:2017 Broken Access Control — renamed and moved from fifth to seventh.", "A7:2017 Cross-Site Scripting — renamed and moved to the same position.", "A10:2017 Insufficient Logging — renamed and promoted from tenth to seventh."], e:"A07 was previously A2:2017 Broken Authentication, sliding down from second due to increased availability of standardized frameworks."},
    {c:"A07 Auth Failures", q:"How many CWEs are mapped to A07:2021?", a:"22 CWEs are mapped to this category.", d:["3 CWEs are mapped to this category.", "10 CWEs are mapped to this category.", "40 CWEs are mapped to this category."], e:"A07 has 22 mapped CWEs covering authentication and identification failures."},
    {c:"A07 Auth Failures", q:"Which attack does OWASP say confirms an application has A07 vulnerabilities if it permits it?", a:"Credential stuffing — using lists of known valid username and password pairs.", d:["Port scanning — enumerating open network services on the application server.", "DNS enumeration — resolving subdomains to discover hidden application hosts.", "Social engineering — phishing employees to extract login credentials by email."], e:"OWASP states that permitting credential stuffing (using lists of known passwords) is an authentication vulnerability."},
    {c:"A07 Auth Failures", q:"What does OWASP recommend for preventing brute force attacks on authentication?", a:"Implement rate limiting and progressively increase delays after failed attempts.", d:["Allow unlimited login attempts to avoid accidentally locking legitimate users.", "Implement client-side JavaScript cooldown timers between login form submissions.", "Block all accounts after a single failed attempt to maximise attack prevention."], e:"OWASP recommends limiting failed authentication attempts through rate limiting and increasing delays."},
    {c:"A07 Auth Failures", q:"According to OWASP, what is a key prevention measure for A07?", a:"Implement multi-factor authentication to prevent credential stuffing and brute force.", d:["Use single-factor authentication with extra-long passwords for simplicity.", "Require password changes every thirty days without multi-factor authentication.", "Implement biometric-only authentication without any password-based fallback."], e:"MFA is a key OWASP recommendation for preventing automated credential attacks."},
    {c:"A07 Auth Failures", q:"What does OWASP say about default credentials in the context of A07?", a:"Applications should never ship with default credentials, especially for admin users.", d:["Default credentials are acceptable if documented in the admin setup guide.", "Default admin credentials should be shared verbally during onboarding only.", "Default credentials are safe as long as users are reminded to change them."], e:"OWASP explicitly states applications should not ship with default credentials, especially for admin accounts."},
    {c:"A07 Auth Failures", q:"OWASP recommends what password policy based on modern NIST 800-63b guidelines?", a:"Check new passwords against the list of the top 10,000 most common passwords.", d:["Require passwords to include uppercase, lowercase, number, and special chars.", "Enforce mandatory password changes every sixty days for all user accounts.", "Set a maximum password length of sixteen characters to prevent buffer issues."], e:"OWASP aligns with NIST 800-63b, recommending checking passwords against lists of known-bad passwords."},
    {c:"A07 Auth Failures", q:"What does OWASP say about session identifier handling after login?", a:"Generate a new random session ID after login; do not reuse the pre-login session.", d:["Reuse the existing pre-login session ID to maintain continuity for the user.", "Store the session ID in the URL query string for easy bookmark and sharing.", "Use a predictable session ID derived from the username for easy debugging."], e:"OWASP recommends generating new random session IDs after login to prevent session fixation attacks."},
    {c:"A07 Auth Failures", q:"According to OWASP, what should session identifiers NOT be present in?", a:"The URL — session IDs should not be included in the address bar or URL parameters.", d:["The Set-Cookie response header — session IDs should use localStorage instead.", "The Authorization request header — session IDs should use query strings instead.", "The HTTP response body — session IDs should be stored in the page title tag."], e:"OWASP states that session identifiers should not be in the URL to prevent session leakage."},
    {c:"A07 Auth Failures", q:"What does OWASP recommend regarding password length requirements?", a:"Enforce a minimum password length and allow longer passphrases up to 64+ characters.", d:["Set a minimum of four characters and a maximum of twelve for memorability.", "Set a minimum of eight characters and a maximum of sixteen for consistency.", "Enforce no minimum length but require at least three special characters instead."], e:"OWASP aligns with NIST 800-63b in requiring minimum length and allowing longer passphrases."},
    {c:"A07 Auth Failures", q:"What is the average incidence rate for A07 in the 2021 dataset?", a:"2.55% average incidence across tested applications.", d:["0.50% average incidence across tested applications.", "8.75% average incidence across tested applications.", "19.0% average incidence across tested applications."], e:"A07 had an average incidence rate of 2.55% in the contributed dataset."},
    {c:"A07 Auth Failures", q:"OWASP recommends aligning password and credential policies with which standard?", a:"NIST 800-63b Digital Identity Guidelines for credential management.", d:["ISO 27001 Annex A control requirements for information security.", "PCI DSS Requirement 8 for identification and authentication controls.", "SOC 2 Type II trust service criteria for logical access management."], e:"OWASP specifically references NIST 800-63b guidelines for password and credential policies."},
    {c:"A07 Auth Failures", q:"What does OWASP say about login failure messages?", a:"Use identical generic messages for all outcomes to prevent username enumeration.", d:["Display specific messages explaining whether the username or password was wrong.", "Show a detailed error including the number of remaining attempts for the account.", "Return a different HTTP status code for invalid usernames versus wrong passwords."], e:"OWASP recommends using the same generic message for all login failure scenarios to prevent enumeration."},
    {c:"A07 Auth Failures", q:"What does OWASP recommend about session tokens after logout?", a:"Invalidate session tokens on the server side immediately upon user logout.", d:["Keep session tokens valid for thirty minutes after logout for tab recovery.", "Mark tokens as logged-out client-side but maintain server-side validity.", "Delete the session cookie but leave the server session active as a cache."], e:"OWASP recommends invalidating server-side sessions and tokens upon logout."},
    {c:"A07 Auth Failures", q:"OWASP lists which scenario as an authentication failure for A07?", a:"An application that allows automated attacks such as credential stuffing or brute force.", d:["An application that requires multi-factor authentication for all admin accounts.", "An application that hashes passwords with bcrypt using a cost factor of twelve.", "An application that locks accounts for fifteen minutes after five failed logins."], e:"Permitting automated attacks like credential stuffing is explicitly listed as an A07 vulnerability."},
    {c:"A07 Auth Failures", q:"What does OWASP recommend for password storage?", a:"Store passwords using a strong one-way adaptive hash with a salt and work factor.", d:["Store passwords encrypted with AES so they can be decrypted for verification.", "Store passwords in plaintext within an encrypted database column for simplicity.", "Store passwords using a fast hash like MD5 with a global application-wide salt."], e:"OWASP recommends strong one-way adaptive hashing functions with salt and work factor for password storage."},
    {c:"A07 Auth Failures", q:"According to OWASP, what role does a credential recovery process play in A07?", a:"A weak recovery process such as knowledge-based answers can undermine authentication.", d:["Recovery processes have no impact on authentication security when MFA is enabled.", "Recovery processes only matter for admin accounts, not for regular user accounts.", "Recovery processes are outside the scope of A07 and belong under A04 Insecure Design."], e:"OWASP notes that weak credential recovery (e.g., knowledge-based questions) is an authentication failure under A07."},
    {c:"A07 Auth Failures", q:"What session management weakness does OWASP list under A07?", a:"Sessions that do not properly timeout or rotate IDs after successful authentication.", d:["Sessions that use randomly generated 128-bit identifiers stored in secure cookies.", "Sessions that are invalidated automatically after thirty minutes of user inactivity.", "Sessions that are rotated on every request to prevent any form of session reuse."], e:"Improper session timeout and failure to rotate session IDs are authentication failures under A07."},
    {c:"A07 Auth Failures", q:"What does OWASP say about exposing session identifiers in log files?", a:"Session IDs should not be logged, as log file exposure could enable session hijacking.", d:["Session IDs should be logged in full for comprehensive audit trail completeness.", "Session IDs should be logged with the first four characters masked for safety.", "Session IDs are safe to log because log files are not accessible to attackers."], e:"OWASP recommends not logging session identifiers to prevent session hijacking through log exposure."},
    {c:"A07 Auth Failures", q:"Why did A07 drop from second position in 2017 to seventh in 2021?", a:"Increased availability of standardized authentication frameworks reduced prevalence.", d:["Authentication vulnerabilities were removed from the OWASP assessment scope.", "The community survey voted to deprioritize authentication as a risk category.", "Authentication flaws were merged into Broken Access Control and recategorized."], e:"OWASP notes that the availability of standardized frameworks has helped reduce authentication failures."},
    {c:"A07 Auth Failures", q:"According to OWASP, what makes session fixation a concern under A07?", a:"Reusing pre-authentication session tokens allows attackers to hijack the new session.", d:["Session fixation only affects applications that store sessions in URL parameters.", "Session fixation is mitigated automatically by any modern web application framework.", "Session fixation requires physical access to the victim's device to be exploited."], e:"Session fixation exploits pre-authentication session tokens; generating new IDs after login prevents this."},

    // --- A08: SOFTWARE AND DATA INTEGRITY FAILURES (19) ---
    {c:"A08 Integrity Failures", q:"A08:2021 is a new category that absorbed which 2017 entry?", a:"A8:2017 Insecure Deserialization was merged into this broader category.", d:["A4:2017 XML External Entities was merged into this broader category.", "A7:2017 Cross-Site Scripting was merged into this broader category.", "A5:2017 Broken Access Control was merged into this broader category."], e:"A08 is a new broader category that absorbed A8:2017 Insecure Deserialization."},
    {c:"A08 Integrity Failures", q:"What is the primary focus of A08:2021 Software and Data Integrity Failures?", a:"Failures to verify the integrity of software updates, data, and CI/CD pipelines.", d:["Failures to encrypt sensitive data at rest using strong cryptographic algorithms.", "Failures to authenticate users properly during the login and session process.", "Failures to sanitize user input before passing it to database query engines."], e:"A08 focuses on making assumptions about software updates, critical data, and CI/CD pipelines without verifying integrity."},
    {c:"A08 Integrity Failures", q:"Which notable CWEs does OWASP highlight for A08:2021?", a:"CWE-502 (Deserialization), CWE-829 (Untrusted Functionality), CWE-494 (No Integrity Check).", d:["CWE-79 (XSS), CWE-89 (SQL Injection), CWE-73 (External File Control).", "CWE-200 (Info Exposure), CWE-201 (Data Leak), CWE-352 (CSRF).", "CWE-259 (Hardcoded Password), CWE-327 (Risky Crypto), CWE-331 (Low Entropy)."], e:"OWASP highlights CWE-502, CWE-829, and CWE-494 as notable CWEs for A08."},
    {c:"A08 Integrity Failures", q:"What does OWASP recommend to prevent integrity failures in software updates?", a:"Use digital signatures to verify that software and data come from the expected source.", d:["Download updates from any available mirror to maximize download speed.", "Verify updates by checking file sizes match the expected byte count.", "Accept all updates automatically without verification to stay current."], e:"OWASP recommends using digital signatures to verify software and data integrity."},
    {c:"A08 Integrity Failures", q:"OWASP scenario #1 for A08 describes what type of supply chain attack?", a:"A compromised update mechanism that pushes malicious firmware to devices.", d:["A SQL injection that modifies database records during a scheduled backup.", "A brute force attack that compromises an admin account on a build server.", "A phishing campaign that tricks developers into revealing repository credentials."], e:"Scenario #1 describes unsigned firmware updates that attackers can compromise."},
    {c:"A08 Integrity Failures", q:"What does OWASP say about using serialized objects from untrusted sources?", a:"Do not accept serialized objects from untrusted sources or use serialization-only formats.", d:["Accept serialized objects from any source as long as the data schema is valid.", "Use serialized objects freely when transmitted over an encrypted TLS connection.", "Allow serialized objects from untrusted sources after Base64 decoding them first."], e:"OWASP recommends not accepting serialized objects from untrusted sources as a key prevention for A08."},
    {c:"A08 Integrity Failures", q:"OWASP recommends what approach for CI/CD pipeline security under A08?", a:"Ensure CI/CD pipelines have proper access control, segregation, and configuration.", d:["Allow all developers full admin access to CI/CD pipelines for productivity.", "Run CI/CD pipelines without any access controls to avoid deployment delays.", "Configure CI/CD pipelines identically to development environments for simplicity."], e:"OWASP recommends proper segregation, configuration, and access control in CI/CD pipelines."},
    {c:"A08 Integrity Failures", q:"What does OWASP recommend for verifying the integrity of third-party libraries?", a:"Verify that libraries are consumed from trusted repositories and use dependency checks.", d:["Download libraries from any source and trust the package manager's caching layer.", "Accept libraries without verification if they have more than one thousand stars.", "Use only libraries that have been personally reviewed line-by-line by your team."], e:"OWASP recommends using trusted repositories and dependency checks to verify library integrity."},
    {c:"A08 Integrity Failures", q:"How many CWEs are mapped to A08:2021?", a:"10 CWEs are mapped to this category.", d:["3 CWEs are mapped to this category.", "22 CWEs are mapped to this category.", "40 CWEs are mapped to this category."], e:"A08 has 10 mapped CWEs covering various integrity failure scenarios."},
    {c:"A08 Integrity Failures", q:"OWASP scenario #2 for A08 describes what type of attack?", a:"A SolarWinds-style supply chain attack where a build process is compromised.", d:["A credential stuffing attack where stolen passwords unlock developer accounts.", "A ransomware attack where production databases are encrypted and held hostage.", "A DNS hijacking attack where update requests are redirected to a malicious server."], e:"Scenario #2 references the SolarWinds-style attack where the build/update process itself is compromised."},
    {c:"A08 Integrity Failures", q:"What does OWASP recommend regarding integrity verification for serialized data?", a:"Implement integrity checks such as digital signatures on all serialized data.", d:["Rely on transport-layer encryption alone to protect serialized data integrity.", "Skip integrity checks for serialized data exchanged between internal services.", "Use checksum verification only for serialized data larger than one megabyte."], e:"OWASP recommends digital signatures or similar integrity checks on serialized data to prevent tampering."},
    {c:"A08 Integrity Failures", q:"What does OWASP say about the use of libraries from public repositories?", a:"Ensure you are not sending unverified updates to clients without integrity verification.", d:["Public repositories are inherently trustworthy and need no additional verification.", "Only use libraries from public repositories if they were published in the last year.", "Prefer libraries from public repositories over private ones for better community support."], e:"OWASP warns about blindly trusting public repositories and sending unverified updates to clients."},
    {c:"A08 Integrity Failures", q:"What type of review does OWASP recommend for code and configuration changes?", a:"Review changes to minimize the chance that malicious code or configuration is introduced.", d:["Allow all code changes to be merged automatically to maintain deployment velocity.", "Review only code changes from external contributors, not from internal team members.", "Restrict reviews to annual audits rather than reviewing each individual change."], e:"OWASP recommends reviewing code and configuration changes to prevent introduction of malicious content."},
    {c:"A08 Integrity Failures", q:"What is the weighted exploit score for A08 in the 2021 dataset?", a:"The weighted exploit score is 6.94 out of 10.", d:["The weighted exploit score is 2.50 out of 10.", "The weighted exploit score is 8.75 out of 10.", "The weighted exploit score is 4.25 out of 10."], e:"A08 has a weighted exploit score of 6.94 in the CVSS data."},
    {c:"A08 Integrity Failures", q:"OWASP recommends what specific tool for checking component integrity?", a:"Use a software supply chain security tool like OWASP Dependency-Check or similar.", d:["Use a static analysis tool focused on source code quality metrics and style.", "Use a dynamic application scanner that tests running applications for exploits.", "Use a network vulnerability scanner that identifies open ports and services."], e:"OWASP recommends tools like OWASP Dependency-Check for verifying component integrity."},
    {c:"A08 Integrity Failures", q:"What is the average incidence rate for A08 in the 2021 dataset?", a:"2.05% average incidence across tested applications.", d:["0.10% average incidence across tested applications.", "8.75% average incidence across tested applications.", "15.0% average incidence across tested applications."], e:"A08 had an average incidence rate of 2.05% in the contributed dataset."},
    {c:"A08 Integrity Failures", q:"What does OWASP say about unsigned or unencrypted serialized data sent to untrusted clients?", a:"It creates an integrity failure — always apply signing or integrity controls.", d:["It is safe because the client cannot modify data it does not understand.", "It is acceptable for non-sensitive data such as user preference settings.", "It is mitigated by TLS encryption of the transport layer during transit."], e:"OWASP warns that sending unsigned/unencrypted serialized data to untrusted clients is an integrity failure."},
    {c:"A08 Integrity Failures", q:"How was A08 selected for inclusion in the 2021 Top 10?", a:"Selected based on contributed data analysis, scoring tenth by weighted average.", d:["Selected based on community survey voting as the top-ranked new category.", "Selected based on a single high-profile breach that drew public attention.", "Selected because NIST mandated its inclusion as a new regulatory requirement."], e:"A08 was selected from contributed data, ranking 10th by weighted average, and includes the former Insecure Deserialization."},
    {c:"A08 Integrity Failures", q:"OWASP mentions which real-world incident as an example of A08 in the 2021 edition?", a:"The SolarWinds Orion supply chain compromise that affected thousands of organisations.", d:["The Equifax breach caused by an unpatched Apache Struts vulnerability in 2017.", "The Heartbleed OpenSSL vulnerability that leaked server memory contents in 2014.", "The WannaCry ransomware worm that exploited the EternalBlue SMB vulnerability."], e:"OWASP references the SolarWinds Orion attack as a key example of software and data integrity failure."},

    // --- A09: SECURITY LOGGING AND MONITORING FAILURES (19) ---
    {c:"A09 Logging Failures", q:"How was A09:2021 selected for the Top 10?", a:"Selected from the community survey, ranking third; it moved up from A10 in 2017.", d:["Selected from contributed data analysis as the highest incidence category.", "Selected based on a NIST mandate requiring its inclusion as a new entry.", "Selected from vendor lobbying to promote their logging and SIEM products."], e:"A09 was promoted from A10:2017 based on the community survey where it ranked #3."},
    {c:"A09 Logging Failures", q:"What average time to detect a breach does OWASP cite to justify A09's importance?", a:"Research shows the average time to detect a breach is around 197 days.", d:["Research shows the average time to detect a breach is around 14 days.", "Research shows the average time to detect a breach is around 45 days.", "Research shows the average time to detect a breach is around 365 days."], e:"OWASP cites research showing 197 days average breach detection time, highlighting the importance of logging."},
    {c:"A09 Logging Failures", q:"Which of the following does OWASP consider a logging failure under A09?", a:"Login failures and high-value transactions not being logged with sufficient context.", d:["Logging all HTTP requests including full request and response body content.", "Logging user session IDs alongside every authentication event for audit trails.", "Logging stack traces in production error responses returned to end users."], e:"Not logging logins, failed logins, and high-value transactions is explicitly a logging failure under A09."},
    {c:"A09 Logging Failures", q:"What does OWASP recommend regarding log data encoding?", a:"Encode and validate log data to prevent injection and forgery in log management systems.", d:["Store logs as raw unencoded plaintext to simplify search and grep operations.", "Compress log entries using gzip before writing to reduce disk space consumption.", "Encrypt individual log entries so that only SIEM administrators can read them."], e:"OWASP recommends encoding log data correctly to prevent log injection and forgery attacks."},
    {c:"A09 Logging Failures", q:"According to OWASP, what should happen when application logs detect suspicious activity?", a:"Alerting systems should be triggered so response teams can act in near real-time.", d:["Log entries should be archived for review during the next quarterly audit cycle.", "Suspicious activity should be silently recorded without notifying any personnel.", "The application should automatically block the user without logging the event."], e:"OWASP recommends effective alerting so that suspicious activities are detected and responded to in a timely fashion."},
    {c:"A09 Logging Failures", q:"OWASP recommends what approach for high-value transactions?", a:"Create audit trails with append-only integrity controls to prevent tampering.", d:["Store audit data in the same mutable table as the transaction records.", "Allow audit records to be updated by administrators for corrections.", "Keep audit trails optional for transactions below a certain dollar amount."], e:"OWASP recommends audit trails with integrity controls (append-only) for high-value transactions."},
    {c:"A09 Logging Failures", q:"How many CWEs are mapped to A09:2021?", a:"4 CWEs are mapped to this category.", d:["1 CWE is mapped to this category.", "15 CWEs are mapped to this category.", "29 CWEs are mapped to this category."], e:"A09 has 4 mapped CWEs related to logging and monitoring failures."},
    {c:"A09 Logging Failures", q:"OWASP scenario #1 for A09 describes what outcome from a logging failure?", a:"A children's health plan breach went undetected for over seven years due to poor logging.", d:["A financial trading platform lost real-time market data for under thirty minutes.", "A retail website experienced a brief outage during a flash sale promotion event.", "An internal wiki was defaced by a disgruntled employee over a single weekend."], e:"Scenario #1 describes a children's health plan provider whose breach was undetected for over 7 years."},
    {c:"A09 Logging Failures", q:"OWASP scenario #2 for A09 describes what detection failure?", a:"A major airline's data breach was announced by a third party, not detected internally.", d:["A government agency detected its own breach within hours using automated alerting.", "A SaaS company identified a data leak through its internal bug bounty programme.", "A hospital discovered unauthorized access during a routine annual security audit."], e:"Scenario #2 describes an airline breach that was reported by an external third party rather than discovered internally."},
    {c:"A09 Logging Failures", q:"What does OWASP recommend regarding penetration testing and logging?", a:"Ensure that logging is sufficient for penetration test findings to be understood.", d:["Disable all logging during penetration tests to avoid polluting audit records.", "Penetration testers should not review logs as it is outside their test scope.", "Logging levels should be reduced during testing to improve application performance."], e:"OWASP recommends ensuring sufficient logging for penetration testers to understand the impact of findings."},
    {c:"A09 Logging Failures", q:"According to OWASP, where should logs NOT be stored?", a:"Only on the local server — logs should be sent to centralised log management systems.", d:["In a centralised SIEM system that aggregates logs from all application servers.", "In append-only cloud storage with immutable retention policies configured.", "In a dedicated logging database with role-based access control enforced."], e:"OWASP warns against storing logs only locally, recommending centralised log management solutions."},
    {c:"A09 Logging Failures", q:"What does OWASP say about monitoring and alerting thresholds?", a:"Establish effective monitoring and alerting so suspicious activity is detected quickly.", d:["Set alerting thresholds as high as possible to avoid generating false positives.", "Disable alerting for non-production environments to reduce notification fatigue.", "Configure alerts to trigger only after business hours for operations team review."], e:"OWASP recommends effective monitoring and alerting with appropriate thresholds for timely detection."},
    {c:"A09 Logging Failures", q:"What does OWASP recommend for incident response related to A09?", a:"Establish or adopt an incident response and recovery plan such as NIST 800-61r2.", d:["Create a new incident response plan from scratch without referencing standards.", "Defer incident response planning until after the first security breach occurs.", "Outsource all incident response to a third party with no internal capability."], e:"OWASP recommends establishing or adopting an incident response plan, referencing NIST 800-61r2."},
    {c:"A09 Logging Failures", q:"Which OWASP project assists with logging and monitoring frameworks?", a:"The OWASP Application Security Verification Standard (ASVS) covers logging controls.", d:["The OWASP ZAP project provides built-in logging analysis for web applications.", "The OWASP Juice Shop project includes a production-ready logging framework.", "The OWASP Amass project offers centralised log collection for DNS monitoring."], e:"OWASP's ASVS includes detailed verification requirements for logging and monitoring controls."},
    {c:"A09 Logging Failures", q:"What is the average incidence rate for A09 in the 2021 dataset?", a:"6.51% average incidence across tested applications.", d:["0.50% average incidence across tested applications.", "15.0% average incidence across tested applications.", "27.3% average incidence across tested applications."], e:"A09 had an average incidence rate of 6.51% in the contributed dataset."},
    {c:"A09 Logging Failures", q:"What does OWASP warn about regarding logging of sensitive data?", a:"Logs should not contain sensitive data that could violate privacy laws if exposed.", d:["Logs should always capture the full contents of user input for completeness.", "Logging sensitive data is acceptable if the log files are encrypted at rest.", "Sensitive data in logs is permitted when a data processing agreement is signed."], e:"OWASP warns that logs should not contain sensitive data to comply with privacy regulations."},
    {c:"A09 Logging Failures", q:"OWASP scenario #3 for A09 describes what failure?", a:"An attacker used a common evaluation tool to scan and exploit a vulnerability undetected.", d:["An insider threat was detected immediately by an automated anomaly detection system.", "A third-party vendor discovered the breach during a scheduled compliance audit.", "A developer accidentally committed credentials but automated alerts caught it instantly."], e:"Scenario #3 describes an attacker scanning for vulnerabilities using common tools without being detected."},
    {c:"A09 Logging Failures", q:"What does OWASP say about the format of log entries?", a:"Use a consistent format that can be easily consumed by centralised log management tools.", d:["Use unique custom formats for each application to differentiate log sources.", "Store logs in binary format for maximum compression and minimum storage cost.", "Write logs in natural language paragraphs for easy reading by non-technical staff."], e:"OWASP recommends consistent log formats that are easily consumed by log management solutions."},
    {c:"A09 Logging Failures", q:"What does OWASP recommend regarding application and API audit logging?", a:"Ensure all login, access control, and input validation failures are logged with context.", d:["Log only successful transactions and skip failures to keep log volume manageable.", "Log only access control events and exclude authentication from the audit scope.", "Log events only at the network perimeter, not at the application or API level."], e:"OWASP recommends logging all login, access control, and server-side input validation failures with sufficient context."},

    // --- A10: SERVER-SIDE REQUEST FORGERY (19) ---
    {c:"A10 SSRF", q:"How was A10:2021 SSRF selected for the Top 10?", a:"Selected from the community survey where it was the number one voted category.", d:["Selected from contributed data as the category with the highest incidence rate.", "Selected based on vendor analysis showing SSRF as the most exploited web flaw.", "Selected automatically because it had the most mapped CWEs in the dataset."], e:"SSRF was added based on the community survey where it ranked #1."},
    {c:"A10 SSRF", q:"How many CWEs are mapped to A10:2021 SSRF?", a:"1 CWE is mapped to this category, the fewest possible.", d:["5 CWEs are mapped to this category, a relatively small set.", "15 CWEs are mapped to this category, about the average.", "33 CWEs are mapped to this category, among the highest."], e:"A10 has only 1 mapped CWE (CWE-918), making it the most narrowly defined category."},
    {c:"A10 SSRF", q:"What does SSRF allow an attacker to do according to OWASP?", a:"Force the server to make requests to unintended destinations, even past firewalls.", d:["Force the client browser to make requests to internal network destinations.", "Inject malicious scripts into the server's response sent back to users.", "Bypass authentication by replaying captured session tokens from the network."], e:"SSRF forces the server-side application to make requests to an unintended destination, bypassing network controls."},
    {c:"A10 SSRF", q:"OWASP notes that SSRF incidence is increasing because of what trend?", a:"Modern applications increasingly fetch remote resources from URLs supplied by users.", d:["Legacy applications are being decommissioned faster than replacements are built.", "Organisations are moving to air-gapped networks that prevent all external access.", "Browser security improvements have shifted all attacks to the server side only."], e:"OWASP notes that SSRF is increasing because modern application concepts encourage fetching URLs provided by users."},
    {c:"A10 SSRF", q:"What does OWASP recommend as a network-layer defence against SSRF?", a:"Segment remote resource access into separate networks to reduce SSRF impact.", d:["Allow all outbound traffic from application servers for maximum functionality.", "Block only port 22 outbound and permit all other ports for flexibility.", "Disable DNS resolution on application servers to prevent URL-based attacks."], e:"OWASP recommends network segmentation to reduce SSRF impact at the network layer."},
    {c:"A10 SSRF", q:"What application-layer defence does OWASP recommend against SSRF?", a:"Validate and sanitize all client-supplied input data including URL destinations.", d:["Trust all URLs submitted by authenticated users without additional validation.", "Block only URLs that contain the string 'localhost' in the hostname portion.", "Apply URL validation only for GET requests and skip it for POST requests."], e:"OWASP recommends sanitizing and validating all client-supplied input data at the application layer."},
    {c:"A10 SSRF", q:"According to OWASP, what should applications avoid sending to clients in SSRF prevention?", a:"Raw server responses — do not forward raw responses from backend requests to clients.", d:["Compressed responses — always send uncompressed data to simplify client parsing.", "JSON responses — use XML format instead for all server-to-client communications.", "Cached responses — disable caching entirely to prevent stale data forwarding."], e:"OWASP recommends not sending raw responses to clients to prevent information disclosure through SSRF."},
    {c:"A10 SSRF", q:"What URL schema enforcement does OWASP recommend to prevent SSRF?", a:"Enforce a positive allow-list of permitted URL schemas, ports, and destinations.", d:["Block only the file:// schema and allow all other URL schemas by default.", "Allow all schemas but require HTTPS for external destinations specifically.", "Enforce schema restrictions on inbound requests only, not outbound ones."], e:"OWASP recommends a positive allow-list approach for URL schemas, ports, and destinations."},
    {c:"A10 SSRF", q:"OWASP warns that SSRF can be used to access what type of service in cloud environments?", a:"Cloud instance metadata services such as AWS EC2 metadata at 169.254.169.254.", d:["Cloud billing APIs that display monthly cost summaries and usage dashboards.", "Cloud marketplace listings that show available virtual machine image options.", "Cloud documentation portals that host API reference guides and tutorials."], e:"SSRF is commonly used to access cloud metadata services (e.g., AWS 169.254.169.254) to steal credentials."},
    {c:"A10 SSRF", q:"What does OWASP recommend about HTTP redirects in the context of SSRF?", a:"Do not follow HTTP redirects, as attackers use them to bypass SSRF protections.", d:["Always follow HTTP redirects to maintain compatibility with third-party APIs.", "Follow redirects only if the target URL is on the same hostname as the origin.", "Follow redirects up to five times before terminating the request chain."], e:"OWASP recommends not following HTTP redirects as they can be used to bypass SSRF URL validation."},
    {c:"A10 SSRF", q:"What is the average incidence rate for A10 SSRF in the 2021 dataset?", a:"2.72% average incidence across tested applications.", d:["0.10% average incidence across tested applications.", "8.75% average incidence across tested applications.", "19.0% average incidence across tested applications."], e:"A10 had an average incidence rate of 2.72% in the contributed dataset."},
    {c:"A10 SSRF", q:"OWASP scenario #1 for A10 describes SSRF targeting what?", a:"Internal services — port scanning internal networks through the vulnerable server.", d:["External APIs — sending spam requests to third-party payment processors.", "Client browsers — injecting JavaScript into pages viewed by other users.", "DNS servers — poisoning DNS cache entries for the application's domain name."], e:"Scenario #1 describes attackers using SSRF to port scan internal networks behind the firewall."},
    {c:"A10 SSRF", q:"OWASP scenario #2 for A10 describes SSRF to access what?", a:"Sensitive local files — reading data using file:// URLs on the application server.", d:["External websites — scraping content from competitor sites via the server.", "Cloud marketplace — purchasing additional server instances via metadata APIs.", "Email inboxes — reading administrator email through IMAP protocol via the server."], e:"Scenario #2 describes attackers using file:// URLs through SSRF to access local files."},
    {c:"A10 SSRF", q:"What does OWASP recommend regarding deny-by-default firewall rules for SSRF?", a:"Block all inbound and outbound traffic that is not essential to the application.", d:["Allow all outbound traffic and restrict only inbound connections to the server.", "Block inbound traffic from the internet but allow all internal network access.", "Apply firewall rules only to the database tier, not to the application tier."], e:"OWASP recommends deny-by-default firewall rules that block all non-essential network traffic."},
    {c:"A10 SSRF", q:"OWASP notes SSRF severity increases when combined with what?", a:"Access to cloud metadata services, internal APIs, or sensitive internal systems.", d:["Access to static content delivery networks serving public image assets.", "Access to public documentation websites and open API reference portals.", "Access to external search engines and publicly available web indexing data."], e:"SSRF severity increases significantly when it grants access to metadata services, internal APIs, or sensitive internal systems."},
    {c:"A10 SSRF", q:"What does OWASP say about using deny lists to prevent SSRF?", a:"Deny lists are insufficient — attackers bypass them using redirects and DNS rebinding.", d:["Deny lists are the most effective defence when combined with regex-based URL filtering.", "Deny lists fully mitigate SSRF when they include all RFC 1918 private IP addresses.", "Deny lists are unnecessary because web application firewalls handle SSRF by default."], e:"OWASP warns that deny lists alone are insufficient; attackers can bypass them using various techniques."},
    {c:"A10 SSRF", q:"What is the maximum incidence rate for A10 SSRF in the 2021 dataset?", a:"7.72% maximum incidence across tested applications.", d:["2.72% maximum incidence across tested applications.", "19.84% maximum incidence across tested applications.", "46.44% maximum incidence across tested applications."], e:"A10 had a maximum incidence rate of 7.72% in the contributed data."},
    {c:"A10 SSRF", q:"According to OWASP, what type of DNS resolution control helps mitigate SSRF?", a:"Implement DNS resolution validation to prevent DNS rebinding and TOCTOU attacks.", d:["Disable all DNS resolution and hardcode IP addresses for every external service.", "Use only public DNS resolvers like 8.8.8.8 without any additional validation.", "Cache DNS results indefinitely to prevent repeated resolution of the same hostname."], e:"OWASP recommends DNS resolution validation to prevent DNS rebinding attacks that bypass SSRF protections."},
    {c:"A10 SSRF", q:"CWE-918, the sole CWE mapped to A10, describes which vulnerability?", a:"Server-Side Request Forgery: the server makes requests to attacker-chosen destinations.", d:["Cross-Site Request Forgery: the browser makes requests on behalf of the attacker.", "Open Redirect: the server redirects users to attacker-controlled external URLs.", "Remote File Inclusion: the server includes and executes attacker-hosted code files."], e:"CWE-918 is specifically SSRF — where the server-side application can be induced to make requests to attacker-chosen destinations."},

    // --- GENERAL (22) ---
    {c:"General", q:"How many new categories were introduced in the OWASP Top 10:2021 edition?", a:"Three new categories: Insecure Design, Integrity Failures, and SSRF.", d:["One new category: Server-Side Request Forgery, based on community voting.", "Two new categories: Insecure Design and Security Logging and Monitoring.", "Five new categories replacing half the entries from the 2017 edition."], e:"Three new categories were added: A04 Insecure Design, A08 Software and Data Integrity Failures, and A10 SSRF."},
    {c:"General", q:"How were the 2021 Top 10 categories selected?", a:"Eight from contributed data analysis and two from a community survey.", d:["All ten from automated vulnerability scanner data analysis only.", "All ten from a community survey of security professionals worldwide.", "Five from contributed data and five from vendor-sponsored research."], e:"Eight categories were data-driven and two (A01 SSRF was community survey #1, A09 Logging was #3) came from the community survey."},
    {c:"General", q:"What methodology change did OWASP adopt for the 2021 data collection?", a:"Opened CWE collection to all CWEs instead of a prescribed subset of about thirty.", d:["Restricted collection to only the top five CWEs by known exploit frequency.", "Used the same prescribed CWE subset approach as the 2017 data collection.", "Collected data only from automated SAST and DAST tools, not manual testing."], e:"The 2021 edition opened data collection to all CWEs rather than limiting to a prescribed subset."},
    {c:"General", q:"What does OWASP emphasize as the primary focus shift in the 2021 Top 10?", a:"Moving from symptoms to root causes wherever possible across all categories.", d:["Moving from root causes to business impact scoring across all categories.", "Moving from manual testing to fully automated scanning across all categories.", "Moving from web application risks to cloud-native infrastructure risks only."], e:"OWASP emphasizes shifting focus from symptoms to root causes in the 2021 edition."},
    {c:"General", q:"Which 2017 category was removed as a standalone entry and merged into A03:2021?", a:"A7:2017 Cross-Site Scripting was merged into the Injection category.", d:["A4:2017 XML External Entities was merged into the Injection category.", "A8:2017 Insecure Deserialization was merged into the Injection category.", "A10:2017 Insufficient Logging was merged into the Injection category."], e:"XSS (A7:2017) was merged into A03:2021 Injection as it's fundamentally an injection flaw."},
    {c:"General", q:"Which 2017 category was merged into A05:2021 Security Misconfiguration?", a:"A4:2017 XML External Entities was absorbed into Security Misconfiguration.", d:["A7:2017 Cross-Site Scripting was absorbed into Security Misconfiguration.", "A8:2017 Insecure Deserialization was absorbed into Security Misconfiguration.", "A2:2017 Broken Authentication was absorbed into Security Misconfiguration."], e:"XXE (A4:2017) was merged into A05:2021 Security Misconfiguration as it's fundamentally a configuration issue."},
    {c:"General", q:"What does OWASP say about tools being able to comprehensively cover the Top 10?", a:"Tools cannot comprehensively cover it, and OWASP discourages vendors from claiming so.", d:["A single DAST tool can fully cover all ten categories with proper configuration.", "Combined SAST and DAST tools provide complete coverage of all ten categories.", "OWASP certifies specific commercial tools that fully cover all ten categories."], e:"OWASP explicitly states tools cannot fully cover the Top 10 and discourages claims of comprehensive coverage."},
    {c:"General", q:"According to OWASP, should the Top 10 be used as a security standard?", a:"No — it is an awareness document; ASVS is better suited as a verification standard.", d:["Yes — it is the definitive security standard for all web application projects.", "Yes — compliance with the Top 10 is sufficient to guarantee application security.", "Yes — but only for small applications with fewer than ten thousand users."], e:"OWASP positions the Top 10 as awareness, recommending ASVS (Application Security Verification Standard) as the standard."},
    {c:"General", q:"What is the OWASP ASVS relationship to the Top 10?", a:"ASVS provides comprehensive verification requirements; the Top 10 is entry-level awareness.", d:["They are the same document published under two different names for audiences.", "ASVS replaced the Top 10 and the Top 10 is no longer maintained by OWASP.", "The Top 10 is more comprehensive than ASVS and covers additional risk categories."], e:"The Top 10 serves as entry-level awareness while ASVS provides comprehensive training and verification requirements."},
    {c:"General", q:"Which 2021 category had the most total occurrences in the contributed dataset?", a:"A01: Broken Access Control with over 318,000 total occurrences.", d:["A03: Injection with approximately 274,000 total occurrences.", "A05: Security Misconfiguration with approximately 208,000 total occurrences.", "A02: Cryptographic Failures with approximately 233,000 total occurrences."], e:"Broken Access Control had 318k+ occurrences, the highest in the dataset."},
    {c:"General", q:"What impact scoring system did OWASP use for the 2021 edition?", a:"CVE and CVSS data, specifically targeting CVSSv3 exploit and impact scores.", d:["A proprietary OWASP scoring system developed specifically for the Top 10.", "Only expert panel voting without any automated data-driven analysis.", "Only raw incidence rate data without any severity or impact weighting."], e:"OWASP used CVSS exploit and impact scores from mapped CVEs, noting limitations of CVSSv2."},
    {c:"General", q:"What approach does OWASP recommend for starting an AppSec programme?", a:"Use the Top 10 as an entry point, then graduate to ASVS for comprehensive requirements.", d:["Start with extensive penetration testing before establishing any formal programme.", "Start with a compliance audit to determine which regulations apply to the organisation.", "Start by purchasing commercial security tools before defining any process or policy."], e:"OWASP recommends using the Top 10 for initial awareness and then adopting ASVS for comprehensive security."},
    {c:"General", q:"What type of data sources contributed to the 2021 Top 10?", a:"Security vendors, consultancies, bug bounties, and organisational contributions.", d:["Only automated scanner results from commercial SAST and DAST tool vendors.", "Only penetration test reports submitted by CREST-certified testing companies.", "Only academic research papers published in peer-reviewed security journals."], e:"The 2021 dataset came from diverse sources including vendors, consultancies, bug bounties, and organisations."},
    {c:"General", q:"According to OWASP, what is the relationship between the Top 10 and penetration testing?", a:"The Top 10 provides only a bare minimum starting point for pentest coverage.", d:["The Top 10 provides comprehensive and sufficient penetration test coverage.", "Penetration testing should not reference the Top 10 at any stage of testing.", "The Top 10 is only intended for developers and has no relevance to testers."], e:"OWASP explicitly describes the Top 10 as a bare minimum for penetration testing in its use case matrix."},
    {c:"General", q:"What category had the highest weighted impact from CVE/CVSS data?", a:"A08: Software and Data Integrity Failures had the highest weighted impact.", d:["A01: Broken Access Control had the highest weighted impact from CVSS data.", "A03: Injection had the highest weighted impact from CVSS data in the dataset.", "A10: Server-Side Request Forgery had the highest weighted impact from CVSS."], e:"A08 had one of the highest weighted impacts from CVE/CVSS data across its mapped CWEs."},
    {c:"General", q:"How did OWASP change its data collection approach from 2017 to 2021?", a:"Opened collection to all CWEs, removing the previous restriction to about thirty CWEs.", d:["Restricted collection to only the top five CWEs by known exploitation frequency.", "Used the same approach as 2017 with no changes to the data collection methodology.", "Collected data only from automated tool output, excluding any manual test findings."], e:"The 2021 edition opened data collection to all CWEs rather than limiting to a prescribed subset."},
    {c:"General", q:"What does OWASP recommend as a use case for the Top 10 regarding secure code review?", a:"The Top 10 provides a bare minimum checklist for secure code review activities.", d:["It provides comprehensive code review coverage sufficient for critical applications.", "It should not be used for code review as it is only relevant to infrastructure teams.", "It provides moderate coverage that replaces the need for ASVS-based code review."], e:"OWASP positions the Top 10 as a bare minimum checklist for secure code review."},
    {c:"General", q:"How does OWASP distinguish between HaT and TaH testing methodologies?", a:"HaT is automated tools with human verification; TaH is human expertise aided by tools.", d:["They are identical approaches that OWASP uses interchangeably in its documentation.", "Only HaT data was accepted for the 2021 dataset; TaH data was excluded entirely.", "Only TaH data was accepted for the 2021 dataset; HaT data was excluded entirely."], e:"OWASP normalized data between HaT and TaH approaches to enable fair comparison across different testing methodologies."},
    {c:"General", q:"What was the first year OWASP Top 10 was published?", a:"2003 — the 2021 edition marks the list's twentieth anniversary.", d:["2007 — the 2021 edition marks the list's fourteenth anniversary.", "2010 — the 2021 edition marks the list's eleventh anniversary.", "2013 — the 2021 edition marks the list's eighth anniversary."], e:"The first OWASP Top 10 was published in 2003, with the 2021 edition marking the 20th anniversary of OWASP."},
    {c:"General", q:"What category absorbed A8:2017 Insecure Deserialization in the 2021 edition?", a:"A08:2021 Software and Data Integrity Failures absorbed it as a broader category.", d:["A03:2021 Injection absorbed it as deserialization is a form of input handling.", "A05:2021 Security Misconfiguration absorbed it as a configuration-level issue.", "A04:2021 Insecure Design absorbed it as a fundamental architecture weakness."], e:"Insecure Deserialization was merged into the new A08 Software and Data Integrity Failures category."},
    {c:"General", q:"What is the total number of CWEs mapped across all 2021 Top 10 categories?", a:"Approximately 196 CWEs mapped across all ten categories combined.", d:["Approximately 50 CWEs mapped across all ten categories combined.", "Approximately 100 CWEs mapped across all ten categories combined.", "Approximately 300 CWEs mapped across all ten categories combined."], e:"The total mapped CWEs across all categories is approximately 196 (34+29+33+40+20+3+22+10+4+1)."},
    {c:"General", q:"According to OWASP, which category has the single narrowest CWE scope?", a:"A10: SSRF with just 1 mapped CWE, the most narrowly scoped category.", d:["A06: Vulnerable Components with 3 mapped CWEs in total across the category.", "A09: Logging Failures with 4 mapped CWEs in total across the category.", "A08: Integrity Failures with 10 mapped CWEs in total across the category."], e:"A10 SSRF has only CWE-918 mapped, making it the most narrowly defined category in the Top 10."},
];

// --- QUIZ LOGIC ---
const MASTER_POOL = pool_part_1.concat(pool_part_2);
let examQs = [], userAns = {}, flagged = {}, curr = 0, answered = {};

function initExam() {
    let pool = [...MASTER_POOL];
    for (let i = pool.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [pool[i], pool[j]] = [pool[j], pool[i]];
    }
    examQs = pool.slice(0, 120);
    userAns = {}; flagged = {}; answered = {}; curr = 0;

    // Pre-shuffle options for each question
    examQs.forEach((q, i) => {
        let opts = [q.a, ...q.d];
        for (let j = opts.length - 1; j > 0; j--) {
            const k = Math.floor(Math.random() * (j + 1));
            [opts[j], opts[k]] = [opts[k], opts[j]];
        }
        examQs[i]._opts = opts;
    });

    document.getElementById('start-screen').style.display='none';
    document.getElementById('results-screen').style.display='none';
    document.getElementById('exam-ui').style.display='flex';
    document.getElementById('footer').style.display='flex';

    renderSide(); loadQ(0); updateProgress();
}

function updateProgress() {
    const cnt = Object.keys(answered).length;
    document.getElementById('progress-display').innerText = `${cnt} / 120`;
    document.getElementById('finish-btn').style.display = cnt === 120 ? 'inline-block' : 'none';
}

function renderSide() {
    const sb = document.getElementById('sidebar'); sb.innerHTML='';
    examQs.forEach((q,i) => {
        const b = document.createElement('button');
        b.className = 'nav-btn'; b.innerText = i+1;
        b.id = `nav-${i}`; b.onclick = () => loadQ(i);
        sb.appendChild(b);
    });
}

function loadQ(i) {
    curr = i;
    const q = examQs[i];

    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
    document.getElementById(`nav-${i}`).classList.add('active');
    document.getElementById('status').innerText = `Q ${i+1} / 120`;

    const con = document.getElementById('question-container'); con.innerHTML='';
    const card = document.createElement('div'); card.className='card';

    let html = `<div class="q-meta"><span class="tag">${q.c}</span><span class="q-num">#${i+1}</span></div><div class="q-text">${q.q}</div>`;

    const isAnswered = answered[i] !== undefined;

    q._opts.forEach((o, oi) => {
        let cls = 'option';
        if (isAnswered) {
            cls += ' locked';
            if (o === q.a) cls += ' opt-correct';
            else if (o === userAns[i]) cls += ' opt-wrong';
            else cls += ' opt-dim';
        }
        const clickHandler = isAnswered ? '' : `onclick="ans(${i}, ${oi})"`;
        html += `<div class="${cls}" ${clickHandler}>${o}</div>`;
    });

    if (isAnswered) {
        const wasCorrect = userAns[i] === q.a;
        html += `<div class="explanation-box"><strong>${wasCorrect ? '✓ Correct' : '✗ Incorrect'}</strong><br>${q.e}</div>`;
        if (i < 119) {
            html += `<div class="next-btn-wrap"><button class="btn btn-p" onclick="loadQ(${i+1})">Next Question →</button></div>`;
        }
    }

    card.innerHTML = html; con.appendChild(card);
    con.scrollTop = 0;
}

function ans(qi, optIdx) {
    const q = examQs[qi];
    userAns[qi] = q._opts[optIdx];
    answered[qi] = true;

    const navBtn = document.getElementById(`nav-${qi}`);
    if (userAns[qi] === q.a) {
        navBtn.classList.add('answered-correct');
    } else {
        navBtn.classList.add('answered-wrong');
    }

    loadQ(qi);
    updateProgress();
}

function nav(d) {
    const n = curr + d;
    if(n >= 0 && n < 120) loadQ(n);
}

function flag() {
    flagged[curr] = !flagged[curr];
    const b = document.getElementById(`nav-${curr}`);
    if(flagged[curr]) b.classList.add('flagged'); else b.classList.remove('flagged');
}

function finish() {
    if(!confirm('Finish the quiz and see your results?')) return;
    document.getElementById('exam-ui').style.display='none';
    document.getElementById('footer').style.display='none';

    const resScreen = document.getElementById('results-screen');
    resScreen.style.display='block';
    resScreen.scrollTop = 0;

    let score = 0;
    let html = '';

    examQs.forEach((q, i) => {
        const correct = userAns[i] === q.a;
        if(correct) score++;
        html += `<div class="review-item ${correct?'correct':'wrong'}">
            <strong>Q${i+1} [${q.c}]: ${q.q}</strong><br>
            Your Answer: <b style="color:${correct?'#4ade80':'#f87171'}">${userAns[i]||'Skipped'}</b><br>
            ${!correct ? `Correct Answer: <b style="color:#4ade80">${q.a}</b>` : ''}
            <div class="review-explanation">Rationale: ${q.e}</div>
        </div>`;
    });

    const pct = Math.round((score/120)*100);

    document.getElementById('score-circle').innerText = `${pct}%`;
    document.getElementById('raw-score').innerText = `You answered ${score} out of 120 questions correctly.`;
    document.getElementById('review-list').innerHTML = html;
}
</script>
</body>
</html>
