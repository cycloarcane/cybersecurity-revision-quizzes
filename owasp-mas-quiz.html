<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OWASP Mobile Application Security Quiz</title>
<style>
    @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Source+Sans+3:wght@400;600;700;900&display=swap');
    :root { --header:#1a1a2e; --bg:#0f0f1a; --white:#16213e; --primary:#e94560; --success:#0f9b58; --danger:#e94560; --warning:#f5a623; --text:#e0e0e0; --card:#16213e; --accent:#533483; --border:#2a2a4a; }
    ::-webkit-scrollbar { width:10px; } ::-webkit-scrollbar-track { background:#0a0a15; } ::-webkit-scrollbar-thumb { background:#533483; border-radius:5px; border:2px solid #0a0a15; }
    * { box-sizing:border-box; }
    body { font-family:'Source Sans 3',sans-serif; background:var(--bg); color:var(--text); margin:0; display:flex; flex-direction:column; height:100vh; overflow:hidden; }
    .header { background:linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%); color:#fff; padding:15px 30px; display:flex; justify-content:space-between; align-items:center; box-shadow:0 4px 20px rgba(233,69,96,0.15); flex-shrink:0; z-index:10; border-bottom:2px solid var(--primary); }
    .header-title { font-family:'JetBrains Mono',monospace; font-size:1.4em; font-weight:700; letter-spacing:1px; }
    .header-title span { color:var(--primary); }
    .progress-text { font-family:'JetBrains Mono',monospace; font-size:1.1em; font-weight:700; color:var(--warning); background:rgba(0,0,0,0.4); padding:6px 18px; border-radius:6px; border:1px solid rgba(245,166,35,0.3); }
    .main { display:flex; flex:1; overflow:hidden; }
    .sidebar { width:260px; background:#111125; border-right:1px solid var(--border); overflow-y:auto; padding:12px; display:grid; grid-template-columns:repeat(5,1fr); gap:6px; align-content:start; flex-shrink:0; }
    .nav-btn { height:34px; border:1px solid var(--border); background:#1a1a2e; cursor:pointer; font-weight:700; font-size:0.82em; border-radius:5px; transition:all 0.15s; color:#8888aa; font-family:'JetBrains Mono',monospace; }
    .nav-btn:hover { background:#2a2a4a; color:#ccc; border-color:#533483; }
    .nav-btn.active { background:var(--primary); color:white; border-color:var(--primary); box-shadow:0 0 10px rgba(233,69,96,0.4); }
    .nav-btn.answered-correct { background:#0d2818; border-color:var(--success); color:#4ade80; }
    .nav-btn.answered-wrong { background:#2d1018; border-color:var(--danger); color:#f87171; }
    .nav-btn.flagged { border:2px solid var(--warning); box-shadow:0 0 8px rgba(245,166,35,0.3); }
    .content { flex:1; padding:35px; overflow-y:auto; display:flex; justify-content:center; align-items:flex-start; }
    .card { background:var(--card); max-width:900px; width:100%; padding:45px; border-radius:12px; box-shadow:0 8px 32px rgba(0,0,0,0.3); margin-bottom:40px; border:1px solid var(--border); }
    .q-meta { display:flex; justify-content:space-between; align-items:center; margin-bottom:22px; border-bottom:1px solid var(--border); padding-bottom:14px; }
    .tag { background:var(--primary); color:white; padding:5px 14px; border-radius:20px; font-size:0.8em; font-weight:700; text-transform:uppercase; letter-spacing:1px; font-family:'JetBrains Mono',monospace; }
    .q-num { color:#666; font-family:'JetBrains Mono',monospace; font-size:0.9em; }
    .q-text { font-size:1.25em; font-weight:600; margin-bottom:30px; line-height:1.55; color:#e8e8e8; }
    .option { width:100%; text-align:left; padding:16px 22px; margin-bottom:12px; background:#111125; border:2px solid var(--border); border-radius:8px; cursor:pointer; font-size:1.05em; transition:all 0.2s; color:#c0c0d0; display:block; font-family:'Source Sans 3',sans-serif; }
    .option:hover:not(.locked) { border-color:#533483; background:#1a1a35; color:#e0e0e0; }
    .option.locked { cursor:default; }
    .option.opt-correct { border-color:var(--success); background:rgba(15,155,88,0.15); color:#4ade80; font-weight:700; }
    .option.opt-wrong { border-color:var(--danger); background:rgba(233,69,96,0.1); color:#f87171; }
    .option.opt-dim { opacity:0.5; }
    .explanation-box { margin-top:24px; padding:18px 22px; background:rgba(83,52,131,0.15); border:1px solid rgba(83,52,131,0.3); border-radius:8px; font-size:1em; color:#c8c0d8; line-height:1.6; }
    .explanation-box strong { color:#e0d0f0; }
    .next-btn-wrap { text-align:center; margin-top:22px; }
    .footer { background:#111125; padding:14px 35px; border-top:1px solid var(--border); display:flex; justify-content:space-between; align-items:center; flex-shrink:0; }
    .btn { padding:11px 28px; border:none; border-radius:6px; font-size:1.05em; font-weight:700; cursor:pointer; color:white; font-family:'Source Sans 3',sans-serif; transition:all 0.2s; }
    .btn:hover { transform:translateY(-1px); }
    .btn-s { background:#2a2a4a; } .btn-s:hover { background:#3a3a5a; }
    .btn-p { background:var(--primary); } .btn-p:hover { background:#d13555; }
    .btn-w { background:var(--warning); color:#111; } .btn-w:hover { background:#e09515; }
    .btn-g { background:var(--success); } .btn-g:hover { background:#0d8a4e; }
    #start-screen, #results-screen { position:fixed; top:0; left:0; width:100%; height:100%; background:var(--bg); z-index:2000; overflow-y:auto; }
    .center-wrapper { display:flex; flex-direction:column; align-items:center; justify-content:center; min-height:100vh; padding:40px; box-sizing:border-box; }
    .start-box { background:var(--card); padding:60px; border-radius:16px; box-shadow:0 20px 60px rgba(0,0,0,0.4); max-width:850px; text-align:center; border:1px solid var(--border); position:relative; overflow:hidden; }
    .start-box::before { content:''; position:absolute; top:0; left:0; right:0; height:4px; background:linear-gradient(90deg, var(--primary), var(--accent), var(--primary)); }
    .start-box h1 { color:#fff; margin-bottom:8px; font-size:2.8em; font-family:'JetBrains Mono',monospace; letter-spacing:2px; }
    .start-box h1 span { color:var(--primary); }
    .start-box .subtitle { font-size:1em; color:#666; margin-bottom:30px; font-family:'JetBrains Mono',monospace; letter-spacing:3px; text-transform:uppercase; }
    .start-box p { font-size:1.15em; line-height:1.7; color:#999; margin:25px 0; }
    .start-box .stats { display:flex; justify-content:center; gap:40px; margin:30px 0; }
    .start-box .stat { text-align:center; }
    .start-box .stat-num { font-size:2.2em; font-weight:900; color:var(--primary); font-family:'JetBrains Mono',monospace; }
    .start-box .stat-label { font-size:0.85em; color:#666; text-transform:uppercase; letter-spacing:2px; margin-top:4px; }
    .score-circle { width:200px; height:200px; border-radius:50%; display:flex; justify-content:center; align-items:center; font-size:3.8em; font-weight:900; color:white; margin:20px auto; box-shadow:0 10px 30px rgba(0,0,0,0.3); font-family:'JetBrains Mono',monospace; background:linear-gradient(135deg, var(--accent), #3a2066); border:6px solid #2a1850; }
    .review-item { text-align:left; background:var(--card); padding:22px; margin-bottom:16px; border-radius:10px; border-left:6px solid #444; width:100%; max-width:800px; box-shadow:0 2px 10px rgba(0,0,0,0.2); border:1px solid var(--border); }
    .review-item.correct { border-left-color:var(--success); }
    .review-item.wrong { border-left-color:var(--danger); }
    .review-item strong { color:#e0e0e0; }
    .review-explanation { margin-top:12px; font-size:0.92em; color:#aaa; background:rgba(83,52,131,0.15); padding:14px; border-radius:6px; border:1px solid rgba(83,52,131,0.3); }
    #status { font-weight:700; color:#666; font-size:1.05em; font-family:'JetBrains Mono',monospace; }
</style>
</head>
<body>

<div id="start-screen">
    <div class="center-wrapper">
        <div class="start-box">
            <h1><span>OWASP</span> MAS</h1>
            <div class="subtitle">Mobile Application Security</div>
            <div class="stats">
                <div class="stat"><div class="stat-num">120</div><div class="stat-label">Questions</div></div>
                <div class="stat"><div class="stat-num">Self-paced</div><div class="stat-label">No Timer</div></div>
            </div>
            <p>
                Covers all 8 MASVS categories: Storage, Cryptography, Authentication &amp; Authorization,
                Network Communication, Platform Interaction, Code Quality, Resilience &amp; Privacy.<br>
                Based on MASVS v2.x, MASTG, and MASWE.<br>
                <em style="color:#666;">Questions selected from a pool. Explanation shown after each answer.</em>
            </p>
            <button class="btn btn-p" onclick="initExam()" style="padding:16px 55px; font-size:1.25em; margin-top:10px;">Start Quiz</button>
        </div>
    </div>
</div>

<div class="header">
    <div class="header-title"><span>OWASP</span> MAS Quiz</div>
    <div id="progress-display" class="progress-text">0 / 120</div>
</div>

<div class="main" id="exam-ui" style="display:none;">
    <div class="sidebar" id="sidebar"></div>
    <div class="content" id="question-container"></div>
</div>

<div class="footer" id="footer" style="display:none;">
    <div><button class="btn btn-s" onclick="nav(-1)">Previous</button> <button class="btn btn-w" onclick="flag()" style="margin-left:10px;">Flag</button></div>
    <div id="status">Q 1 / 120</div>
    <div><button class="btn btn-g" id="finish-btn" onclick="finish()" style="display:none;">Finish Quiz</button></div>
</div>

<div id="results-screen" style="display:none;">
    <div class="center-wrapper" style="justify-content:flex-start; padding-top:50px;">
        <div style="background:var(--card); padding:40px; border-radius:12px; max-width:800px; width:100%; box-shadow:0 10px 40px rgba(0,0,0,0.3); text-align:center; border:1px solid var(--border);">
            <h1 style="margin:0; color:#fff; font-family:'JetBrains Mono',monospace;">Quiz Results</h1>
            <div id="score-circle" class="score-circle">0%</div>
            <div id="raw-score" style="font-size:1.2em; color:#aaa; margin-bottom:25px; font-family:'JetBrains Mono',monospace;"></div>
            <button class="btn btn-p" onclick="location.reload()">Take New Quiz</button>
        </div>
        <div id="review-list" style="width:100%; max-width:800px; margin-top:25px;"></div>
    </div>
</div>

<script>
const TOTAL = 120;
const pool = [
    // ========== MASVS-STORAGE (15 questions) ==========
    {c:"MASVS-STORAGE", q:"What does MASVS-STORAGE-1 require regarding sensitive data stored by the application?", a:"Sensitive data must be properly protected regardless of storage location.", d:["Sensitive data should only be stored on the device's external SD card.", "Sensitive data requires encryption solely when stored in cloud backups.", "Sensitive data needs protection only when placed in public directories."], e:"MASVS-STORAGE-1 ensures any sensitive data intentionally stored by the app is properly protected independently of the target location, whether private or public."},
    {c:"MASVS-STORAGE", q:"According to MASVS-STORAGE-2, what type of data leakage must the app prevent?", a:"Unintentional exposure of sensitive data via system features like logs or backups.", d:["Deliberate sharing of user preferences with analytics and advertising services.", "Transmission of encrypted payloads to remote endpoints over secure channels.", "Storage of non-sensitive configuration values inside application sandbox files."], e:"MASVS-STORAGE-2 covers unintentional leaks where sensitive data is stored or exposed to publicly accessible locations as a side-effect of using certain APIs, backups, or logs."},
    {c:"MASVS-STORAGE", q:"On Android, which storage mechanism commonly leads to plaintext sensitive data exposure?", a:"SharedPreferences files stored without encryption in the app sandbox directory.", d:["AES-256 encrypted blobs placed inside the Android KeyStore secure container.", "Hardware-backed credential storage managed by the StrongBox secure element.", "Files protected with the Android Data Protection API at the highest class level."], e:"SharedPreferences stores data as plaintext XML by default. EncryptedSharedPreferences from the Jetpack Security library should be used for sensitive data."},
    {c:"MASVS-STORAGE", q:"What is the MASWE weakness related to sensitive data appearing in application log output?", a:"MASWE-0001: Insertion of Sensitive Data into Logs, exposing it to other apps.", d:["MASWE-0050: Cleartext Traffic, transmitting data without transport encryption.", "MASWE-0089: Code Obfuscation Not Implemented, revealing internal app logic.", "MASWE-0110: Use of Unique Identifiers for User Tracking across sessions."], e:"MASWE-0001 specifically addresses the risk of inserting sensitive data into logs, which on Android can be read by other apps with appropriate permissions."},
    {c:"MASVS-STORAGE", q:"Which iOS data protection class provides the strongest file protection at rest?", a:"NSFileProtectionComplete, making files inaccessible when the device is locked.", d:["NSFileProtectionNone, allowing unrestricted access to files at all device states.", "NSFileProtectionCompleteUntilFirstUserAuthentication, for boot-time access.", "NSFileProtectionCompleteUnlessOpen, permitting writes while device is locked."], e:"NSFileProtectionComplete ensures files are only accessible when the device is unlocked, providing the strongest data-at-rest protection available on iOS."},
    {c:"MASVS-STORAGE", q:"Why does the MASTG recommend testing for sensitive data in device backups?", a:"Backups may include app sandbox data that contains unencrypted sensitive values.", d:["Backups are always encrypted by default on both Android and iOS platforms.", "Backup files are stored exclusively on the device and never leave it locally.", "Testing backups only matters for apps that explicitly enable the backup feature."], e:"Both Android and iOS backups can include app data. If sensitive data isn't excluded from backups, it may be exposed when backups are stored on computers or cloud services."},
    {c:"MASVS-STORAGE", q:"On Android, what is the recommended approach to exclude sensitive files from backup?", a:"Configure backup_rules.xml to explicitly exclude files containing sensitive data.", d:["Set the android:allowBackup flag to true in the application's manifest element.", "Store all sensitive files on the device's external storage partition for safety.", "Rely on the operating system to automatically detect and exclude sensitive data."], e:"Android allows developers to specify backup rules in XML configuration files to control which files are included or excluded from auto backup and key-value backup."},
    {c:"MASVS-STORAGE", q:"What risk does the keyboard cache introduce for mobile application security?", a:"The predictive keyboard may cache sensitive input like passwords or card numbers.", d:["The keyboard cache improves performance by preloading cryptographic key material.", "Keyboard caching only affects system applications, never third-party mobile apps.", "The cache stores only application metadata and layout preferences, not user input."], e:"Mobile OS keyboard caches learn from user input for predictions. If sensitive fields don't disable autocomplete/autocorrect, credentials or financial data may be cached."},
    {c:"MASVS-STORAGE", q:"Which Android API should be used instead of SharedPreferences for storing sensitive values?", a:"EncryptedSharedPreferences from the Jetpack Security library for encrypted storage.", d:["The standard SQLiteDatabase API with default configuration and no extra parameters.", "The Environment.getExternalStorageDirectory() API for external file-based storage.", "The PackageManager API to store values as persistent application metadata entries."], e:"EncryptedSharedPreferences encrypts both keys and values using the Android Keystore, providing a secure alternative to the plaintext SharedPreferences API."},
    {c:"MASVS-STORAGE", q:"What does the MASTG recommend regarding sensitive data displayed in application screenshots?", a:"Apps should use platform APIs to prevent screenshots of screens showing sensitive data.", d:["Screenshots should be enabled everywhere to maintain smooth user experience flow.", "Only the login screen needs screenshot protection; all other screens are safe.", "Screenshots are handled entirely by the OS and cannot be controlled by mobile apps."], e:"Both Android (FLAG_SECURE, setRecentsScreenshotEnabled) and iOS provide APIs to prevent the system from capturing screenshots of sensitive screens."},
    {c:"MASVS-STORAGE", q:"According to MASWE-0006, what is the risk of storing sensitive data in private storage locations?", a:"Private storage without encryption is still accessible on rooted or jailbroken devices.", d:["Private storage locations are automatically encrypted by the mobile operating system.", "Data in private storage is always protected by hardware-backed biometric validation.", "Private storage files are deleted when the application enters the background state."], e:"MASWE-0006 addresses sensitive data stored unencrypted in private storage. While sandboxed, a rooted/jailbroken device or backup extraction can expose this data."},
    {c:"MASVS-STORAGE", q:"What is the recommended approach for handling sensitive data in application notifications?", a:"Avoid including sensitive details in notification content visible on the lock screen.", d:["Always display the full notification content regardless of device lock state status.", "Encrypt notification payloads using the app's RSA public key before displaying them.", "Disable all notifications entirely to prevent any possible leakage of user data."], e:"MASWE-0054 covers sensitive data leaked via notifications. Apps should use notification visibility settings to hide sensitive content when the device is locked."},
    {c:"MASVS-STORAGE", q:"On iOS, what is the purpose of the isExcludedFromBackupKey resource value?", a:"It marks specific files or directories to be excluded from iCloud and local backups.", d:["It enables automatic iCloud synchronisation for the specified file or directory.", "It triggers the deletion of files when the user performs a manual iCloud backup.", "It flags the file for inclusion in the iOS system diagnostic report during crashes."], e:"Setting isExcludedFromBackupKey to true on a file URL prevents that file from being included in iCloud or iTunes backups, protecting sensitive data."},
    {c:"MASVS-STORAGE", q:"Which MASWE weakness describes the risk of sensitive data in external storage on Android?", a:"MASWE-0007: Sensitive Data Stored Unencrypted in Shared Storage without user interaction.", d:["MASWE-0047: Insecure Identity Pinning causing certificate validation bypass on TLS.", "MASWE-0085: Unsafe Dynamic Code Loading enabling execution of untrusted payloads.", "MASWE-0097: Root/Jailbreak Detection Not Implemented leaving the platform unchecked."], e:"MASWE-0007 covers the risk of storing sensitive data unencrypted in shared/external storage, which is accessible to any app with storage permissions."},
    {c:"MASVS-STORAGE", q:"What does the MASTG recommend regarding sensitive data remaining in application process memory?", a:"Sensitive data should be cleared from memory as soon as it is no longer required.", d:["Memory management is handled entirely by the garbage collector and needs no action.", "Sensitive data in memory is only a concern for apps written in native C/C++ code.", "Process memory is always encrypted by the operating system's memory protection unit."], e:"The MASTG recommends minimizing the time sensitive data stays in memory and actively overwriting it when no longer needed to reduce exposure via memory dumps."},

    // ========== MASVS-CRYPTO (15 questions) ==========
    {c:"MASVS-CRYPTO", q:"What does MASVS-CRYPTO-1 require for cryptographic implementations in mobile apps?", a:"The app must use current strong cryptography following industry best practices.", d:["The app may use any cryptographic algorithm as long as it produces ciphertext.", "The app should implement custom encryption routines for maximum flexibility.", "The app needs cryptography only when communicating with third-party services."], e:"MASVS-CRYPTO-1 ensures apps employ current strong cryptography according to industry best practices, typically defined in standards like NIST SP 800-175B."},
    {c:"MASVS-CRYPTO", q:"According to MASVS-CRYPTO-2, what aspect of cryptography must follow industry best practices?", a:"Key management across the entire lifecycle including generation and storage.", d:["Only the selection of the symmetric encryption algorithm used for data at rest.", "Exclusively the choice of hash function applied to user-supplied password input.", "Just the configuration of TLS cipher suites for outbound network connections."], e:"MASVS-CRYPTO-2 focuses on cryptographic key management throughout the lifecycle — generation, storage, protection, rotation, and destruction — following industry best practices."},
    {c:"MASVS-CRYPTO", q:"Which MASWE weakness describes the use of hardcoded cryptographic keys in mobile apps?", a:"MASWE-0013: Hardcoded Cryptographic Keys in Use, extractable from the app package.", d:["MASWE-0050: Cleartext Traffic, sending data over unencrypted network connections.", "MASWE-0075: Enforced Updating Not Implemented, leaving old versions in the wild.", "MASWE-0104: App Integrity Not Verified, allowing modified copies to run normally."], e:"MASWE-0013 addresses hardcoded cryptographic keys embedded in the app code or resources, which can be extracted through reverse engineering."},
    {c:"MASVS-CRYPTO", q:"Why is the use of ECB mode for symmetric encryption considered insecure in mobile apps?", a:"ECB encrypts identical plaintext blocks to identical ciphertext, revealing patterns.", d:["ECB mode requires keys longer than 512 bits which most mobile devices cannot store.", "ECB is only available on Android and lacks cross-platform support for iOS devices.", "ECB mode produces ciphertext that is significantly larger than the original plaintext."], e:"ECB mode encrypts each block independently, so identical plaintext blocks produce identical ciphertext blocks, leaking data patterns. CBC, GCM, or CTR should be used instead."},
    {c:"MASVS-CRYPTO", q:"On Android, what is the recommended secure storage location for cryptographic keys?", a:"The Android KeyStore system, which can use hardware-backed secure storage.", d:["The application's SharedPreferences file as a Base64-encoded string value entry.", "A plaintext configuration file stored in the app's assets directory at build time.", "The device's external SD card in a hidden folder prefixed with a dot character."], e:"The Android KeyStore provides a secure container for cryptographic keys, with hardware-backed storage (TEE/StrongBox) available on supported devices."},
    {c:"MASVS-CRYPTO", q:"Which hashing algorithms does the MASTG consider broken and unsuitable for security purposes?", a:"MD5 and SHA-1, both of which have demonstrated practical collision vulnerabilities.", d:["SHA-256 and SHA-384, because their output lengths exceed most storage constraints.", "HMAC-SHA256 and PBKDF2, since they add unnecessary computational overhead cost.", "Argon2 and bcrypt, because they are too slow for real-time mobile app operations."], e:"MD5 and SHA-1 have known collision attacks and are considered cryptographically broken. The MASTG recommends SHA-256 or stronger hash functions."},
    {c:"MASVS-CRYPTO", q:"What does MASWE-0027 identify as a weakness in mobile applications?", a:"Improper Random Number Generation using predictable or non-cryptographic sources.", d:["Improper Certificate Validation allowing self-signed certificates to be trusted.", "Excessive Permission Requests asking for more access than the app requires.", "Missing Code Obfuscation enabling easy decompilation of the application binary."], e:"MASWE-0027 covers the use of non-cryptographic random number generators (like java.util.Random) for security-sensitive operations instead of secure alternatives."},
    {c:"MASVS-CRYPTO", q:"On Android, which class should be used for cryptographically secure random number generation?", a:"java.security.SecureRandom, which provides a cryptographically strong RNG source.", d:["java.util.Random, which offers fast pseudo-random number generation for all uses.", "java.lang.Math.random(), which returns a uniformly distributed double value result.", "android.os.SystemClock, which derives random values from the system uptime value."], e:"SecureRandom provides cryptographically strong random numbers suitable for security-sensitive operations like key generation and nonce creation."},
    {c:"MASVS-CRYPTO", q:"What is the minimum recommended key size for RSA encryption in mobile applications?", a:"2048 bits, with 3072 or 4096 bits recommended for longer-term data protection.", d:["512 bits, which provides adequate security for mobile device processing capacity.", "128 bits, matching the effective security level of AES-128 symmetric encryption.", "8192 bits, as anything smaller is considered trivially breakable by modern attacks."], e:"NIST recommends a minimum of 2048-bit RSA keys, with 3072+ bits for data that needs protection beyond 2030."},
    {c:"MASVS-CRYPTO", q:"Why are predictable Initialization Vectors (IVs) a security concern in mobile app cryptography?", a:"Reusing or predicting IVs can allow attackers to decrypt ciphertext or forge data.", d:["Predictable IVs cause the encryption process to consume excessive device battery.", "IVs that follow a pattern make the encrypted output incompatible with iOS devices.", "Using known IVs increases the ciphertext size by a factor proportional to the key."], e:"MASWE-0022 covers predictable IVs. When IVs are reused or predictable with modes like CBC or GCM, attackers can potentially recover plaintext or forge ciphertext."},
    {c:"MASVS-CRYPTO", q:"On iOS, which framework provides modern cryptographic operations with a Swift-native API?", a:"CryptoKit, offering high-level interfaces for hashing, signing, and encryption.", d:["UIKit, providing user interface components with built-in data encryption support.", "CoreData, handling persistent storage with automatic cryptographic transformation.", "HealthKit, securing medical records through integrated AES encryption functions."], e:"Apple's CryptoKit framework provides modern, Swift-native cryptographic operations including hashing (SHA-256/384/512), HMAC, AES-GCM encryption, and key agreement."},
    {c:"MASVS-CRYPTO", q:"What does MASWE-0011 identify as a cryptographic key management weakness?", a:"Cryptographic Key Rotation Not Implemented, leaving keys in use indefinitely.", d:["Cryptographic Key Generation using hardware-backed sources that are too slow.", "Certificate Pinning implemented with backup pins for disaster recovery needs.", "Random Number Generation from platform-provided secure entropy pool services."], e:"MASWE-0011 addresses the absence of key rotation policies, meaning compromised keys remain valid indefinitely, increasing the window of exposure for encrypted data."},
    {c:"MASVS-CRYPTO", q:"Which cryptographic standard does the MASVS reference for key management best practices?", a:"NIST SP 800-57 Part 1, covering recommendations for key management frameworks.", d:["ISO 27001 Annex A, defining information security management system requirements.", "PCI DSS Requirement 6, addressing secure development of payment card applications.", "OWASP ASVS Section V3, specifying session management controls for web platforms."], e:"The MASVS explicitly references NIST SP 800-57p1 and NIST SP 800-175B as the industry standards that define cryptographic best practices for key management."},
    {c:"MASVS-CRYPTO", q:"What makes the use of DES or 3DES problematic in modern mobile applications?", a:"Both use insufficient block sizes and key lengths that are vulnerable to attacks.", d:["Both algorithms are proprietary and require per-device licensing fees to deploy.", "They are only available on Android and have no equivalent implementation on iOS.", "They produce encrypted output that cannot be transmitted over standard HTTP/TLS."], e:"DES uses a 56-bit key (trivially brute-forced) and 64-bit blocks. 3DES, while stronger, is deprecated by NIST due to the small block size vulnerability (Sweet32 attack)."},
    {c:"MASVS-CRYPTO", q:"According to the MASTG, why should apps avoid implementing custom cryptographic algorithms?", a:"Custom implementations are likely to contain subtle flaws that weaken security.", d:["Custom algorithms always produce ciphertext that is larger than standard methods.", "Platform-provided cryptographic APIs are legally required in all app store regions.", "Custom cryptography is only prohibited for applications targeting Android devices."], e:"The MASTG strongly advises against custom cryptographic implementations. Well-vetted, standard algorithms (AES, RSA, ECDSA) have undergone extensive peer review."},

    // ========== MASVS-AUTH (15 questions) ==========
    {c:"MASVS-AUTH", q:"What does MASVS-AUTH-1 require regarding authentication and authorization protocols?", a:"The app must use secure protocols and follow relevant best practices consistently.", d:["The app only needs authentication when accessing financial transaction endpoints.", "The app should implement a custom authentication protocol for better performance.", "The app must rely solely on device-level biometrics for all access control checks."], e:"MASVS-AUTH-1 ensures apps connecting to remote endpoints use secure authentication and authorization protocols, with enforcement on the server side."},
    {c:"MASVS-AUTH", q:"According to MASVS-AUTH-2, how should local authentication be performed?", a:"Securely, following platform best practices for biometrics and local PIN handling.", d:["Using a simple hardcoded PIN that is embedded directly in the application code.", "By comparing user input against a hash value stored in SharedPreferences only.", "Through a custom dialog that captures biometric data without platform API usage."], e:"MASVS-AUTH-2 requires local authentication (biometrics, local PIN) to be implemented correctly using platform-provided APIs and following their security guidelines."},
    {c:"MASVS-AUTH", q:"What does MASVS-AUTH-3 address regarding authentication enforcement?", a:"The app must ensure authentication is enforced on the server side, not just locally.", d:["The app should perform all authentication checks exclusively on the client device.", "Server-side validation is only needed for apps that process payment transactions.", "Authentication can be skipped for returning users who have valid cached credentials."], e:"MASVS-AUTH-3 ensures that authentication and authorization decisions are enforced server-side, as client-side checks can be bypassed by attackers."},
    {c:"MASVS-AUTH", q:"What does MASWE-0044 describe regarding biometric authentication in mobile apps?", a:"Biometric Authentication Can Be Bypassed when using event-based validation only.", d:["Biometric sensors require annual hardware calibration to maintain their accuracy.", "Biometric data is always transmitted to remote servers for centralized verification.", "Biometric authentication is only available on devices manufactured after the year 2022."], e:"MASWE-0044 warns that biometric authentication using only evaluatePolicy (iOS) or event-based checks can be bypassed, as the result is just a boolean that can be manipulated."},
    {c:"MASVS-AUTH", q:"On iOS, what is the secure approach to implementing biometric authentication?", a:"Use Keychain with access control flags requiring biometric validation for key access.", d:["Call LAContext.evaluatePolicy and check the returned boolean value directly.", "Store a plaintext password in UserDefaults and gate access behind Face ID only.", "Implement a custom facial recognition algorithm using the device camera feed data."], e:"Crypto-based biometric auth ties keychain items to biometric validation (kSecAccessControlBiometryCurrentSet), making bypass impossible without the actual biometric."},
    {c:"MASVS-AUTH", q:"What risk does MASWE-0041 identify for mobile applications?", a:"Authentication Enforced Only Locally Instead of on the Server-side, allowing bypass.", d:["Authentication tokens refreshed too frequently causing unnecessary server load.", "Password complexity requirements that are stricter than most industry guidelines.", "Multi-factor authentication requiring more than three separate verification factors."], e:"MASWE-0041 addresses apps that only enforce authentication locally. Attackers can modify the app or intercept responses to bypass client-side auth checks entirely."},
    {c:"MASVS-AUTH", q:"Why does the MASTG recommend against using evaluatePolicy alone for biometric authentication on iOS?", a:"It returns a boolean that can be hooked and manipulated on jailbroken devices.", d:["It requires an active internet connection to validate biometric data remotely.", "It only supports fingerprint and does not work with facial recognition hardware.", "It stores biometric templates in an unencrypted database accessible to other apps."], e:"evaluatePolicy returns a simple true/false result. On jailbroken devices, an attacker can hook this method to always return true, completely bypassing biometric auth."},
    {c:"MASVS-AUTH", q:"What does MASWE-0005 identify as an authentication-related weakness?", a:"API Keys Hardcoded in the App Package, extractable through reverse engineering.", d:["Server-side rate limiting configured too aggressively for legitimate app users.", "OAuth refresh tokens with expiration times shorter than five minutes in length.", "Password reset flows that require answering three or more security challenge questions."], e:"MASWE-0005 covers API keys embedded in the app package. These can be extracted through decompilation, allowing unauthorized access to backend services."},
    {c:"MASVS-AUTH", q:"According to the MASVS, what should happen when a new biometric is enrolled on the device?", a:"Cryptographic keys tied to biometrics should be invalidated and re-authentication required.", d:["The app should automatically grant the new biometric full access to all stored data.", "No action is needed since the operating system handles biometric changes internally.", "The app should display an informational notice but continue using existing credentials."], e:"MASWE-0046 requires that crypto keys are invalidated on new biometric enrollment, ensuring a newly added fingerprint/face cannot access previously protected data."},
    {c:"MASVS-AUTH", q:"What does MASWE-0045 describe regarding biometric authentication fallback mechanisms?", a:"Fallback to Non-biometric Credentials Allowed for Sensitive Transactions, weakening security.", d:["Biometric sensors that degrade in accuracy after extended periods of continuous use.", "Operating system updates that reset all stored biometric templates on the device.", "Hardware tokens that must be physically connected to the device for authentication."], e:"MASWE-0045 warns that allowing fallback to device PIN/password for sensitive transactions reduces security, as these are typically weaker than biometric verification."},
    {c:"MASVS-AUTH", q:"What does the MASTG recommend for secure session management in mobile apps?", a:"Use short-lived tokens with server-side validation and proper session expiration logic.", d:["Store session tokens permanently on the device for seamless user experience flow.", "Embed session identifiers directly in URLs for easy debugging and troubleshooting.", "Use the device hardware identifier as the sole session token for all API requests."], e:"The MASTG recommends short-lived, server-validated session tokens with proper expiration, rotation, and revocation mechanisms to prevent session hijacking."},
    {c:"MASVS-AUTH", q:"What authentication weakness does MASWE-0040 describe for mobile applications?", a:"Insecure Authentication in WebViews, allowing credential theft or session hijacking.", d:["Excessive re-authentication prompts that degrade the overall user experience.", "Authentication flows that use platform-provided APIs instead of custom solutions.", "Server-side session storage using industry-standard encrypted database mechanisms."], e:"MASWE-0040 covers risks when authentication is performed within WebViews, where JavaScript bridges, URL interception, or cookie handling may expose credentials."},
    {c:"MASVS-AUTH", q:"Why does the MASVS recommend using platform-provided authentication APIs?", a:"Platform APIs are vetted for security, regularly updated, and follow best practices.", d:["Custom authentication code is faster to develop and easier to maintain over time.", "Platform APIs are required by app store policies and will cause rejection otherwise.", "Third-party authentication libraries always contain known exploitable vulnerabilities."], e:"MASWE-0032 recommends platform-provided APIs because they implement security best practices, receive regular patches, and handle edge cases that custom code may miss."},
    {c:"MASVS-AUTH", q:"What does MASWE-0033 address regarding authentication protocol security?", a:"Authentication or Authorization Protocol Security Best Practices Not Followed properly.", d:["Server response times that exceed acceptable thresholds for mobile applications.", "Certificate transparency logs that record all TLS certificates issued for a domain.", "Database connection pooling configurations that affect backend query performance."], e:"MASWE-0033 covers improper implementation of protocols like OAuth 2.0, OpenID Connect, or SAML, including missing PKCE, insecure token storage, or improper redirect validation."},
    {c:"MASVS-AUTH", q:"On Android, what does MASWE-0034 identify regarding Confirm Credentials implementation?", a:"Insecure Implementation of Confirm Credentials, allowing bypass of re-authentication.", d:["Excessive prompts for credential confirmation that frustrate legitimate app users.", "Automatic credential rotation that occurs too frequently for stable session handling.", "Server-side credential storage using industry-standard bcrypt hashing with salt values."], e:"MASWE-0034 covers insecure use of Android's Confirm Credentials flow, where implementation flaws can allow attackers to bypass the re-authentication requirement."},

    // ========== MASVS-NETWORK (15 questions) ==========
    {c:"MASVS-NETWORK", q:"What does MASVS-NETWORK-1 require for mobile app network communication?", a:"The app must use TLS for all network communication with remote endpoints securely.", d:["The app may use plaintext HTTP for non-sensitive public content delivery endpoints.", "The app should implement a custom transport protocol for better speed performance.", "Network encryption is only needed when transmitting user credentials to the server."], e:"MASVS-NETWORK-1 requires that the app secures all network communication using TLS, protecting data in transit from interception and tampering."},
    {c:"MASVS-NETWORK", q:"According to MASVS-NETWORK-2, what additional security measure should apps implement?", a:"Identity pinning to verify the remote endpoint's identity beyond standard TLS checks.", d:["Client-side caching of all server responses to reduce the number of network calls.", "Automatic fallback to HTTP when TLS handshakes fail due to network conditions.", "Compression of all request bodies using gzip to minimize data transmission volume."], e:"MASVS-NETWORK-2 requires identity pinning (certificate or public key pinning) to prevent man-in-the-middle attacks even when an attacker has a valid CA-signed certificate."},
    {c:"MASVS-NETWORK", q:"What does MASWE-0050 identify as a network security weakness in mobile apps?", a:"Cleartext Traffic, where data is transmitted without TLS encryption over the network.", d:["Certificate Pinning implemented with multiple backup pins for redundancy purposes.", "Server-side rate limiting applied to API endpoints to prevent denial of service.", "Response caching headers configured to reduce bandwidth consumption for mobile users."], e:"MASWE-0050 covers apps that transmit data over unencrypted HTTP connections, exposing sensitive information to network eavesdropping and man-in-the-middle attacks."},
    {c:"MASVS-NETWORK", q:"On Android, what mechanism allows developers to declare network security policies?", a:"The Network Security Configuration file, specifying trusted CAs and cleartext rules.", d:["The AndroidManifest.xml permission tag for INTERNET access and nothing further.", "The build.gradle file's network settings block with TLS version specifications.", "The ProGuard configuration file with network-related obfuscation rule definitions."], e:"Android's Network Security Configuration (network_security_config.xml) allows declarative network security policies including trusted CAs, certificate pins, and cleartext traffic rules."},
    {c:"MASVS-NETWORK", q:"On iOS, what feature enforces secure network connections by default?", a:"App Transport Security (ATS), requiring HTTPS for all network connections by default.", d:["The iOS Firewall daemon, blocking all inbound connections to the app's process.", "The Keychain Access Group, restricting network calls based on entitlement values.", "The Network Extension framework, intercepting all traffic for automatic encryption."], e:"App Transport Security (ATS) on iOS enforces HTTPS connections by default. Developers must explicitly declare exceptions in Info.plist to allow cleartext HTTP."},
    {c:"MASVS-NETWORK", q:"What type of certificate pinning does the MASTG recommend for the strongest security?", a:"Public key pinning, which survives certificate rotation without requiring app updates.", d:["Full certificate pinning using the complete DER-encoded leaf certificate only.", "Root CA pinning that trusts all certificates issued by a single certificate authority.", "Domain name pinning that validates only the hostname in the TLS server certificate."], e:"Public key pinning pins the Subject Public Key Info (SPKI) hash, surviving certificate renewals as long as the same key pair is used, reducing maintenance overhead."},
    {c:"MASVS-NETWORK", q:"What does MASWE-0052 describe as a mobile application network vulnerability?", a:"Insecure Certificate Validation, such as custom TrustManagers accepting all certs.", d:["Certificate Transparency log monitoring that alerts on newly issued certificates.", "OCSP stapling configured to provide real-time certificate revocation status checks.", "HTTP Strict Transport Security headers sent by the server to enforce TLS usage."], e:"MASWE-0052 covers apps that implement insecure certificate validation, like TrustManagers that accept all certificates or HostnameVerifiers that accept any hostname."},
    {c:"MASVS-NETWORK", q:"Why is accepting all SSL certificates in a custom TrustManager dangerous?", a:"It allows man-in-the-middle attacks using any certificate, including self-signed ones.", d:["It forces the app to use TLS 1.0 which has slower handshake performance overhead.", "It causes the app to reject valid certificates from well-known certificate authorities.", "It prevents the operating system from caching TLS sessions for connection reuse."], e:"A TrustManager that accepts all certificates removes TLS certificate validation entirely, allowing any attacker with network access to intercept encrypted traffic."},
    {c:"MASVS-NETWORK", q:"What does the Android Network Security Configuration's cleartextTrafficPermitted attribute control?", a:"Whether the app is allowed to send and receive unencrypted HTTP traffic to a domain.", d:["Whether the app can use the device's mobile data connection or only WiFi networks.", "The maximum TLS version that the application is permitted to negotiate with servers.", "Whether debugging tools can inspect the app's encrypted network traffic in transit."], e:"Setting cleartextTrafficPermitted to false prevents the app from using cleartext HTTP connections, forcing all traffic through encrypted TLS channels."},
    {c:"MASVS-NETWORK", q:"What does MASWE-0047 describe regarding network identity verification?", a:"Insecure Identity Pinning, where pinning is implemented incorrectly or incompletely.", d:["Excessive pinning that prevents the app from connecting to any legitimate servers.", "Automatic pin rotation that occurs without any user notification or consent.", "Server-side pinning configuration that blocks connections from unpinned mobile clients."], e:"MASWE-0047 covers insecure pinning implementations, such as pinning only in debug mode, using wrong pin values, or not implementing pin validation properly."},
    {c:"MASVS-NETWORK", q:"According to the MASTG, what is the risk of WebViews ignoring SSL errors on Android?", a:"Proceeding despite SSL errors allows attackers to intercept WebView traffic silently.", d:["SSL errors in WebViews only affect the rendering of images and not text content.", "Ignoring SSL errors improves WebView loading speed by skipping certificate checks.", "WebView SSL handling is independent of the app's security and managed by Chrome."], e:"Overriding onReceivedSslError to proceed despite errors disables TLS validation in the WebView, making it vulnerable to man-in-the-middle attacks."},
    {c:"MASVS-NETWORK", q:"What network security risk does MASWE-0051 address for mobile applications?", a:"Unprotected Open Ports that expose services to other apps or network-connected devices.", d:["Encrypted network traffic that uses deprecated but still functional cipher suite options.", "Server-side load balancers that distribute traffic unevenly across backend instances.", "DNS resolution delays that increase the time required to establish TLS connections."], e:"MASWE-0051 covers apps that open network ports (e.g., for local servers) without proper authentication, allowing other apps or devices to access exposed services."},
    {c:"MASVS-NETWORK", q:"Why does the MASTG recommend against allowing user-installed CA certificates for production apps?", a:"User CA certificates can be used to intercept TLS traffic via corporate proxy tools.", d:["User-installed certificates always have shorter validity periods than system certificates.", "The device performance degrades significantly when additional CA certificates are loaded.", "User certificates are stored in plaintext and can be read by any application on device."], e:"On Android 7+, apps only trust system CAs by default. Explicitly trusting user CAs (via network config) enables traffic interception through proxy tools."},
    {c:"MASVS-NETWORK", q:"What does the MASTG recommend for testing cleartext traffic in mobile applications?", a:"Intercept traffic with a proxy to detect any HTTP connections transmitting sensitive data.", d:["Only review the source code for URL strings containing the HTTP protocol prefix.", "Check the app store listing for declarations about the app's data encryption usage.", "Rely solely on the operating system's built-in traffic monitoring system log output."], e:"The MASTG recommends dynamic testing using proxy tools (like Burp Suite or mitmproxy) to capture and analyze actual network traffic for cleartext transmissions."},
    {c:"MASVS-NETWORK", q:"On Android, what is the role of the GMS Security Provider in network security?", a:"It provides up-to-date TLS implementations and security patches via Google Play Services.", d:["It generates unique device identifiers used for TLS client certificate authentication.", "It manages the device's WiFi connection settings and available network configurations.", "It stores cryptographic keys used by all installed applications for TLS handshakes."], e:"The GMS Security Provider (ProviderInstaller) ensures the device uses the latest TLS implementation and security fixes, even on older Android versions."},

    // ========== MASVS-PLATFORM (15 questions) ==========
    {c:"MASVS-PLATFORM", q:"What does MASVS-PLATFORM-1 require regarding platform interaction?", a:"The app must use IPC mechanisms securely and validate all data received from them.", d:["The app should expose all components for maximum interoperability with other apps.", "Platform interaction security is handled entirely by the OS with no app involvement.", "IPC mechanisms should only be used for communication within the same application."], e:"MASVS-PLATFORM-1 requires secure use of IPC mechanisms and proper validation of all data received from the platform or other apps to prevent injection and data leakage."},
    {c:"MASVS-PLATFORM", q:"What does MASVS-PLATFORM-2 address regarding WebView security?", a:"The app must use WebViews securely, preventing potential attack vectors they introduce.", d:["WebViews should always have JavaScript enabled for full web content compatibility.", "WebView security is only relevant for apps that display advertisements to users.", "All WebView content should be loaded from the device's local file system storage."], e:"MASVS-PLATFORM-2 covers WebView security including JavaScript execution, file access, content loading, and JavaScript bridge exposure that can lead to code execution attacks."},
    {c:"MASVS-PLATFORM", q:"What does MASVS-PLATFORM-3 require for secure platform interaction?", a:"The app must use the platform-provided mechanisms securely for sensitive UI operations.", d:["The app should create custom UI frameworks to replace all native platform components.", "Platform mechanisms are only relevant for apps that target a single operating system.", "Sensitive UI operations should bypass platform controls for faster rendering speeds."], e:"MASVS-PLATFORM-3 covers the secure use of platform mechanisms for operations like screenshots, notifications, clipboard, and other UI-related security concerns."},
    {c:"MASVS-PLATFORM", q:"What is the security risk described by MASWE-0068 regarding JavaScript bridges?", a:"JavaScript Bridges in WebViews can expose native app functionality to web content.", d:["JavaScript bridges only affect the visual rendering performance of WebView content.", "Bridges are automatically sandboxed by the platform and cannot access native code.", "This weakness only applies to hybrid apps built with frameworks like React Native."], e:"MASWE-0068 covers addJavascriptInterface (Android) and WKScriptMessageHandler (iOS) that can expose native functionality to potentially malicious web content in WebViews."},
    {c:"MASVS-PLATFORM", q:"What is the Tapjacking attack described by MASWE-0056?", a:"An overlay attack where a malicious app places invisible elements over legitimate UI.", d:["An attack that captures touchscreen input by exploiting Bluetooth vulnerabilities.", "A technique that bypasses biometric authentication by replaying recorded tap events.", "An exploit that modifies the device's touch calibration to redirect input to attackers."], e:"MASWE-0056 describes tapjacking/overlay attacks on Android where malicious apps draw over legitimate apps, tricking users into performing unintended actions."},
    {c:"MASVS-PLATFORM", q:"What Android security risk does MASWE-0066 describe regarding Intent handling?", a:"Insecure Intents that can leak data or allow unauthorized components to be triggered.", d:["Intents that are transmitted over encrypted channels using hardware-backed key pairs.", "Slow Intent resolution that causes application not responding dialogs on older devices.", "Intent filters that restrict component access to only the declaring application itself."], e:"MASWE-0066 covers insecure use of Android Intents, including implicit intents leaking sensitive data and exported components accepting malicious intent data."},
    {c:"MASVS-PLATFORM", q:"What does MASWE-0064 identify as a security weakness on Android?", a:"Insecure Content Providers that expose application data to other installed applications.", d:["Content Providers that use SQLite for storage instead of a more modern database engine.", "Encrypted Content Providers that require too many permissions to access their data.", "Content Providers that implement pagination for large result sets returned to callers."], e:"MASWE-0064 covers Content Providers that are exported without proper permissions or input validation, allowing other apps to read or modify the app's data."},
    {c:"MASVS-PLATFORM", q:"On iOS, what is the security risk of using custom URL schemes without validation?", a:"Other apps can invoke the URL scheme with malicious input to trigger unintended actions.", d:["Custom URL schemes are automatically encrypted by the iOS kernel at transport time.", "Only apps from the same developer can register and handle custom URL scheme requests.", "URL schemes are deprecated on iOS and no longer function on versions above iOS 14."], e:"MASWE-0058 covers insecure deep links. On iOS, custom URL schemes can be claimed by any app, and input must be validated to prevent injection or unauthorized actions."},
    {c:"MASVS-PLATFORM", q:"What does MASWE-0067 describe regarding the Android debuggable flag?", a:"Debuggable Flag Not Disabled, allowing debugging tools to attach to the production app.", d:["A flag that controls whether the app displays verbose log messages in the console.", "A build configuration that enables code shrinking and resource minification features.", "A permission declaration that allows the app to access USB debugging host connections."], e:"MASWE-0067 covers apps released with android:debuggable=true in the manifest, allowing attackers to attach debuggers and inspect runtime behavior."},
    {c:"MASVS-PLATFORM", q:"What does MASWE-0063 describe as a platform interaction security weakness?", a:"Insecure Broadcast Receivers that accept messages from any app without proper checks.", d:["Broadcast Receivers that handle system events like battery level or network changes.", "Encrypted Broadcast messages that require a shared secret key for decryption.", "Internal Broadcast Receivers that only process messages from the same application."], e:"MASWE-0063 covers exported Broadcast Receivers that process messages without verifying the sender, allowing malicious apps to trigger unintended behavior."},
    {c:"MASVS-PLATFORM", q:"According to MASWE-0069, what WebView setting creates a local file access risk?", a:"WebViews that Allow Access to Local Resources, enabling file system data exfiltration.", d:["WebViews configured to cache web pages for offline reading in a temporary directory.", "WebView settings that control the default font size and text scaling for readability.", "JavaScript disabled in WebViews to prevent cross-site scripting attacks in web content."], e:"MASWE-0069 covers setAllowFileAccess and similar settings that let WebView content access local files, potentially exposing sensitive data from the app sandbox."},
    {c:"MASVS-PLATFORM", q:"What is the StrandHogg vulnerability described by MASWE-0057?", a:"A Task Affinity attack where malicious apps hijack legitimate app tasks on Android.", d:["A WiFi-based exploit that intercepts Bluetooth pairing requests between mobile devices.", "A memory corruption technique that overwrites stack canaries in native ARM libraries.", "A cryptographic weakness in the Android KeyStore affecting key generation entropy."], e:"MASWE-0057 describes StrandHogg, where a malicious app uses task affinity settings to place phishing activities on top of legitimate apps in the recent apps stack."},
    {c:"MASVS-PLATFORM", q:"On iOS, what does MASWE-0060 identify as a platform security weakness?", a:"Insecure Use of UIActivity, potentially sharing sensitive data with unintended targets.", d:["UIActivity objects consuming too much memory when sharing large multimedia content.", "UIActivity instances that display sharing options in a non-standard visual layout.", "UIActivity failing to render properly when the device is in landscape orientation mode."], e:"MASWE-0060 covers insecure use of UIActivityViewController where sensitive data may be shared with unintended apps or services through the iOS share sheet."},
    {c:"MASVS-PLATFORM", q:"What does the MASTG recommend regarding WebView debugging in production builds?", a:"Web content debugging must be disabled in production to prevent runtime inspection.", d:["Debugging should remain enabled to allow customer support to diagnose user issues.", "WebView debugging settings have no security implications in any release configuration.", "Only WebViews loading local HTML files need debugging disabled in production builds."], e:"MASWE-0074 covers Web Content Debugging Enabled. setWebContentsDebuggingEnabled(true) allows Chrome DevTools to inspect WebView content, exposing sensitive data."},
    {c:"MASVS-PLATFORM", q:"What does MASWE-0065 describe about data sharing between applications?", a:"Sensitive Data Permanently Shared with Other Apps through persistent IPC mechanisms.", d:["Encrypted data transfer between apps using platform-provided secure channels only.", "Temporary file sharing that automatically expires after a configurable time period.", "Data isolation enforced by the operating system's mandatory access control policies."], e:"MASWE-0065 covers scenarios where sensitive data is shared with other apps through persistent mechanisms like shared files or Content Providers without proper access control."},

    // ========== MASVS-CODE (15 questions) ==========
    {c:"MASVS-CODE", q:"What does MASVS-CODE-1 require for mobile application input handling?", a:"The app must validate and sanitize all input from untrusted sources properly.", d:["Input validation is only required for data entered through the main login screen.", "The app should accept all input without modification to preserve data fidelity.", "Only numeric input fields require validation checks in mobile app implementations."], e:"MASVS-CODE-1 requires that apps validate and sanitize all data from untrusted sources including network responses, IPC, user input, and local storage."},
    {c:"MASVS-CODE", q:"What does MASVS-CODE-2 address regarding third-party dependencies?", a:"The app must verify that third-party components have no known security vulnerabilities.", d:["Third-party libraries should be avoided entirely in favour of custom implementations.", "Only libraries with more than one million downloads need vulnerability assessment.", "Dependency scanning is only relevant for apps that target enterprise user audiences."], e:"MASVS-CODE-2 requires keeping track of third-party dependencies and ensuring they don't contain known vulnerabilities, using tools like OWASP Dependency-Check."},
    {c:"MASVS-CODE", q:"What does MASVS-CODE-3 require regarding compiler security features?", a:"The app must enable platform-provided security features like stack protection and PIE.", d:["Compiler warnings should be suppressed to produce cleaner build output for review.", "Security features should be disabled to maximize application runtime performance.", "Only applications written in native C/C++ code need compiler security protections."], e:"MASVS-CODE-3 ensures apps use compiler-provided security features like stack canaries, Position Independent Executables (PIE), and Automatic Reference Counting (ARC)."},
    {c:"MASVS-CODE", q:"According to MASVS-CODE-4, what must the app do regarding platform updates?", a:"The app must target a recent platform version and ensure it runs on updated systems.", d:["The app should target the oldest available SDK version for maximum device coverage.", "Platform targeting is only relevant for apps distributed through official app stores.", "The app should only update its target SDK when a critical vulnerability is disclosed."], e:"MASVS-CODE-4 requires targeting recent platform versions and optionally enforcing minimum OS versions to benefit from the latest security patches and features."},
    {c:"MASVS-CODE", q:"What does MASWE-0076 identify as a code quality weakness in mobile apps?", a:"Dependencies with Known Vulnerabilities that introduce exploitable flaws in the app.", d:["Dependencies that are compiled from source code rather than imported as prebuilt binaries.", "Libraries that provide more functionality than the application actually requires.", "Dependencies licensed under permissive open-source terms rather than copyleft licenses."], e:"MASWE-0076 covers third-party dependencies containing known vulnerabilities (CVEs) that attackers can exploit to compromise the application."},
    {c:"MASVS-CODE", q:"What does MASWE-0086 describe as a code-level vulnerability in mobile apps?", a:"SQL Injection, where untrusted input is used in database queries without sanitization.", d:["SQL performance degradation caused by excessive indexing on frequently queried tables.", "Database connection pooling that fails to release connections after transaction commits.", "Unoptimised SQL queries that cause the application to exceed its memory allocation."], e:"MASWE-0086 covers SQL injection in mobile apps, particularly in local SQLite databases where user input is concatenated directly into queries without parameterization."},
    {c:"MASVS-CODE", q:"What does MASWE-0088 describe regarding mobile application data handling?", a:"Insecure Object Deserialization that could lead to remote code execution or data leaks.", d:["Object serialization using industry-standard formats like JSON and protocol buffers.", "Encrypted object storage using platform-provided secure serialization mechanisms.", "Object caching strategies that improve application launch time and responsiveness."], e:"MASWE-0088 covers insecure deserialization of untrusted data, which can lead to arbitrary code execution, privilege escalation, or denial of service attacks."},
    {c:"MASVS-CODE", q:"According to MASWE-0085, what is the risk of unsafe dynamic code loading?", a:"Dynamically loaded code from untrusted sources could execute arbitrary malicious payloads.", d:["Dynamic code loading only adds a small performance overhead during initial app startup.", "Code loaded at runtime is automatically sandboxed by the operating system's linker.", "This technique is only used by game engines and has no relevance for standard apps."], e:"MASWE-0085 covers risks when apps load code dynamically (DEX files, shared libraries) from untrusted sources without integrity verification."},
    {c:"MASVS-CODE", q:"What compiler feature does MASWE-0116 recommend enabling for native code security?", a:"Compiler-Provided Security Features like stack canaries, PIE, and RELRO protections.", d:["Compiler optimizations that reduce binary size through dead code elimination passes.", "Debug symbol generation that enables crash reports with full stack trace information.", "Link-time code generation for improved cross-module inlining and optimization results."], e:"MASWE-0116 covers missing compiler security features like stack canaries (-fstack-protector), PIE, and RELRO that protect against memory corruption exploits."},
    {c:"MASVS-CODE", q:"What does MASWE-0075 recommend regarding mobile application updates?", a:"Enforced Updating ensures users run the latest version with current security patches.", d:["Automatic updates should be disabled to give users full control over app versions.", "Updates are only necessary when new user-facing features are added to the application.", "The app should allow users to remain on any previous version without restrictions."], e:"MASWE-0075 covers the absence of enforced updating mechanisms, leaving users on outdated vulnerable versions of the app."},
    {c:"MASVS-CODE", q:"Why does the MASTG recommend Position Independent Executables (PIE) for mobile apps?", a:"PIE enables ASLR, randomizing memory layout to make exploitation significantly harder.", d:["PIE reduces the compiled binary size by eliminating absolute address references.", "PIE allows the application to run on multiple CPU architectures without recompilation.", "PIE improves app startup speed by enabling parallel loading of shared library modules."], e:"Position Independent Executables work with Address Space Layout Randomization (ASLR) to randomize memory addresses, making buffer overflow exploitation much more difficult."},
    {c:"MASVS-CODE", q:"What does MASWE-0079 describe regarding mobile application data processing?", a:"Unsafe Handling of Data from the Network that could trigger memory corruption flaws.", d:["Network data that arrives in an unexpected character encoding format like UTF-32.", "Slow network responses that cause timeout errors in the application's HTTP client.", "Compressed network payloads that require more memory to decompress than available."], e:"MASWE-0079 covers insufficient validation of data received from the network, which can lead to buffer overflows, format string vulnerabilities, or other memory corruption issues."},
    {c:"MASVS-CODE", q:"On iOS, what does Automatic Reference Counting (ARC) protect against?", a:"Memory management errors like use-after-free and double-free vulnerabilities in code.", d:["Cross-site scripting attacks in WKWebView instances loading untrusted web content.", "Insecure network connections that fail to validate the server's TLS certificate.", "Unauthorized access to keychain items by applications with different bundle identifiers."], e:"ARC automatically manages object lifecycles in Objective-C/Swift, preventing memory management bugs that could lead to exploitable use-after-free or double-free conditions."},
    {c:"MASVS-CODE", q:"What does MASWE-0077 warn about regarding platform version targeting?", a:"Running on a Recent Platform Version Not Ensured, missing important security patches.", d:["Apps targeting the latest SDK version that break backward compatibility with old devices.", "Platform version checks that display warnings to users about upcoming feature changes.", "SDK version requirements that prevent app installation on newly released device models."], e:"MASWE-0077 warns that apps not ensuring they run on recent platform versions miss security patches and protections that the OS provides."},
    {c:"MASVS-CODE", q:"What does stack canary protection defend against in native mobile code?", a:"Stack buffer overflow attacks by detecting when return addresses have been overwritten.", d:["Network-based denial of service attacks that exhaust available socket connections.", "Unauthorized file system access by verifying path names before opening file handles.", "Weak cryptographic random number generation by seeding from hardware entropy sources."], e:"Stack canaries place guard values before the return address on the stack. If a buffer overflow overwrites the canary, the process detects it and terminates before exploitation."},

    // ========== MASVS-RESILIENCE (15 questions) ==========
    {c:"MASVS-RESILIENCE", q:"What does MASVS-RESILIENCE-1 require for mobile platform integrity?", a:"The app must validate the integrity of the platform it runs on at launch and runtime.", d:["The app should trust the platform entirely without performing any validation checks.", "Platform integrity is only relevant for apps that process government-classified data.", "Integrity validation should be performed once during installation and never again."], e:"MASVS-RESILIENCE-1 requires apps to validate platform integrity (root/jailbreak detection, emulator detection, device attestation) since many controls depend on OS security."},
    {c:"MASVS-RESILIENCE", q:"What does MASVS-RESILIENCE-2 address for mobile app protection?", a:"The app must implement anti-tampering mechanisms to detect code and resource changes.", d:["The app should allow modifications to support accessibility and customization needs.", "Tampering detection is only necessary for apps distributed outside of official stores.", "Code integrity checks should be limited to verifying the app's digital signature only."], e:"MASVS-RESILIENCE-2 covers anti-tampering measures including code integrity checks, resource integrity verification, and official store verification."},
    {c:"MASVS-RESILIENCE", q:"What does MASVS-RESILIENCE-3 require regarding reverse engineering protection?", a:"The app must implement measures to impede static analysis and code comprehension.", d:["Source code should be published openly to allow community security review and audit.", "Code obfuscation is unnecessary if the app uses strong authentication mechanisms.", "Only apps containing proprietary algorithms need protection against reverse engineering."], e:"MASVS-RESILIENCE-3 requires code obfuscation, resource obfuscation, and anti-deobfuscation techniques to make static analysis and reverse engineering more difficult."},
    {c:"MASVS-RESILIENCE", q:"What does MASVS-RESILIENCE-4 address regarding dynamic analysis threats?", a:"The app must implement anti-dynamic analysis techniques to prevent runtime inspection.", d:["Dynamic analysis prevention is only needed for apps that handle payment card data.", "The app should cooperate with debugging tools to facilitate security research efforts.", "Runtime inspection can be prevented solely by implementing TLS certificate pinning."], e:"MASVS-RESILIENCE-4 covers anti-debugging, dynamic analysis tool detection, RASP techniques, and runtime code integrity verification to prevent runtime attacks."},
    {c:"MASVS-RESILIENCE", q:"What does MASWE-0097 describe as a mobile application resilience weakness?", a:"Root/Jailbreak Detection Not Implemented, leaving the app unaware of OS compromise.", d:["Root detection that is too aggressive, blocking legitimate users on secure devices.", "Jailbreak detection APIs that consume excessive battery by running continuous checks.", "Platform integrity checks that only run during the initial application launch event."], e:"MASWE-0097 covers the absence of root/jailbreak detection. On compromised devices, OS security features that apps rely on may be disabled."},
    {c:"MASVS-RESILIENCE", q:"Why is emulator detection important for mobile application security?", a:"Emulators provide full system access, making it trivial to inspect and modify the app.", d:["Emulators always run outdated operating system versions with unpatched vulnerabilities.", "Detection is needed because emulators cannot establish encrypted network connections.", "Emulators lack touchscreen input, so biometric authentication cannot be tested properly."], e:"MASWE-0099 covers emulator detection. Attackers use emulators for dynamic analysis because they provide root access, memory inspection, and easy instrumentation."},
    {c:"MASVS-RESILIENCE", q:"What does MASWE-0089 recommend regarding static analysis protection?", a:"Code Obfuscation should be implemented to make reverse engineering more costly.", d:["Source code should be compiled with maximum optimizations and no debug information.", "Static analysis tools should be allowed to process the app for third-party auditing.", "Code readability should be prioritized over obfuscation for maintainability purposes."], e:"MASWE-0089 covers the absence of code obfuscation (identifier renaming, control flow flattening, string encryption) that increases the effort needed for reverse engineering."},
    {c:"MASVS-RESILIENCE", q:"What does MASWE-0101 identify as a weakness against dynamic analysis?", a:"Debugger Detection Not Implemented, allowing attackers to step through code at runtime.", d:["Debugger usage that only occurs in development environments and never in production.", "Platform-provided debugging APIs that are automatically disabled in release builds.", "Operating system-level protections that prevent all debugging of installed applications."], e:"MASWE-0101 covers the absence of anti-debugging measures. Without debugger detection, attackers can attach debuggers to inspect variables, bypass checks, and modify flow."},
    {c:"MASVS-RESILIENCE", q:"What is RASP in the context of MASWE-0103 and mobile application security?", a:"Runtime Application Self-Protection, where the app defends itself during execution.", d:["Remote Application Security Protocol, a network standard for encrypted API calls.", "Redundant Application Storage Pool, a backup mechanism for application state data.", "Rapid Application Security Patching, an over-the-air update delivery framework."], e:"MASWE-0103 covers RASP techniques where the app actively monitors and defends against attacks at runtime, including tampering detection, hook detection, and integrity checks."},
    {c:"MASVS-RESILIENCE", q:"What does MASWE-0104 describe regarding mobile application integrity?", a:"App Integrity Not Verified, meaning the app cannot detect if its code has been modified.", d:["App integrity checks that only verify the size of the compiled application binary.", "Integrity verification that runs exclusively during the app store download process.", "Code signing validation performed solely by the operating system's package installer."], e:"MASWE-0104 covers the absence of runtime app integrity verification. Without it, attackers can modify the app's code and redistribute tampered versions."},
    {c:"MASVS-RESILIENCE", q:"According to MASWE-0008, why should apps verify device secure lock configuration?", a:"Without a secure lock, device-level protections like KeyStore access controls are weakened.", d:["Secure lock verification is needed solely to comply with app store listing guidelines.", "Device locks only affect the user experience and have no bearing on data security.", "Checking for a secure lock is only relevant for apps that use NFC-based authentication."], e:"MASWE-0008 covers missing device secure lock verification. Many security features (KeyStore, biometrics, data protection) depend on the device having a secure lock set."},
    {c:"MASVS-RESILIENCE", q:"What does MASWE-0093 identify as a weakness in production mobile applications?", a:"Debugging Symbols Not Removed, providing attackers with meaningful function and variable names.", d:["Debugging symbols that are automatically stripped by all modern build toolchains.", "Symbol files that are only generated when the app is compiled in debug build mode.", "Debug information that is encrypted within the binary and inaccessible to analysis tools."], e:"MASWE-0093 covers debugging symbols left in production binaries, which provide attackers with function names, variable names, and structural information."},
    {c:"MASVS-RESILIENCE", q:"What does Google Play Integrity API provide for Android application security?", a:"Device and app attestation signals to verify the app runs in a genuine environment.", d:["Automatic code obfuscation applied during the app upload process to Google Play.", "A firewall service that blocks all network connections from rooted Android devices.", "Encrypted cloud storage for application secrets managed through the Play Console."], e:"The Google Play Integrity API provides attestation verdicts about the device integrity, app integrity, and account licensing to help verify the app runs in a trusted environment."},
    {c:"MASVS-RESILIENCE", q:"What does MASWE-0102 recommend for protecting against dynamic analysis tools?", a:"Detection of tools like Frida, Xposed, and Cydia Substrate that instrument the app.", d:["Allowing all instrumentation frameworks to attach for compatibility testing coverage.", "Only detecting tools that modify network traffic rather than application runtime code.", "Blocking all third-party applications from running simultaneously on the same device."], e:"MASWE-0102 covers detecting common dynamic analysis tools (Frida, Xposed, Cydia Substrate, objection) that attackers use to hook and modify app behavior at runtime."},
    {c:"MASVS-RESILIENCE", q:"What does MASWE-0106 describe regarding app distribution integrity?", a:"Official Store Verification Not Implemented, failing to detect sideloaded app copies.", d:["App store optimization techniques that improve the app's search ranking position.", "In-app purchase verification that validates receipts against the store's payment API.", "Store listing screenshots that accurately represent the app's current user interface."], e:"MASWE-0106 covers apps that don't verify they were installed from an official store, allowing tampered copies to be sideloaded and run without detection."},

    // ========== MASVS-PRIVACY (15 questions) ==========
    {c:"MASVS-PRIVACY", q:"What does MASVS-PRIVACY-1 require regarding sensitive data in network traffic?", a:"The app must minimize sensitive data exposure in network traffic to protect privacy.", d:["All network traffic should include the user's full profile for personalization needs.", "Privacy controls for network data are only needed when connecting to third-party APIs.", "Network traffic privacy is handled entirely by TLS and requires no app-level measures."], e:"MASVS-PRIVACY-1 addresses sensitive data in network traffic (MASWE-0108), requiring apps to minimize the personal data transmitted over the network."},
    {c:"MASVS-PRIVACY", q:"What does MASVS-PRIVACY-2 address regarding user data handling?", a:"The app must implement proper data anonymization and pseudonymization for user privacy.", d:["User data should always be stored with full personally identifiable information intact.", "Anonymization is only required for health data regulated under medical privacy laws.", "Data pseudonymization should be applied exclusively to analytics and crash reporting."], e:"MASVS-PRIVACY-2 covers anonymization and pseudonymization measures (MASWE-0109) and the use of unique identifiers for tracking (MASWE-0110)."},
    {c:"MASVS-PRIVACY", q:"According to MASVS-PRIVACY-3, what must the app provide regarding data collection?", a:"Adequate privacy policies and data collection declarations that inform the user clearly.", d:["A terms of service document that covers legal liability but not privacy specifically.", "Data collection notices are only needed for apps distributed in the European Union.", "Privacy information should be available only upon explicit written request by the user."], e:"MASVS-PRIVACY-3 requires adequate privacy policies (MASWE-0111) and data collection declarations (MASWE-0112) that clearly inform users about data practices."},
    {c:"MASVS-PRIVACY", q:"What does MASVS-PRIVACY-4 require for user data management?", a:"The app must provide users with controls to manage, delete, and export their own data.", d:["Data management controls are only required for apps that collect payment information.", "Users should contact customer support to request any changes to their personal data.", "Data deletion should be delayed by ninety days to allow recovery of accidental requests."], e:"MASVS-PRIVACY-4 covers data management controls (MASWE-0113), data visibility (MASWE-0114), consent mechanisms (MASWE-0115), and permission management (MASWE-0117)."},
    {c:"MASVS-PRIVACY", q:"What does MASWE-0110 identify as a privacy concern in mobile applications?", a:"Use of Unique Identifiers for User Tracking across sessions and applications on device.", d:["Generation of random session identifiers that change with each application restart.", "Use of anonymized aggregate analytics that cannot be linked to individual user profiles.", "Collection of device model information for compatibility testing and bug reproduction."], e:"MASWE-0110 covers the use of persistent unique identifiers (IMEI, ANDROID_ID, IDFA) that enable tracking users across sessions, apps, or even device resets."},
    {c:"MASVS-PRIVACY", q:"What does MASWE-0115 describe regarding user consent in mobile apps?", a:"Inadequate or Ambiguous User Consent Mechanisms that fail to obtain informed agreement.", d:["Consent dialogs that appear too frequently and disrupt the normal user experience.", "Permission requests that follow the operating system's standard presentation format.", "Pre-checked consent boxes that are clearly labelled and easy to understand for users."], e:"MASWE-0115 covers consent mechanisms that are unclear, bundled, pre-selected, or otherwise fail to give users genuine informed choice about data collection."},
    {c:"MASVS-PRIVACY", q:"What does MASWE-0113 describe regarding user control over personal data?", a:"Lack of Proper Data Management Controls preventing users from managing their own data.", d:["Data management features that are restricted to premium subscription tier users only.", "Controls that allow users to increase the amount of data collected about their usage.", "Management interfaces that export all user data in proprietary encrypted file formats."], e:"MASWE-0113 covers the absence of mechanisms for users to view, modify, delete, or export their personal data, which is also required by regulations like GDPR."},
    {c:"MASVS-PRIVACY", q:"According to MASWE-0117, what privacy weakness relates to mobile app permissions?", a:"Inadequate Permission Management, requesting more permissions than functionally necessary.", d:["Permission prompts that use the standard operating system dialog presentation style.", "Applications that request zero permissions and operate fully offline without data.", "Permission requests that are accompanied by clear rationale explaining their purpose."], e:"MASWE-0117 covers apps that request excessive permissions or don't properly manage permission lifecycles, collecting more data than needed for their functionality."},
    {c:"MASVS-PRIVACY", q:"What does MASWE-0108 describe regarding sensitive data and network communication?", a:"Sensitive Data in Network Traffic that exposes personal information beyond what is needed.", d:["Network traffic encrypted with TLS 1.3 using forward secrecy cipher suite options.", "API responses that contain only the minimum data fields requested by the mobile client.", "Certificate pinning implementation that validates the server's public key hash value."], e:"MASWE-0108 covers the inclusion of unnecessary sensitive data in network requests or responses, even when encrypted, as it increases exposure risk."},
    {c:"MASVS-PRIVACY", q:"What does MASWE-0112 require for mobile application privacy compliance?", a:"Adequate Data Collection Declarations that accurately describe what data the app collects.", d:["Declarations that list only the data types required by app store submission guidelines.", "A generic privacy notice that covers all possible data collection without specifics.", "Data collection descriptions published only in the developer's corporate privacy policy."], e:"MASWE-0112 requires accurate, complete data collection declarations in both app store listings and in-app disclosures that match actual data collection practices."},
    {c:"MASVS-PRIVACY", q:"Why does the MASTG recommend testing for undeclared PII in network traffic?", a:"Apps may transmit personal data that is not disclosed in their privacy documentation.", d:["Network traffic testing is only necessary for apps that have been flagged by regulators.", "PII in network traffic is automatically detected and blocked by the operating system.", "Testing for PII only applies to applications that explicitly collect user form input data."], e:"The MASTG recommends capturing and analyzing network traffic to identify personal data being sent that isn't declared in the app's privacy policy or store listing."},
    {c:"MASVS-PRIVACY", q:"What does MASWE-0109 recommend for protecting user privacy in data processing?", a:"Anonymization or Pseudonymisation Measures to prevent identifying individuals from data.", d:["Storing all user data with full personal identifiers for improved customer service.", "Applying data anonymization only to records that are older than twelve calendar months.", "Using reversible anonymization techniques that allow easy re-identification when needed."], e:"MASWE-0109 recommends proper anonymization or pseudonymization techniques so that processed data cannot be used to identify individual users."},
    {c:"MASVS-PRIVACY", q:"What does MASWE-0111 identify as a privacy documentation weakness?", a:"Inadequate Privacy Policy that fails to properly inform users about data handling practices.", d:["A privacy policy that is written in plain language accessible to non-technical readers.", "Documentation that is updated automatically whenever the app's data practices change.", "Privacy information that is available in multiple languages for international audiences."], e:"MASWE-0111 covers privacy policies that are missing, incomplete, vague, or don't accurately reflect the app's actual data collection and processing practices."},
    {c:"MASVS-PRIVACY", q:"What does MASWE-0114 describe regarding user data visibility?", a:"Inadequate Data Visibility Controls that prevent users from seeing what data is collected.", d:["Data dashboards that display real-time analytics about the user's app usage patterns.", "Visibility settings that allow users to make their profile public or private to others.", "Export features that generate machine-readable data files in standard JSON file format."], e:"MASWE-0114 covers the absence of transparency features that let users see what personal data the app has collected, stored, and shared about them."},
    {c:"MASVS-PRIVACY", q:"According to the MASVS, how should apps handle third-party SDK data collection?", a:"Apps must disclose and obtain consent for data collected by embedded third-party services.", d:["Third-party SDKs manage their own privacy compliance independently from the host app.", "Data collection by advertising SDKs is exempt from the host app's privacy obligations.", "Apps should only disclose first-party data collection, not third-party SDK behaviours."], e:"The MASVS requires apps to be transparent about all data collection, including by embedded third-party SDKs, and to obtain appropriate user consent."},

    // ========== GENERAL MAS PROJECT (20 questions) ==========
    {c:"MAS Project", q:"What are the three main deliverables of the OWASP Mobile Application Security project?", a:"MASVS (standard), MASTG (testing guide), and MASWE (weakness enumeration).", d:["MSTG (testing guide), ASVS (verification standard), and Top 10 (risk list).", "SAMM (maturity model), WSTG (web testing guide), and ZAP (scanning tool).", "BSIMM (framework), DAST (dynamic testing), and SAST (static testing tool)."], e:"The OWASP MAS project delivers three key resources: the MASVS verification standard, the MASTG testing guide, and the MASWE weakness enumeration."},
    {c:"MAS Project", q:"How many control groups does the OWASP MASVS v2.x define?", a:"Eight groups: Storage, Crypto, Auth, Network, Platform, Code, Resilience, Privacy.", d:["Three groups: Standard Security, Defense-in-Depth, and Reverse Engineering.", "Five groups: Storage, Authentication, Network, Code Quality, and Tampering.", "Ten groups: one for each of the OWASP Mobile Top 10 risk categories listed."], e:"MASVS v2.x defines 8 control groups: MASVS-STORAGE, MASVS-CRYPTO, MASVS-AUTH, MASVS-NETWORK, MASVS-PLATFORM, MASVS-CODE, MASVS-RESILIENCE, and MASVS-PRIVACY."},
    {c:"MAS Project", q:"What major change occurred in MASVS v2.0.0 regarding verification levels?", a:"Verification levels L1, L2, and R were removed and reworked as testing profiles.", d:["A new L3 level was added for government and military mobile application security.", "The R level was expanded to include ten additional resilience-focused requirements.", "Verification levels remained the same but were renumbered from one through five."], e:"In MASVS v2.0.0, the three verification levels (L1, L2, R) were removed. Testing profiles moved to the MASTG aligned with NIST OSCAL format."},
    {c:"MAS Project", q:"What is the role of the OWASP MASWE in the Mobile Application Security project?", a:"It enumerates specific mobile security weaknesses bridging the MASVS and MASTG.", d:["It provides automated scanning tools for detecting mobile app vulnerabilities.", "It defines compliance requirements for mobile apps in regulated industry sectors.", "It offers a certification programme for mobile application security professionals."], e:"The MASWE (Mobile Application Security Weakness Enumeration) lists specific weaknesses that bridge the high-level MASVS controls and the detailed MASTG test cases."},
    {c:"MAS Project", q:"What was the OWASP MASTG previously known as before its renaming?", a:"The OWASP MSTG, or Mobile Security Testing Guide, before the project restructured.", d:["The OWASP MAPT, or Mobile Application Penetration Testing reference document.", "The OWASP MASS, or Mobile Application Security Standard testing framework.", "The OWASP MTF, or Mobile Testing Framework for automated security analysis."], e:"The MASTG was previously known as the MSTG (Mobile Security Testing Guide) before being renamed during the MAS project restructuring."},
    {c:"MAS Project", q:"What does the MAS Checklist provide for mobile security testers?", a:"A unified sheet linking MASVS controls to corresponding MASTG test cases directly.", d:["An automated vulnerability scanner that tests mobile apps against MASVS controls.", "A certification examination covering all eight MASVS control group requirements.", "A project management template for scheduling and tracking mobile penetration tests."], e:"The MAS Checklist unifies all MASVS categories into a single sheet with links to MASTG test cases, enabling traceable and consistent security assessments."},
    {c:"MAS Project", q:"Which NIST standard format are the MASVS testing profiles aligned with?", a:"OSCAL (Open Security Controls Assessment Language) for interoperable security data.", d:["STIX (Structured Threat Information Expression) for sharing cyber threat intelligence.", "CVSS (Common Vulnerability Scoring System) for rating vulnerability severity levels.", "SCAP (Security Content Automation Protocol) for automated compliance checking tools."], e:"The MASVS testing profiles are aligned with the NIST OSCAL format, enabling interoperable sharing of security control data between platforms and organizations."},
    {c:"MAS Project", q:"According to the MASVS, which NIST publications define cryptographic best practices?", a:"NIST SP 800-175B and NIST SP 800-57 Part 1 for cryptography and key management.", d:["NIST SP 800-53 and NIST SP 800-171 for federal information system security controls.", "NIST SP 800-61 and NIST SP 800-86 for incident response and forensic investigation.", "NIST SP 800-115 and NIST SP 800-137 for penetration testing and continuous monitoring."], e:"The MASVS explicitly references NIST SP 800-175B (cryptographic standards) and NIST SP 800-57p1 (key management) as the industry best practice standards."},
    {c:"MAS Project", q:"What is the OWASP MAS project's classification within the OWASP Foundation?", a:"It is classified as an OWASP Flagship Project, the highest maturity designation.", d:["It is an OWASP Incubator Project, still under development and initial review.", "It is an OWASP Lab Project, having passed initial review but not yet mature.", "It is an OWASP Community Project, maintained by volunteers without formal review."], e:"The OWASP MAS project holds Flagship status, indicating it has achieved the highest level of maturity, quality, and community adoption within OWASP."},
    {c:"MAS Project", q:"Which mobile platforms does the OWASP MASTG provide specific testing guidance for?", a:"Android and iOS, with dedicated chapters for each platform's security architecture.", d:["Only Android, as iOS testing requires proprietary tools not available to the public.", "Android, iOS, and Windows Phone with equal coverage across all three platforms.", "Only iOS, as Android's open nature makes dedicated testing guidance unnecessary."], e:"The MASTG provides detailed platform-specific testing guidance for both Android and iOS, covering their unique architectures, APIs, and security mechanisms."},
    {c:"MAS Project", q:"What does the MASVS recommend regarding the OWASP ASVS for mobile application auth?", a:"MASVS-AUTH references the ASVS for server-side authentication and authorization checks.", d:["The ASVS should replace all MASVS controls when testing mobile app server endpoints.", "ASVS and MASVS are competing standards and should not be used in the same project.", "The ASVS is only applicable to web applications and has no relevance for mobile apps."], e:"MASVS-AUTH cleanly separates client-side and server-side authentication, referencing the OWASP ASVS for the server-side aspects of mobile app authentication."},
    {c:"MAS Project", q:"Which dynamic instrumentation tool is most commonly referenced in the MASTG for testing?", a:"Frida, an open-source toolkit for runtime code injection and API tracing on mobile.", d:["Wireshark, a network packet capture tool for analysing wireless traffic patterns.", "Burp Suite, a web application proxy used exclusively for intercepting HTTP requests.", "Nmap, a network scanner for discovering open ports and services on remote hosts."], e:"Frida is extensively referenced throughout the MASTG for dynamic analysis tasks including method hooking, API tracing, and runtime manipulation on both Android and iOS."},
    {c:"MAS Project", q:"What static analysis tool does the MASTG reference for Android code pattern detection?", a:"semgrep, a lightweight static analysis tool for finding security-relevant code patterns.", d:["SonarQube, an enterprise code quality platform focused on technical debt tracking.", "ESLint, a JavaScript linting tool for identifying problematic patterns in web code.", "Checkstyle, a Java development tool for enforcing consistent coding style rules."], e:"The MASTG references semgrep for static analysis of Android code, using custom rules to detect insecure API usage, misconfigurations, and vulnerable patterns."},
    {c:"MAS Project", q:"For iOS binary analysis, which tool does the MASTG primarily reference?", a:"r2 (radare2), an open-source reverse engineering framework for binary analysis.", d:["IDA Pro, a commercial disassembler that requires an enterprise license subscription.", "Hopper, a macOS-only disassembler primarily used for desktop application analysis.", "Binary Ninja, a reverse engineering platform focused on automated binary patching."], e:"The MASTG references r2 (radare2) extensively for iOS binary analysis tasks including disassembly, string searching, and identifying security-relevant code patterns."},
    {c:"MAS Project", q:"What category was added in MASVS v2.x that was not present in earlier versions?", a:"MASVS-PRIVACY, addressing user privacy controls and data protection requirements.", d:["MASVS-NETWORK, covering secure communication between the app and remote endpoints.", "MASVS-CRYPTO, defining cryptographic standards for protecting sensitive information.", "MASVS-STORAGE, requiring secure storage of sensitive data on the mobile device."], e:"MASVS-PRIVACY was introduced in MASVS v2.x, reflecting growing emphasis on user privacy, data minimization, and consent mechanisms in mobile applications."},
    {c:"MAS Project", q:"What category from MASVS v1.x was removed in the v2.0.0 restructuring?", a:"MASVS-ARCH (Architecture), as it overlapped with NIST SP 800-218 and OWASP SAMM.", d:["MASVS-CRYPTO was removed because cryptographic requirements moved to MASVS-CODE.", "MASVS-NETWORK was removed since TLS is now enforced at the operating system level.", "MASVS-STORAGE was removed and merged entirely into the MASVS-PLATFORM category."], e:"MASVS-ARCH was removed in v2.0.0 because its architectural and design requirements were already well covered by NIST SP 800-218 and OWASP SAMM."},
    {c:"MAS Project", q:"What does the OWASP MAS project use the term 'MAS Crackmes' to refer to?", a:"Intentionally vulnerable mobile apps designed for practising reverse engineering skills.", d:["Automated testing scripts that crack weak encryption in mobile application binaries.", "A scoring system that rates the difficulty of exploiting vulnerabilities found in apps.", "A certification exam that tests knowledge of the MASVS and MASTG documentation."], e:"MAS Crackmes are purposefully built mobile applications with varying levels of protections, designed for security testers to practice reverse engineering and analysis skills."},
    {c:"MAS Project", q:"How does the MASVS relate to regulatory compliance frameworks like GDPR?", a:"The MASVS-PRIVACY category aligns with data protection principles required by GDPR.", d:["The MASVS is a legally binding regulation that supersedes GDPR for mobile apps.", "GDPR compliance is only achievable through MASVS-STORAGE controls, not PRIVACY.", "The MASVS explicitly disclaims any relationship to data protection regulatory law."], e:"While not a regulation itself, MASVS-PRIVACY controls (consent, data management, transparency) align with GDPR requirements for data protection and user rights."},
    {c:"MAS Project", q:"What is the purpose of MAS Testing Profiles introduced in the MASVS restructuring?", a:"They define which controls to test based on the app's risk level and threat model.", d:["They provide pre-built automation scripts for running MASVS tests against mobile apps.", "They establish fixed pass/fail thresholds for MASVS compliance certification bodies.", "They list the professional certifications required for conducting MASVS assessments."], e:"MAS Testing Profiles (moved from MASVS levels to MASTG) define which MASVS controls to verify based on the application's security requirements and threat model."},
    {c:"MAS Project", q:"According to the OWASP MAS project, who is the intended audience for the MASVS?", a:"Mobile architects, developers, and security testers seeking to build and verify secure apps.", d:["Only certified penetration testers with at least five years of professional experience.", "Exclusively mobile app store review teams responsible for approving app submissions.", "Government regulators and compliance auditors working in the financial services sector."], e:"The MASVS is designed for mobile software architects and developers building secure apps, and security testers ensuring completeness and consistency of test results."}
];

let examQs, curr=0, answered={}, userAns={}, flagged={};

function shuffle(a) { for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];} return a; }

function initExam() {
    examQs = shuffle([...pool]).slice(0, TOTAL);
    answered={}; userAns={}; flagged={}; curr=0;

    examQs.forEach((q,i) => {
        let opts = shuffle([q.a, ...q.d]);
        examQs[i]._opts = opts;
    });

    document.getElementById('start-screen').style.display='none';
    document.getElementById('results-screen').style.display='none';
    document.getElementById('exam-ui').style.display='flex';
    document.getElementById('footer').style.display='flex';

    renderSide(); loadQ(0); updateProgress();
}

function updateProgress() {
    const cnt = Object.keys(answered).length;
    document.getElementById('progress-display').innerText = `${cnt} / ${TOTAL}`;
    document.getElementById('finish-btn').style.display = cnt === TOTAL ? 'inline-block' : 'none';
}

function renderSide() {
    const sb = document.getElementById('sidebar'); sb.innerHTML='';
    examQs.forEach((q,i) => {
        const b = document.createElement('button');
        b.className = 'nav-btn'; b.innerText = i+1;
        b.id = `nav-${i}`; b.onclick = () => loadQ(i);
        sb.appendChild(b);
    });
}

function loadQ(i) {
    curr = i;
    const q = examQs[i];

    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
    document.getElementById(`nav-${i}`).classList.add('active');
    document.getElementById('status').innerText = `Q ${i+1} / ${TOTAL}`;

    const con = document.getElementById('question-container'); con.innerHTML='';
    const card = document.createElement('div'); card.className='card';

    let html = `<div class="q-meta"><span class="tag">${q.c}</span><span class="q-num">#${i+1}</span></div><div class="q-text">${q.q}</div>`;

    const isAnswered = answered[i] !== undefined;

    q._opts.forEach((o, oi) => {
        let cls = 'option';
        if (isAnswered) {
            cls += ' locked';
            if (o === q.a) cls += ' opt-correct';
            else if (o === userAns[i]) cls += ' opt-wrong';
            else cls += ' opt-dim';
        }
        const clickHandler = isAnswered ? '' : `onclick="ans(${i}, ${oi})"`;
        html += `<div class="${cls}" ${clickHandler}>${o}</div>`;
    });

    if (isAnswered) {
        const wasCorrect = userAns[i] === q.a;
        html += `<div class="explanation-box"><strong>${wasCorrect ? '✓ Correct' : '✗ Incorrect'}</strong><br>${q.e}</div>`;
        if (i < TOTAL - 1) {
            html += `<div class="next-btn-wrap"><button class="btn btn-p" onclick="loadQ(${i+1})">Next Question →</button></div>`;
        }
    }

    card.innerHTML = html; con.appendChild(card);
    con.scrollTop = 0;
}

function ans(qi, optIdx) {
    const q = examQs[qi];
    userAns[qi] = q._opts[optIdx];
    answered[qi] = true;

    const navBtn = document.getElementById(`nav-${qi}`);
    if (userAns[qi] === q.a) {
        navBtn.classList.add('answered-correct');
    } else {
        navBtn.classList.add('answered-wrong');
    }

    loadQ(qi);
    updateProgress();
}

function nav(d) {
    const n = curr + d;
    if(n >= 0 && n < TOTAL) loadQ(n);
}

function flag() {
    flagged[curr] = !flagged[curr];
    const b = document.getElementById(`nav-${curr}`);
    if(flagged[curr]) b.classList.add('flagged'); else b.classList.remove('flagged');
}

function finish() {
    if(!confirm('Finish the quiz and see your results?')) return;
    document.getElementById('exam-ui').style.display='none';
    document.getElementById('footer').style.display='none';

    const resScreen = document.getElementById('results-screen');
    resScreen.style.display='block';
    resScreen.scrollTop = 0;

    let score = 0;
    let html = '';

    examQs.forEach((q, i) => {
        const correct = userAns[i] === q.a;
        if(correct) score++;
        html += `<div class="review-item ${correct?'correct':'wrong'}">
            <strong>Q${i+1} [${q.c}]: ${q.q}</strong><br>
            Your Answer: <b style="color:${correct?'#4ade80':'#f87171'}">${userAns[i]||'Skipped'}</b><br>
            ${!correct ? `Correct Answer: <b style="color:#4ade80">${q.a}</b>` : ''}
            <div class="review-explanation">Rationale: ${q.e}</div>
        </div>`;
    });

    const pct = Math.round((score/TOTAL)*100);

    document.getElementById('score-circle').innerText = `${pct}%`;
    document.getElementById('raw-score').innerText = `You answered ${score} out of ${TOTAL} questions correctly.`;
    document.getElementById('review-list').innerHTML = html;
}
</script>
</body>
</html>
