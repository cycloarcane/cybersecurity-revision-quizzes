<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OWASP Top 10:2025 Knowledge Quiz</title>
<style>
    @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Source+Sans+3:wght@400;600;700;900&display=swap');
    :root { 
        --bg: #010409; 
        --header: #0d1117; 
        --card: #161b22; 
        --border: #30363d; 
        --primary: #2f81f7; 
        --accent: #a371f7; 
        --success: #2ea043; 
        --danger: #f85149; 
        --warning: #d29922; 
        --text: #c9d1d9; 
        --white: #f0f6fc;
    }
    ::-webkit-scrollbar { width:10px; } ::-webkit-scrollbar-track { background:var(--bg); } ::-webkit-scrollbar-thumb { background:var(--border); border-radius:5px; border:2px solid var(--bg); }
    * { box-sizing:border-box; }
    body { font-family:'Source Sans 3',sans-serif; background:var(--bg); color:var(--text); margin:0; display:flex; flex-direction:column; height:100vh; overflow:hidden; }
    .header { background:linear-gradient(135deg, #0d1117 0%, #161b22 50%, #0d1117 100%); color:#fff; padding:15px 30px; display:flex; justify-content:space-between; align-items:center; box-shadow:0 4px 20px rgba(47,129,247,0.15); flex-shrink:0; z-index:10; border-bottom:2px solid var(--primary); }
    .header-title { font-family:'JetBrains Mono',monospace; font-size:1.4em; font-weight:700; letter-spacing:1px; color:var(--white); }
    .header-title span { color:var(--primary); }
    .progress-text { font-family:'JetBrains Mono',monospace; font-size:1.1em; font-weight:700; color:var(--warning); background:rgba(0,0,0,0.4); padding:6px 18px; border-radius:6px; border:1px solid rgba(210,153,34,0.3); }
    .main { display:flex; flex:1; overflow:hidden; }
    .sidebar { width:260px; background:var(--header); border-right:1px solid var(--border); overflow-y:auto; padding:12px; display:grid; grid-template-columns:repeat(5,1fr); gap:6px; align-content:start; flex-shrink:0; }
    .nav-btn { height:34px; border:1px solid var(--border); background:var(--card); cursor:pointer; font-weight:700; font-size:0.82em; border-radius:5px; transition:all 0.15s; color:#8b949e; font-family:'JetBrains Mono',monospace; }
    .nav-btn:hover { background:#21262d; color:#c9d1d9; border-color:#8b949e; }
    .nav-btn.active { background:var(--primary); color:white; border-color:var(--primary); box-shadow:0 0 10px rgba(47,129,247,0.4); }
    .nav-btn.answered-correct { background:#051d0f; border-color:var(--success); color:#3fb950; }
    .nav-btn.answered-wrong { background:#2d0b09; border-color:var(--danger); color:#ff7b72; }
    .nav-btn.flagged { border:2px solid var(--warning); box-shadow:0 0 8px rgba(210,153,34,0.3); }
    .content { flex:1; padding:35px; overflow-y:auto; display:flex; justify-content:center; align-items:flex-start; }
    .card { background:var(--card); max-width:900px; width:100%; padding:45px; border-radius:12px; box-shadow:0 8px 32px rgba(0,0,0,0.4); margin-bottom:40px; border:1px solid var(--border); }
    .q-meta { display:flex; justify-content:space-between; align-items:center; margin-bottom:22px; border-bottom:1px solid var(--border); padding-bottom:14px; }
    .tag { background:var(--primary); color:white; padding:5px 14px; border-radius:20px; font-size:0.8em; font-weight:700; text-transform:uppercase; letter-spacing:1px; font-family:'JetBrains Mono',monospace; }
    .q-num { color:#8b949e; font-family:'JetBrains Mono',monospace; font-size:0.9em; }
    .q-text { font-size:1.25em; font-weight:600; margin-bottom:30px; line-height:1.55; color:var(--white); }
    .option { width:100%; text-align:left; padding:16px 22px; margin-bottom:12px; background:var(--header); border:2px solid var(--border); border-radius:8px; cursor:pointer; font-size:1.05em; transition:all 0.2s; color:#c9d1d9; display:block; font-family:'Source Sans 3',sans-serif; }
    .option:hover:not(.locked) { border-color:#8b949e; background:#21262d; color:#ffffff; }
    .option.locked { cursor:default; }
    .option.opt-correct { border-color:var(--success); background:rgba(46,160,67,0.15); color:#3fb950; font-weight:700; }
    .option.opt-wrong { border-color:var(--danger); background:rgba(248,81,73,0.1); color:#ff7b72; }
    .option.opt-dim { opacity:0.5; }
    .explanation-box { margin-top:24px; padding:18px 22px; background:rgba(163,113,247,0.15); border:1px solid rgba(163,113,247,0.3); border-radius:8px; font-size:1em; color:#d2a8ff; line-height:1.6; }
    .explanation-box strong { color:#e6ccff; }
    .next-btn-wrap { text-align:center; margin-top:22px; }
    .footer { background:var(--header); padding:14px 35px; border-top:1px solid var(--border); display:flex; justify-content:space-between; align-items:center; flex-shrink:0; }
    .btn { padding:11px 28px; border:none; border-radius:6px; font-size:1.05em; font-weight:700; cursor:pointer; color:white; font-family:'Source Sans 3',sans-serif; transition:all 0.2s; }
    .btn:hover { transform:translateY(-1px); }
    .btn-s { background:#21262d; border:1px solid rgba(240,246,252,0.1); } .btn-s:hover { background:#30363d; }
    .btn-p { background:var(--primary); } .btn-p:hover { background:#388bfd; }
    .btn-w { background:var(--warning); color:#111; } .btn-w:hover { background:#e3b341; }
    .btn-g { background:var(--success); } .btn-g:hover { background:#3fb950; }
    #start-screen, #results-screen { position:fixed; top:0; left:0; width:100%; height:100%; background:var(--bg); z-index:2000; overflow-y:auto; }
    .center-wrapper { display:flex; flex-direction:column; align-items:center; justify-content:center; min-height:100vh; padding:40px; box-sizing:border-box; }
    .start-box { background:var(--card); padding:60px; border-radius:16px; box-shadow:0 20px 60px rgba(0,0,0,0.6); max-width:850px; text-align:center; border:1px solid var(--border); position:relative; overflow:hidden; }
    .start-box::before { content:''; position:absolute; top:0; left:0; right:0; height:4px; background:linear-gradient(90deg, var(--primary), var(--accent), var(--primary)); }
    .start-box h1 { color:var(--white); margin-bottom:8px; font-size:2.8em; font-family:'JetBrains Mono',monospace; letter-spacing:2px; }
    .start-box h1 span { color:var(--primary); }
    .start-box .subtitle { font-size:1em; color:#8b949e; margin-bottom:30px; font-family:'JetBrains Mono',monospace; letter-spacing:3px; text-transform:uppercase; }
    .start-box p { font-size:1.15em; line-height:1.7; color:#8b949e; margin:25px 0; }
    .start-box .stats { display:flex; justify-content:center; gap:40px; margin:30px 0; }
    .start-box .stat { text-align:center; }
    .start-box .stat-num { font-size:2.2em; font-weight:900; color:var(--primary); font-family:'JetBrains Mono',monospace; }
    .start-box .stat-label { font-size:0.85em; color:#8b949e; text-transform:uppercase; letter-spacing:2px; margin-top:4px; }
    .score-circle { width:200px; height:200px; border-radius:50%; display:flex; justify-content:center; align-items:center; font-size:3.8em; font-weight:900; color:white; margin:20px auto; box-shadow:0 10px 30px rgba(0,0,0,0.5); font-family:'JetBrains Mono',monospace; background:linear-gradient(135deg, var(--accent), var(--primary)); border:6px solid #161b22; }
    .review-item { text-align:left; background:var(--card); padding:22px; margin-bottom:16px; border-radius:10px; border-left:6px solid #444; width:100%; max-width:800px; box-shadow:0 2px 10px rgba(0,0,0,0.3); border:1px solid var(--border); }
    .review-item.correct { border-left-color:var(--success); }
    .review-item.wrong { border-left-color:var(--danger); }
    .review-item strong { color:var(--white); }
    .review-explanation { margin-top:12px; font-size:0.92em; color:#8b949e; background:rgba(163,113,247,0.15); padding:14px; border-radius:6px; border:1px solid rgba(163,113,247,0.3); }
    #status { font-weight:700; color:#8b949e; font-size:1.05em; font-family:'JetBrains Mono',monospace; }
</style>
</head>
<body>

<div id="start-screen">
    <div class="center-wrapper">
        <div class="start-box">
            <h1><span>OWASP</span> Top 10:2025</h1>
            <div class="subtitle">Web Application Security Risks</div>
            <div class="stats">
                <div class="stat"><div class="stat-num">120</div><div class="stat-label">Questions</div></div>
                <div class="stat"><div class="stat-num">Self-paced</div><div class="stat-label">No Timer</div></div>
            </div>
            <p>
                Covers all 10 categories: Broken Access Control, Security Misconfiguration, Software Supply Chain Failures, Cryptographic Failures, Injection, Insecure Design, Authentication Failures, Software or Data Integrity Failures, Security Logging &amp; Alerting Failures, &amp; Mishandling of Exceptional Conditions.<br>
                <em style="color:#8b949e;">Questions selected dynamically. Explanation shown after each answer.</em>
            </p>
            <button class="btn btn-p" onclick="initExam()" style="padding:16px 55px; font-size:1.25em; margin-top:10px;">Start Quiz</button>
        </div>
    </div>
</div>

<div class="header">
    <div class="header-title"><span>OWASP</span> Top 10:2025 Quiz</div>
    <div id="progress-display" class="progress-text">0 / 120</div>
</div>

<div class="main" id="exam-ui" style="display:none;">
    <div class="sidebar" id="sidebar"></div>
    <div class="content" id="question-container"></div>
</div>

<div class="footer" id="footer" style="display:none;">
    <div><button class="btn btn-s" onclick="nav(-1)">Previous</button> <button class="btn btn-w" onclick="flag()" style="margin-left:10px;">Flag</button></div>
    <div id="status">Q 1 / 120</div>
    <div><button class="btn btn-g" id="finish-btn" onclick="finish()" style="display:none;">Finish Quiz</button></div>
</div>

<div id="results-screen" style="display:none;">
    <div class="center-wrapper" style="justify-content:flex-start; padding-top:50px;">
        <div style="background:var(--card); padding:40px; border-radius:12px; max-width:800px; width:100%; box-shadow:0 10px 40px rgba(0,0,0,0.5); text-align:center; border:1px solid var(--border);">
            <h1 style="margin:0; color:var(--white); font-family:'JetBrains Mono',monospace;">Quiz Results</h1>
            <div id="score-circle" class="score-circle">0%</div>
            <div id="raw-score" style="font-size:1.2em; color:#8b949e; margin-bottom:25px; font-family:'JetBrains Mono',monospace;"></div>
            <button class="btn btn-p" onclick="location.reload()">Take New Quiz</button>
        </div>
        <div id="review-list" style="width:100%; max-width:800px; margin-top:25px;"></div>
    </div>
</div>

<script>
// ==============================================================
// PART 1 OF 2: QUESTIONS 1-60 (A01 to A05)
// ==============================================================
const pool_part_1 = [
    // --- A01: BROKEN ACCESS CONTROL (12) ---
    {c:"A01 Broken Access Control", q:"Which notable 2021 category was folded directly into A01:2025 Broken Access Control?", a:"A10:2021 Server-Side Request Forgery (SSRF).", d:["A04:2021 Insecure Application Design Flaws.", "A08:2021 Software and Data Integrity Issues.", "A03:2021 Cross-Site Scripting Injection (XSS)."], e:"SSRF was consolidated into Broken Access Control, as it fundamentally allows an attacker to bypass authorization to access internal resources."},
    {c:"A01 Broken Access Control", q:"What is considered a prime indicator of a Broken Access Control vulnerability?", a:"An attacker can successfully view or edit other users' private account data.", d:["An application logs extensive stack traces into a publicly readable console.", "A user is prompted to use a highly complex password during account setup.", "An application permits rapid, repetitive login attempts without any lockouts."], e:"Viewing or editing another user's account is a classic horizontal privilege escalation, the hallmark of broken access control."},
    {c:"A01 Broken Access Control", q:"How does CORS misconfiguration contribute to A01:2025 access vulnerabilities?", a:"It allows unauthorized external origins to successfully interact with the API.", d:["It stores sensitive cryptographic keys in publicly readable server locations.", "It directly executes untrusted SQL queries without utilizing prepared statements.", "It automatically elevates standard user privileges to administrative status."], e:"Cross-Origin Resource Sharing (CORS) misconfiguration allows unauthorized sites to make API requests, bypassing access controls."},
    {c:"A01 Broken Access Control", q:"What does OWASP recommend as the most secure default access control policy?", a:"Enforce deny-by-default for all resources not explicitly meant to be public.", d:["Enforce allow-by-default for internal users while blocking external traffic.", "Enforce role-based access but assign full privileges to newly created accounts.", "Enforce unrestricted access for GET requests and secure only POST requests."], e:"A deny-by-default policy ensures that any endpoint or resource that hasn't been explicitly secured remains inaccessible."},
    {c:"A01 Broken Access Control", q:"An attacker modifies a URL parameter from acct=myacct to acct=notmyacct to view another user's data. Which vulnerability is this?", a:"Insecure Direct Object Reference under Broken Access Control (A01).", d:["Server-Side Request Forgery exploiting internal parameter handling (A10).", "Injection via parameter tampering of the query string value (A05).", "Security Misconfiguration due to exposed URL parameters (A02)."], e:"This is a textbook IDOR flaw: using unverified data in a call to access another user's account."},
    {c:"A01 Broken Access Control", q:"What does OWASP recommend regarding web server directory listings?", a:"Disable directory listing and remove .git and backup files from web roots.", d:["Enable directory listings only for users with valid session credentials.", "Allow directory listings but apply a filter to show only HTML documents.", "Place a CAPTCHA challenge on all directory listing and index pages."], e:"OWASP explicitly recommends disabling directory listings and removing sensitive metadata from web roots."},
    {c:"A01 Broken Access Control", q:"Which access control vulnerability involves replaying or tampering with a JWT token to elevate privileges?", a:"Metadata manipulation, including JWT, cookie, and hidden field abuse.", d:["Force browsing via direct URL access to restricted admin endpoints.", "CORS misconfiguration enabling cross-origin API calls from attackers.", "Insecure Direct Object Reference through predictable resource paths."], e:"OWASP lists metadata manipulation including JWT tampering, cookie manipulation, and hidden field abuse under A01."},
    {c:"A01 Broken Access Control", q:"What does OWASP say about where access control should be enforced?", a:"Server-side code or serverless API, where attackers cannot modify checks.", d:["Client-side JavaScript for responsive and immediate user feedback.", "Browser-level HTML5 form validation before any request is submitted.", "CDN edge layer to intercept requests before reaching the application."], e:"Access control is only effective when enforced server-side where attackers cannot tamper with it."},
    {c:"A01 Broken Access Control", q:"OWASP recommends model access controls should enforce what principle?", a:"Record ownership, so users can only access their own data records.", d:["Universal read permissions with write restrictions for admin accounts.", "Time-based expiry where record access is revoked after thirty days.", "Geographic restrictions that limit data access based on user IP range."], e:"Enforcing record ownership ensures users can only access their own data, preventing horizontal privilege escalation."},
    {c:"A01 Broken Access Control", q:"Accessing an API with missing access controls for POST, PUT, and DELETE is an example of which vulnerability?", a:"Broken Access Control — missing function-level controls on API methods.", d:["Injection — API parameter manipulation through crafted request bodies.", "Security Misconfiguration — incorrect HTTP method definitions on server.", "Insecure Design — absent API gateway and request validation middleware."], e:"Missing access controls on API HTTP methods is explicitly listed as a common access control vulnerability in A01."},
    {c:"A01 Broken Access Control", q:"What does elevation of privilege mean in the context of A01?", a:"Acting as a user without login, or as an admin from a standard account.", d:["Gaining root access to the operating system of the underlying server.", "Escalating network-level privileges through VLAN hopping techniques.", "Obtaining physical access to the server hardware in the data centre."], e:"OWASP defines elevation of privilege as acting without login or as admin when authenticated as a regular user."},
    {c:"A01 Broken Access Control", q:"Which CWE mapped to A01 describes authorization bypass through a user-controlled key?", a:"CWE-639: Authorization Bypass Through User-Controlled Key.", d:["CWE-352: Cross-Site Request Forgery via State-Changing Requests.", "CWE-601: URL Redirection to Untrusted Site via Open Redirect.", "CWE-548: Exposure of Information Through Directory Listing Page."], e:"CWE-639 covers scenarios where users manipulate keys/IDs to access other users' resources (IDOR pattern)."},

    // --- A02: SECURITY MISCONFIGURATION (12) ---
    {c:"A02 Security Misconfiguration", q:"Why did Security Misconfiguration climb to the #2 position in the 2025 edition?", a:"The rise of complex infrastructure-as-code has increased configuration flaws.", d:["The discovery of a major cryptographic vulnerability affected web servers.", "The decline in automated security scanners led to unchecked vulnerabilities.", "The introduction of modern web frameworks disabled default security headers."], e:"The complexity of modern deployments, cloud services, and infrastructure-as-code has made configuration errors far more prevalent."},
    {c:"A02 Security Misconfiguration", q:"Which of the following describes a textbook Security Misconfiguration flaw?", a:"Leaving default service accounts and their original passwords active in production.", d:["Implementing an outdated, weak hashing algorithm to store user passwords.", "Failing to sanitize untrusted input before rendering it in the user's browser.", "Utilizing a third-party open-source library that contains a known backdoor."], e:"Default accounts and passwords left active are a primary example of failing to properly configure and harden a system."},
    {c:"A02 Security Misconfiguration", q:"What does OWASP strongly recommend to ensure environments are configured securely?", a:"Implement a repeatable, fully automated hardening process for all environments.", d:["Perform a manual code review of the entire application immediately before release.", "Disable all administrative logging to prevent the exposure of sensitive credentials.", "Rely exclusively on perimeter web application firewalls to catch configuration errors."], e:"An automated, repeatable hardening process ensures that development, QA, and production are all configured identically and securely."},
    {c:"A02 Security Misconfiguration", q:"How should excessive error messages be managed to prevent misconfiguration flaws?", a:"Utilize a central configuration to intercept them before they reach the end user.", d:["Log them locally in the browser's JavaScript console for rapid developer access.", "Encrypt the stack trace content so only administrators have the decryption keys.", "Display them plainly so end users can accurately report bugs to the support team."], e:"Intercepting excessive error messages centrally ensures that sensitive stack traces and framework versions are not leaked to attackers."},
    {c:"A02 Security Misconfiguration", q:"Which of the following does OWASP list as a misconfiguration related to cloud storage?", a:"Improperly configured permissions on cloud services such as S3 bucket policies.", d:["Encrypting all cloud storage objects with customer-managed encryption keys.", "Enabling versioning on S3 buckets to preserve historical object revisions.", "Using IAM roles with least-privilege policies for all cloud service access."], e:"OWASP lists improper cloud permissions (e.g., open S3 buckets) as a common security misconfiguration."},
    {c:"A02 Security Misconfiguration", q:"What does OWASP recommend regarding security headers?", a:"Send security directives and headers with appropriate hardened values in responses.", d:["Omit security headers to reduce response size and improve page load latency.", "Set all security headers to their most permissive values for compatibility.", "Only configure security headers on the login page, not on other endpoints."], e:"OWASP recommends sending security headers and directives with proper values as part of secure configuration."},
    {c:"A02 Security Misconfiguration", q:"What does OWASP recommend about XML processor configuration to prevent XXE?", a:"Disable XML external entity processing and DTD processing in all XML parsers.", d:["Enable XML external entity processing for interoperability with legacy feeds.", "Allow DTD processing only for internal XML documents signed by the server.", "Configure XML parsers to fetch external entities via HTTPS connections only."], e:"Disabling XXE and DTD processing is OWASP's recommendation, as XXE was merged into Security Misconfiguration."},
    {c:"A02 Security Misconfiguration", q:"What does OWASP recommend as a segmented application architecture approach?", a:"Use segmentation and containerization to separate components and tenant access.", d:["Deploy all services on a single monolithic server for simplified management.", "Share database credentials across all application tiers for convenience.", "Run all microservices under the same OS user account for easy permissions."], e:"OWASP recommends segmented application architecture through containerization or cloud security groups."},
    {c:"A02 Security Misconfiguration", q:"What does OWASP say about directory listing as a misconfiguration?", a:"Directory listing should be disabled on the server to prevent file enumeration.", d:["Directory listing should be enabled and protected with HTTP Basic auth only.", "Directory listing is acceptable as long as all listed files are read-only.", "Directory listing configuration has no security relevance for web servers."], e:"OWASP lists directory listing as a misconfiguration that can reveal sensitive files and server structure."},
    {c:"A02 Security Misconfiguration", q:"OWASP recommends reviewing configurations how often for cloud-hosted applications?", a:"Regularly review and update configurations as part of patch management cycles.", d:["Review configurations only once during the initial deployment of the service.", "Review configurations only after a security breach has been reported.", "Review configurations every five years in line with compliance audit timelines."], e:"OWASP recommends regular review and updating of configurations across all environments."},
    {c:"A02 Security Misconfiguration", q:"What type of software installation does OWASP warn against in the context of A02?", a:"Unnecessary software, frameworks, or features that are installed but not required.", d:["Essential runtime dependencies required for the application to function properly.", "Operating system security patches and critical vendor-supplied hotfix updates.", "Monitoring agents that provide real-time visibility into application health."], e:"OWASP warns against installing software or features that are not needed, as they increase attack surface."},
    {c:"A02 Security Misconfiguration", q:"OWASP recommends what approach for managing configuration across different environments?", a:"Use identical security configuration in dev, staging, and production environments.", d:["Apply strict security only in production and relax it in dev and staging.", "Configure each environment independently with no standardized baseline.", "Maintain security configuration only in production and skip other environments."], e:"OWASP recommends consistent security configuration across all environments to prevent deployment-related issues."},

    // --- A03: SOFTWARE SUPPLY CHAIN FAILURES (12) ---
    {c:"A03 Supply Chain Failures", q:"What does A03:2025 explicitly highlight as a major new threat vector in applications?", a:"Malicious packages, compromised maintainers, and tampered build processes.", d:["SQL injection attacks targeting deeply nested relational database architectures.", "Automated credential stuffing attacks exploiting poorly secured login endpoints.", "Weak session identifiers resulting from customized random number generators."], e:"A03 was expanded to explicitly call out malware in software ecosystems, compromised registries, and tampered build systems."},
    {c:"A03 Supply Chain Failures", q:"Which of the following is considered a primary software supply chain failure?", a:"Utilizing unverified third-party dependencies that contain hidden backdoor code.", d:["Storing plaintext user passwords inside a publicly accessible backend database.", "Failing to require multi-factor authentication for administrative user accounts.", "Permitting external entities to resolve internal DNS queries via SSRF flaws."], e:"Using dependencies from untrusted sources or those that have been compromised with backdoors is a direct supply chain failure."},
    {c:"A03 Supply Chain Failures", q:"How does A03:2025 differ from the 2021 Vulnerable and Outdated Components category?", a:"It expands beyond mere dependencies to include build pipelines and registries.", d:["It focuses solely on outdated frameworks rather than actively malicious packages.", "It limits its scope entirely to commercial software tools rather than open-source.", "It merges the risks of outdated software directly into the Insecure Design category."], e:"The category was broadened significantly to cover the entire supply chain, including CI/CD pipelines, distribution infrastructure, and registries."},
    {c:"A03 Supply Chain Failures", q:"What foundational mitigation strategy does OWASP suggest for supply chain risks?", a:"Continuously track changes and rigorously scan dependencies for vulnerabilities.", d:["Write all application code entirely from scratch without using any external libraries.", "Store all third-party dependencies in air-gapped environments disconnected from networks.", "Apply virtual patching exclusively at the web application firewall level for protection."], e:"Organizations must maintain visibility (e.g., via SBOMs) and continuously scan their dependencies and pipelines to manage supply chain risks."},
    {c:"A03 Supply Chain Failures", q:"What does OWASP recommend removing from applications to reduce A03 risk?", a:"Unused dependencies, unnecessary features, components, files, and documentation.", d:["All third-party dependencies in favour of writing everything from scratch.", "Logging and monitoring libraries to reduce the application's code footprint.", "Authentication libraries in favour of custom-built credential management."], e:"OWASP recommends removing unused dependencies and unnecessary components to reduce the attack surface."},
    {c:"A03 Supply Chain Failures", q:"What is a software bill of materials (SBOM) in the context of A03?", a:"An inventory of all components and their versions used in an application.", d:["A financial document listing the cost of all software licences purchased.", "A deployment manifest that maps components to specific cloud instances.", "A test report summarizing the results of automated security scans."], e:"An SBOM provides a comprehensive inventory of components, enabling vulnerability tracking and management."},
    {c:"A03 Supply Chain Failures", q:"What does OWASP recommend as an ongoing governance process for A03?", a:"Maintain a plan for monitoring, triaging, and applying updates over the application lifetime.", d:["Freeze all component versions at initial release and never apply updates.", "Update components only when migrating to a new major application version.", "Delegate all component management to the cloud provider's managed service."], e:"OWASP recommends an ongoing plan for monitoring, triaging, and applying updates or config changes for the application lifetime."},
    {c:"A03 Supply Chain Failures", q:"According to OWASP, what makes nested dependencies particularly dangerous for A03?", a:"You may not be aware of nested transitive dependencies or their known vulnerabilities.", d:["Nested dependencies are always isolated in their own security sandbox at runtime.", "Nested dependencies are automatically updated when the parent package is patched.", "Nested dependencies cannot introduce vulnerabilities because they are compiled out."], e:"Nested/transitive dependencies are dangerous because organisations often don't track them or their vulnerabilities."},
    {c:"A03 Supply Chain Failures", q:"What scanning approach does OWASP recommend for detecting vulnerable components?", a:"Use software composition analysis (SCA) tools to automate dependency vulnerability detection.", d:["Perform manual code review of all third-party library source code before each build.", "Rely on runtime application self-protection (RASP) to block all component exploits.", "Use dynamic application security testing (DAST) which comprehensively covers components."], e:"SCA tools automate the detection of known vulnerabilities in dependencies and are recommended by OWASP."},
    {c:"A03 Supply Chain Failures", q:"OWASP warns that vulnerability in which scenario is particularly concerning for A03?", a:"Software that is unsupported, out of date, or unpatched by the vendor.", d:["Software that has been recently released with a first stable version number.", "Software that is open-source with an active community and weekly releases.", "Software that receives long-term support from the vendor with a clear roadmap."], e:"OWASP warns about unsupported, out-of-date, or vulnerable software including OS, web/app server, DBMS, and libraries."},
    {c:"A03 Supply Chain Failures", q:"What does OWASP recommend as an alternative if patching a component is not immediately possible?", a:"Apply a virtual patch using a web application firewall rule to mitigate the exposure.", d:["Ignore the vulnerability and accept the risk until the next scheduled release.", "Remove the entire application from production until the component is updated.", "Replace the component with an unvetted alternative immediately without testing."], e:"OWASP recommends virtual patching through WAF rules as an interim mitigation when immediate patching isn't possible."},
    {c:"A03 Supply Chain Failures", q:"OWASP recommends obtaining components from what type of source?", a:"Official sources over secure links, preferring signed packages to reduce risk.", d:["Any available mirror regardless of signature verification or link security.", "Community forks on GitHub that have more recent activity than official repos.", "Cached copies from internal developer machines to avoid network dependencies."], e:"OWASP recommends using official sources over secure links and preferring signed packages."},

    // --- A04: CRYPTOGRAPHIC FAILURES (12) ---
    {c:"A04 Cryptographic Failures", q:"What position did Cryptographic Failures hold in 2021 before dropping in 2025?", a:"It was ranked at A02 in 2021 and dropped slightly to A04 in the 2025 edition.", d:["It was ranked at A05 in 2021 and dropped slightly to A07 in the 2025 edition.", "It was ranked at A01 in 2021 and dropped slightly to A03 in the 2025 edition.", "It was ranked at A03 in 2021 and dropped slightly to A06 in the 2025 edition."], e:"Cryptographic Failures moved from the #2 spot in 2021 down to #4 in 2025."},
    {c:"A04 Cryptographic Failures", q:"What is the most direct consequence of an application suffering Cryptographic Failures?", a:"Sensitive data exposure, such as passwords, health records, or financial details.", d:["Complete denial of service caused by overwhelming the server with malicious requests.", "Unauthorized remote code execution on the underlying operating system environment.", "Elevation of standard user privileges to administrative status within the application."], e:"Failing to protect data via cryptography leads directly to the exposure of sensitive information (formerly called Sensitive Data Exposure)."},
    {c:"A04 Cryptographic Failures", q:"Which dangerous practice is explicitly warned against under A04:2025 guidelines?", a:"Transmitting highly sensitive unencrypted data over legacy protocols like FTP.", d:["Applying multi-factor authentication inconsistently across different application portals.", "Allowing standard users to directly modify their own profile data without administration.", "Logging successful authentication events into a secure, centralized SIEM database."], e:"Transmitting data in cleartext (HTTP, FTP, Telnet) completely bypasses cryptographic protection in transit."},
    {c:"A04 Cryptographic Failures", q:"How should developers secure passwords at rest to effectively prevent compromises?", a:"Use strong, salted, adaptive hashing algorithms such as Argon2, scrypt, or bcrypt.", d:["Use highly complex, custom-built encryption routines engineered exclusively in-house.", "Use rapid, general-purpose cryptographic hash functions like MD5 or SHA-256 globally.", "Use two-way symmetric encryption so that passwords can be recovered if forgotten."], e:"OWASP recommends adaptive, salted hashing functions with a sufficient work factor (Argon2, bcrypt) for password storage."},
    {c:"A04 Cryptographic Failures", q:"What is the first step OWASP recommends for preventing cryptographic failures?", a:"Determine the protection needs of data both in transit and at rest.", d:["Install the latest version of all cryptographic libraries and drivers.", "Enforce TLS 1.3 on every server endpoint within the organisation.", "Engage an external cryptography consultant for an architecture review."], e:"The first step is classifying data and identifying protection needs before selecting controls."},
    {c:"A04 Cryptographic Failures", q:"Which of the following is a cryptographic failure according to OWASP?", a:"Using an insecure block cipher mode of operation such as ECB.", d:["Using AES-256 with GCM mode and authenticated encryption throughout.", "Implementing TLS 1.3 with only AEAD cipher suites on all endpoints.", "Generating all cryptographic keys using a secure CSPRNG function."], e:"ECB mode encrypts identical plaintext blocks to identical ciphertext blocks, leaking patterns."},
    {c:"A04 Cryptographic Failures", q:"What does OWASP say about using a cryptographic hash directly as a key derivation function for passwords?", a:"It is a failure — a dedicated password-based KDF should be used instead.", d:["It is acceptable when the original password exceeds twenty characters.", "It is recommended as the simplest approach for small-scale applications.", "It is fine as long as the password has been salted before being hashed."], e:"Using a cryptographic hash function directly rather than a password-based KDF is explicitly a failure."},
    {c:"A04 Cryptographic Failures", q:"What is OWASP's primary recommendation for sensitive data that is not needed?", a:"Do not store it — data that is not retained cannot be stolen later.", d:["Store it in an encrypted archive with a rotated key and audit log.", "Move it to air-gapped cold storage with restricted physical access.", "Anonymize it using tokenization then store it in a separate database."], e:"OWASP emphasizes not retaining unnecessary data as the most effective protection."},
    {c:"A04 Cryptographic Failures", q:"According to OWASP, what should be verified about encryption key management?", a:"Keys should be generated properly and stored securely with rotation in place.", d:["Keys should be embedded in source code for consistent access by services.", "Keys should be shared across all environments to simplify deployment.", "Keys only need to be created once and reused indefinitely across systems."], e:"Proper key generation, secure storage, and key rotation are all part of OWASP's prevention guidance."},
    {c:"A04 Cryptographic Failures", q:"OWASP lists which of the following as deprecated cryptographic elements?", a:"MD5, SHA-1, and PKCS #1 v1.5 padding are listed as deprecated.", d:["AES-256, SHA-512, and RSA-OAEP padding are listed as deprecated.", "ChaCha20, Poly1305, and Ed25519 signatures are listed as deprecated.", "Argon2, HKDF, and X25519 key exchange are listed as deprecated."], e:"OWASP explicitly lists MD5, SHA-1, and PKCS number 1 v1.5 as deprecated cryptographic functions and padding."},
    {c:"A04 Cryptographic Failures", q:"What does OWASP say about initialization vectors for cryptographic operations?", a:"Use proper initialization vectors appropriate to the mode of operation.", d:["Reuse the same initialization vector for all operations with one key.", "Use a fixed all-zeroes initialization vector for deterministic results.", "Skip initialization vectors entirely when using block cipher algorithms."], e:"OWASP specifies that appropriate IVs must be used, and that their configuration must match the mode of operation."},
    {c:"A04 Cryptographic Failures", q:"What does OWASP recommend about caching responses containing sensitive data?", a:"Disable caching for responses that carry any sensitive or personal data.", d:["Cache sensitive responses for up to five minutes to reduce server load.", "Cache all responses by default and purge cache entries once per day.", "Allow caching only at the CDN level with encrypted cache storage."], e:"OWASP recommends disabling caching for responses containing sensitive data to prevent exposure via cache stores."},

    // --- A05: INJECTION (12) ---
    {c:"A05 Injection", q:"What position does Injection currently hold in the OWASP Top 10 2025 list?", a:"It is ranked at A05, having dropped from the third position in the 2021 edition.", d:["It is ranked at A03, having moved up from the fifth position in the 2021 edition.", "It is ranked at A01, having remained the most prevalent vulnerability since 2017.", "It is ranked at A08, reflecting a massive decrease in SQL-related attacks overall."], e:"Injection dropped from #3 in 2021 to #5 in 2025."},
    {c:"A05 Injection", q:"Which of the following scenarios best describes a classic injection vulnerability?", a:"User-supplied data is interpreted as executable commands by a backend parser.", d:["User session tokens are generated using predictable pseudo-random number generators.", "Application architecture allows attackers to bypass the intended business logic flow.", "Sensitive database backups are stored in a public, completely unencrypted directory."], e:"Injection occurs when untrusted data is sent to an interpreter as part of a command or query, tricking it into executing unintended commands."},
    {c:"A05 Injection", q:"What is globally recognized as the most effective primary defense against SQL injection?", a:"Utilizing parameterized queries or prepared statements for all database access.", d:["Implementing an extensive deny-list of known malicious SQL keywords and characters.", "Encoding all user input into Base64 format before passing it to the database driver.", "Configuring the application server to run with the lowest possible system privileges."], e:"Parameterized queries ensure that the database treats user input strictly as data, not as executable SQL syntax."},
    {c:"A05 Injection", q:"Is Cross-Site Scripting (XSS) still considered a form of injection in the 2025 list?", a:"Yes, XSS occurs when malicious scripts are injected into trusted website contexts.", d:["No, XSS was completely separated into its own distinct category for the 2025 edition.", "No, XSS is now exclusively categorized under A06:2025 Insecure Application Design.", "Yes, but only if the injected script successfully accesses backend database architectures."], e:"XSS was merged into the broader Injection category in 2021 and remains there in 2025, as it is fundamentally a client-side injection flaw."},
    {c:"A05 Injection", q:"Which OWASP-recommended approach uses stored procedures safely to prevent SQL injection?", a:"Parameterized stored procedures that do not include dynamic SQL construction.", d:["Stored procedures that concatenate user input directly into query strings.", "Stored procedures that rely on input validation only, not parameterization.", "Stored procedures that use EXECUTE IMMEDIATE with sanitized user variables."], e:"Stored procedures are safe only when they use parameterized queries and avoid constructing dynamic SQL internally."},
    {c:"A05 Injection", q:"According to OWASP, what server-side validation approach helps prevent injection?", a:"Use positive allow-list input validation as an additional defence layer.", d:["Use a deny-list of known bad characters as the primary defence layer.", "Rely on the database driver's built-in auto-escaping for all queries.", "Perform input validation only at the client-side boundary for efficiency."], e:"OWASP recommends positive server-side input validation as additional defence, noting it's not complete since many apps need special characters."},
    {c:"A05 Injection", q:"For dynamic queries where parameterization is not possible, what does OWASP recommend?", a:"Escape special characters using the specific escape syntax for that interpreter.", d:["Concatenate user input directly but wrap it in single quotes for safety.", "Use Base64 encoding on all user inputs before inserting them into queries.", "Apply SHA-256 hashing to user inputs before passing them to the database."], e:"When parameterized queries aren't available, OWASP recommends interpreter-specific escaping of special characters."},
    {c:"A05 Injection", q:"OWASP recommends using which SQL clause to limit mass data disclosure from injection?", a:"LIMIT and other SQL controls to restrict the number of records returned.", d:["DISTINCT to eliminate duplicate records from the injection result set.", "GROUP BY to aggregate leaked records into less useful summary format.", "ORDER BY with OFFSET to paginate results so fewer appear at one time."], e:"OWASP recommends LIMIT and similar SQL controls to prevent mass disclosure of records in case of injection."},
    {c:"A05 Injection", q:"A web form passes user input directly into an LDAP query without sanitization. Which injection type is this?", a:"LDAP injection, which is covered under the A05 Injection category.", d:["SQL injection, which targets relational databases through query manipulation.", "XSS injection, which targets client-side browsers through script insertion.", "Command injection, which targets the operating system's command interpreter."], e:"LDAP injection occurs when user input is directly inserted into LDAP queries without sanitization."},
    {c:"A05 Injection", q:"What does OWASP say about source code review in relation to injection prevention?", a:"Source code review is the best method for detecting injection vulnerabilities.", d:["Source code review is only useful for detecting XSS, not other injections.", "Automated DAST scanning alone is sufficient for detecting all injections.", "Source code review should be replaced entirely by runtime WAF protection."], e:"OWASP states that source code review is the best method of detecting if applications are vulnerable to injections."},
    {c:"A05 Injection", q:"Which injection type targets the operating system through an application?", a:"OS command injection, where user input is passed to system shell commands.", d:["SQL injection, where user input is embedded in database query statements.", "XPath injection, where user input is inserted into XML query expressions.", "Expression Language injection, where input reaches a template engine evaluator."], e:"OS command injection targets the operating system layer and is part of A05."},
    {c:"A05 Injection", q:"What role does output encoding play in preventing injection according to OWASP?", a:"It prevents injected data from being interpreted as commands or markup in output.", d:["It replaces the need for parameterized queries entirely in all injection cases.", "It is only useful for preventing SQL injection, not other injection categories.", "It converts malicious input into safe binary before it enters the data store."], e:"Output encoding ensures that user-supplied data is treated as display text rather than executable code in the output context."}
];
// ==============================================================
// PART 2 OF 2: QUESTIONS 61-120 (A06 to A10 + Supplemental)
// ==============================================================
const pool_part_2 = [
    // --- A06: INSECURE DESIGN (12) ---
    {c:"A06 Insecure Design", q:"What is the absolute core focus of the A06:2025 Insecure Design category?", a:"Risks directly introduced by poor architectural decisions and lack of threat modeling.", d:["Risks directly introduced by relying entirely upon unverified third-party code libraries.", "Risks directly introduced by failing to sanitize user inputs before rendering them on-screen.", "Risks directly introduced by failing to log administrative authentication attempts properly."], e:"Insecure Design focuses on foundational architectural flaws and missing threat modeling rather than implementation bugs."},
    {c:"A06 Insecure Design", q:"How does insecure design fundamentally differ from an insecure implementation?", a:"An insecure design cannot be successfully fixed simply by writing flawless source code.", d:["An insecure design is easily detected by standard automated vulnerability scanners.", "An insecure design only applies to backend relational database schema configurations.", "An insecure design typically resolves itself when modern web frameworks are updated."], e:"Perfectly implemented code can still be highly vulnerable if the underlying business logic or design is fundamentally flawed."},
    {c:"A06 Insecure Design", q:"Which security practice is absolutely essential for preventing insecure design flaws?", a:"Conducting thorough threat modeling exercises long before any code is actually written.", d:["Implementing robust web application firewalls immediately after application deployment.", "Relying strictly on runtime application self-protection mechanisms in the production phase.", "Performing automated static code analysis during the final stages of the build pipeline."], e:"Threat modeling during the design phase is critical to identifying and mitigating architectural risks before they are codified."},
    {c:"A06 Insecure Design", q:"Which prominent Common Weakness Enumeration is associated with Insecure Design?", a:"CWE-209: Generation of Error Messages Containing Highly Sensitive Internal Information.", d:["CWE-89: Improper Neutralization of Special Elements utilized within SQL Commands.", "CWE-352: Cross-Site Request Forgery allowing unauthorized state-changing actions.", "CWE-502: Deserialization of Untrusted Data originating from External User Input."], e:"CWE-209 is mapped to Insecure Design, highlighting that poorly designed error handling logic exposes internal system details."},
    {c:"A06 Insecure Design", q:"What does OWASP recommend for limiting resource consumption in secure design?", a:"Implement resource limits per user or service to prevent excessive infrastructure consumption.", d:["Allow unlimited resource usage and scale infrastructure horizontally instead of throttling.", "Apply resource limits only to unauthenticated sessions, ignoring logged-in premium users.", "Restrict resource limits to database queries only, not general API or static file requests."], e:"OWASP recommends limiting resource consumption by user or service as a design-level control against DoS."},
    {c:"A06 Insecure Design", q:"How does OWASP recommend validating business logic flows to prevent abuse?", a:"Use strict plausibility checks at each tier to validate that actions make business sense.", d:["Validate only the final step of a multi-page flow to ensure the end state is fully correct.", "Rely primarily on client-side form validation to enforce rigid business logic constraints.", "Allow all actions natively and use post-hoc log analysis to detect potential abuse patterns."], e:"OWASP recommends plausibility checks at the tier level to verify business logic consistency and prevent flow bypasses."},
    {c:"A06 Insecure Design", q:"What does OWASP recommend using to establish a secure development lifecycle?", a:"A secure development lifecycle supported by AppSec professionals for design evaluation.", d:["A waterfall development process containing a single security gate right before final release.", "An agile process that completely defers security reviews until the very last sprint cycle.", "A DevOps pipeline focused strictly on automated scanning without any manual design review."], e:"OWASP recommends a secure development lifecycle with AppSec professionals to help evaluate and design security controls."},
    {c:"A06 Insecure Design", q:"What type of development patterns does OWASP recommend establishing for secure design?", a:"A robust library of secure design patterns or paved road components ready for developer use.", d:["A library of automated penetration testing scripts to verify designs after production deployment.", "A library of specialized incident response playbooks to handle sophisticated design flaw exploits.", "A library of compliance checklists meant to rigorously audit designs against industry regulations."], e:"OWASP recommends creating a library of secure design patterns or 'paved road' ready-to-use components."},
    {c:"A06 Insecure Design", q:"What does OWASP recommend regarding user stories in a secure development lifecycle?", a:"Integrate security constraints and specific controls directly into each user story definition.", d:["Keep security requirements in an entirely separate document from functional user stories.", "Add specialized security stories only after all core functional stories are fully completed.", "Defer defining security constraints until the formal penetration testing phase officially begins."], e:"OWASP recommends integrating security language and controls directly into user stories to shift security left."},
    {c:"A06 Insecure Design", q:"Which OWASP scenario illustrates a credential recovery flow design flaw?", a:"Using highly predictable knowledge-based security questions for automated password recovery.", d:["Permitting mass fake cinema reservations by omitting a required upfront financial deposit.", "Launching a highly anticipated retail product without implementing adequate bot protection.", "Deploying a financial transaction API completely lacking mandatory rate limit constraints."], e:"Using knowledge-based questions (e.g., 'What is your favorite color?') is an insecure design for credential recovery."},
    {c:"A06 Insecure Design", q:"What development methodology does OWASP strongly promote to address insecure design?", a:"Shift-left security: proactively integrating security activities early in the development process.", d:["Shift-right security: completely deferring all security testing until active production monitoring.", "Test-driven security: writing comprehensive penetration tests before writing any source code.", "Compliance-driven security: implementing mandatory controls only when regulations dictate it."], e:"OWASP promotes shift-left security, bringing security into the earliest phases of design and development."},
    {c:"A06 Insecure Design", q:"OWASP says that a missing or ineffective control design for a specific flow is an example of what?", a:"Insecure design — the complete absence of a control that should have been originally designed in.", d:["Security misconfiguration — a valid control natively exists but was configured quite incorrectly.", "Vulnerable component — the control's associated library has a widely known published exploit.", "Injection — the required control was physically present but easily bypassed via malformed input."], e:"OWASP explicitly defines insecure design as including missing or ineffective controls that should have been designed."},

    // --- A07: AUTHENTICATION FAILURES (12) ---
    {c:"A07 Authentication Failures", q:"What is a very common end result of A07:2025 Authentication Failures?", a:"Successful credential stuffing, brute force attacks, and complete account takeovers.", d:["Unauthorized execution of arbitrary operating system commands on the backend server.", "Complete corruption of relational database tables via malicious parameter manipulation.", "Information disclosure strictly limited to non-sensitive application version metadata."], e:"Weak authentication mechanisms lead directly to account takeovers through automated brute force and credential stuffing attacks."},
    {c:"A07 Authentication Failures", q:"What does OWASP strongly recommend to defend against automated login attacks?", a:"Implementing secure multi-factor authentication across all standard and admin accounts.", d:["Allowing an unlimited number of login attempts to avoid accidental user lockouts.", "Requiring users to change their account passwords aggressively every fourteen days.", "Replacing traditional passwords entirely with obscure knowledge-based security questions."], e:"Multi-factor authentication (MFA) is the most effective defense against automated credential stuffing and brute force attacks."},
    {c:"A07 Authentication Failures", q:"Why is improper session management categorized directly under Authentication Failures?", a:"Because weak or predictable session IDs allow attackers to hijack authenticated sessions.", d:["Because sessions are primarily stored in relational databases which are prone to injection.", "Because session management logic dictates how cross-origin resource sharing is configured.", "Because expired sessions automatically trigger detailed error messages exposing internal data."], e:"Session management is an extension of authentication; if a session ID can be stolen or guessed, the authentication is bypassed."},
    {c:"A07 Authentication Failures", q:"How should an application handle login failure notifications to maintain tight security?", a:"Provide identical, generic messages that do not reveal whether the username is valid.", d:["Provide distinct error messages to help users easily identify if they mistyped their username.", "Redirect the user to a detailed debugging page explaining exactly why the authentication failed.", "Temporarily disable the account and email a plaintext recovery password to the registered address."], e:"Generic failure messages prevent user enumeration, making it impossible for an attacker to verify if an account exists."},
    {c:"A07 Authentication Failures", q:"What does OWASP recommend for preventing brute force attacks on authentication?", a:"Implement rate limiting and progressively increase delays after multiple failed attempts.", d:["Allow unlimited login attempts natively to avoid accidentally locking legitimate user accounts.", "Implement client-side JavaScript cooldown timers exclusively between login form submissions.", "Block all accounts permanently after a single failed attempt to maximize application security."], e:"OWASP recommends limiting failed authentication attempts through rate limiting and increasing delays."},
    {c:"A07 Authentication Failures", q:"What does OWASP say about default credentials in the context of A07?", a:"Applications should absolutely never ship with default credentials, especially for admin users.", d:["Default credentials are fully acceptable if clearly documented in the administrator setup guide.", "Default admin credentials should be securely shared verbally during onboarding processes only.", "Default credentials remain perfectly safe as long as users are strongly reminded to change them."], e:"OWASP explicitly states applications should not ship with default credentials, especially for admin accounts."},
    {c:"A07 Authentication Failures", q:"OWASP recommends what password policy based on modern NIST 800-63b guidelines?", a:"Check all new user passwords against a comprehensive list of the most common breached passwords.", d:["Require user passwords to strictly include uppercase, lowercase, numbers, and special characters.", "Enforce mandatory global password changes every sixty days for all registered application accounts.", "Set a strict maximum password length of exactly sixteen characters to prevent backend buffer issues."], e:"OWASP aligns with NIST 800-63b, recommending checking passwords against lists of known-bad/breached passwords."},
    {c:"A07 Authentication Failures", q:"What does OWASP say about session identifier handling immediately after a successful login?", a:"Generate a completely new random session ID after login; do not reuse the pre-login session.", d:["Reuse the existing pre-login session ID to maintain seamless continuity for the authenticated user.", "Store the active session ID directly in the URL query string for easy browser bookmarking functionality.", "Use a highly predictable session ID derived directly from the username for easier backend debugging."], e:"OWASP recommends generating new random session IDs after login to prevent session fixation attacks."},
    {c:"A07 Authentication Failures", q:"According to OWASP, what should session identifiers NOT be present in?", a:"The URL — session IDs should not be included in the address bar or within any URL parameters.", d:["The Set-Cookie response header — session IDs should utilize local browser storage mechanisms instead.", "The Authorization request header — session IDs should utilize standard query strings parameters instead.", "The HTTP response body — session IDs should be securely stored exclusively in the page title metadata."], e:"OWASP states that session identifiers should not be in the URL to prevent session leakage via referers or history."},
    {c:"A07 Authentication Failures", q:"What does OWASP recommend regarding minimum password length requirements?", a:"Enforce a minimum password length and strongly allow longer passphrases up to 64+ characters.", d:["Set a strict minimum of four characters and a maximum of twelve to prioritize user memorability.", "Set a strict minimum of eight characters and a maximum of sixteen to ensure backend consistency.", "Enforce absolutely no minimum length but require at least three complex special characters instead."], e:"OWASP aligns with NIST 800-63b in requiring adequate minimum length while allowing very long passphrases."},
    {c:"A07 Authentication Failures", q:"What does OWASP recommend about session tokens upon user logout?", a:"Invalidate session tokens immediately on the backend server side upon a successful user logout.", d:["Keep session tokens fully valid for thirty minutes after logout to permit accidental tab recovery.", "Mark tokens as logged-out strictly on the client-side but maintain backend server-side validity.", "Delete the session cookie completely but leave the server session active as an optimization cache."], e:"OWASP recommends securely invalidating server-side sessions and tokens immediately upon logout."},
    {c:"A07 Authentication Failures", q:"According to OWASP, what role does a credential recovery process play in A07?", a:"A weak recovery process such as knowledge-based answers completely undermines authentication.", d:["Recovery processes have absolutely no impact on authentication security when MFA is fully enabled.", "Recovery processes only genuinely matter for administrative accounts, not for regular user accounts.", "Recovery processes are entirely outside the scope of A07 and strictly belong under Insecure Design."], e:"OWASP notes that weak credential recovery (e.g., knowledge-based questions) directly bypasses strong authentication."},

    // --- A08: SOFTWARE OR DATA INTEGRITY FAILURES (12) ---
    {c:"A08 Integrity Failures", q:"Which scenario perfectly exemplifies a Software or Data Integrity Failure?", a:"An application actively accepts unverified, serialized objects from an untrusted origin.", d:["An application inadvertently displays extensive SQL stack traces to standard end users.", "An application fails to implement secure rate limiting on its primary login interface.", "An application strictly utilizes HTTP instead of HTTPS for transferring sensitive data."], e:"Accepting serialized objects without verifying their integrity is a textbook data integrity failure (formerly Insecure Deserialization)."},
    {c:"A08 Integrity Failures", q:"What precise mechanism helps mitigate data integrity failures during software updates?", a:"Ensuring all downloaded artifacts and update payloads possess valid digital signatures.", d:["Implementing a comprehensive deny-list to block all known malicious payload strings.", "Storing all temporary application update files within a highly restricted directory.", "Relying exclusively upon automated dynamic application security testing mechanisms."], e:"Digital signatures provide cryptographically verifiable proof that a software update or artifact has not been tampered with."},
    {c:"A08 Integrity Failures", q:"Why is insecure deserialization appropriately grouped under the A08:2025 category?", a:"Because the application assumes the serialized data's integrity without checking it.", d:["Because deserialization inherently requires highly complex cryptographic key exchanges.", "Because it directly involves the misconfiguration of cloud infrastructure access policies.", "Because it typically allows malicious scripts to execute directly inside the user's browser."], e:"Insecure deserialization occurs when an application trusts that serialized data hasn't been maliciously modified (an integrity assumption)."},
    {c:"A08 Integrity Failures", q:"How exactly can CI/CD pipelines introduce critical integrity failures into a system?", a:"Through unauthorized modifications to the codebase or deployment configurations.", d:["By failing to adequately encrypt data transmissions between standard user web browsers.", "By incorrectly defining the underlying relationship schemas inside a relational database.", "By automatically generating detailed error logs that are accessible to the public internet."], e:"If a CI/CD pipeline lacks integrity controls, attackers can inject malicious code directly into the build and deployment process."},
    {c:"A08 Integrity Failures", q:"What is the primary focus of A08 Software and Data Integrity Failures?", a:"Failures to actively verify the strict integrity of software updates, data, and CI/CD pipelines.", d:["Failures to natively encrypt sensitive data at rest utilizing modern cryptographic algorithms.", "Failures to properly authenticate distinct users during the standard login and session process.", "Failures to aggressively sanitize user input before passing it to relational database query engines."], e:"A08 focuses on making assumptions about software updates, critical data, and CI/CD pipelines without verifying their integrity."},
    {c:"A08 Integrity Failures", q:"What does OWASP strictly say about using serialized objects from untrusted sources?", a:"Do not ever accept serialized objects from untrusted sources or use serialization-only formats.", d:["Accept serialized objects from any origin as long as the underlying data schema is technically valid.", "Use serialized objects quite freely when they are transmitted over an encrypted TLS connection.", "Allow serialized objects from untrusted sources only after securely Base64 decoding them first."], e:"OWASP recommends not accepting serialized objects from untrusted sources as a primary prevention mechanism for A08."},
    {c:"A08 Integrity Failures", q:"OWASP recommends what foundational approach for CI/CD pipeline security under A08?", a:"Ensure all CI/CD pipelines possess proper access control, segmentation, and secure configuration.", d:["Allow all senior developers full administrative access to CI/CD pipelines to maximize productivity.", "Run CI/CD pipelines entirely without access controls to completely avoid any deployment delays.", "Configure CI/CD pipelines identically to local development environments for architectural simplicity."], e:"OWASP recommends proper segregation, secure configuration, and strict access control across CI/CD pipelines."},
    {c:"A08 Integrity Failures", q:"What does OWASP recommend regarding integrity verification specifically for serialized data?", a:"Implement robust integrity checks such as digital signatures on all transmitted serialized data.", d:["Rely upon transport-layer encryption alone to effectively protect serialized data integrity in transit.", "Skip integrity checks for serialized data whenever it is exchanged between internal microservices.", "Use basic checksum verification solely for serialized data payloads larger than one full megabyte."], e:"OWASP recommends digital signatures or similar cryptographic integrity checks on serialized data to prevent tampering."},
    {c:"A08 Integrity Failures", q:"What does OWASP strongly warn about regarding the use of libraries from public repositories?", a:"Ensure you are absolutely never sending unverified updates to clients without strict integrity verification.", d:["Public repositories are fundamentally trustworthy and require absolutely no additional internal verification.", "Only utilize libraries from public repositories if they were officially published within the last calendar year.", "Always prefer libraries from public repositories over internal private ones for vastly better community support."], e:"OWASP warns about blindly trusting public repositories and sending unverified software updates to end clients."},
    {c:"A08 Integrity Failures", q:"What type of formal review does OWASP explicitly recommend for code and configuration changes?", a:"Rigorous review of changes to heavily minimize the chance that malicious code or configuration is introduced.", d:["Allowing all code changes to be merged entirely automatically to maintain extremely high deployment velocity.", "Reviewing strictly only code changes originating from external contributors, ignoring internal team members.", "Restricting intensive reviews to formal annual audits rather than reviewing each individual developer change."], e:"OWASP recommends consistently reviewing code and configuration changes to prevent the introduction of malicious content."},
    {c:"A08 Integrity Failures", q:"OWASP mentions which massive real-world incident as a textbook example of an A08 failure?", a:"The SolarWinds Orion supply chain compromise that critically affected thousands of massive organizations.", d:["The Equifax data breach natively caused by a deeply unpatched Apache Struts vulnerability back in 2017.", "The Heartbleed OpenSSL vulnerability that silently leaked highly sensitive server memory contents in 2014.", "The WannaCry ransomware worm that aggressively exploited the well-known EternalBlue SMB vulnerability."], e:"OWASP references the SolarWinds Orion attack as a premier example of a catastrophic software integrity failure."},
    {c:"A08 Integrity Failures", q:"What does OWASP strictly say about unsigned or unencrypted serialized data sent to untrusted clients?", a:"It creates a critical integrity failure — always apply cryptographic signing or robust integrity controls.", d:["It remains perfectly safe because the client cannot easily modify backend data it does not natively understand.", "It is fully acceptable for non-sensitive system data such as customizable user interface preference settings.", "It is natively mitigated by standard TLS encryption of the network transport layer during data transit."], e:"OWASP warns that sending unsigned/unencrypted serialized data to untrusted clients is a direct integrity failure."},

    // --- A09: SECURITY LOGGING AND ALERTING FAILURES (12) ---
    {c:"A09 Logging Failures", q:"What was A09 designated as in the previous 2021 edition of the OWASP Top 10?", a:"Security Logging and Monitoring Failures; the term 'Monitoring' was changed to 'Alerting'.", d:["Security Auditing and Forensics Failures; the term 'Forensics' was changed to 'Alerting'.", "Security Logging and Response Failures; the term 'Response' was changed to 'Alerting'.", "Security Telemetry and Monitoring Failures; the term 'Telemetry' was changed to 'Logging'."], e:"In 2025, the category was renamed to Security Logging and Alerting Failures to emphasize the need for proactive alerting."},
    {c:"A09 Logging Failures", q:"Why are Security Logging and Alerting Failures considered so incredibly critical?", a:"They allow active, ongoing attacks to go completely undetected for extended periods.", d:["They inherently allow malicious users to bypass complex cryptographic encryptions.", "They directly grant attackers the ability to execute remote shell commands at will.", "They intentionally corrupt backend relational database structures beyond any repair."], e:"Without proper logging and alerting, attackers can persist in an environment for months without the defenders noticing."},
    {c:"A09 Logging Failures", q:"What is a highly recommended best practice for secure application event logging?", a:"Ensuring logs are continuously sent to a centralized, secure log management platform.", d:["Storing log files locally on the specific web server to maximize system performance.", "Retaining extensive log entries indefinitely without implementing any archiving strategy.", "Allowing standard users the ability to review and delete their own personal log records."], e:"Centralized log management (like a SIEM) ensures logs are protected from tampering and can be effectively analyzed."},
    {c:"A09 Logging Failures", q:"What specific type of data should absolutely never be included in application logs?", a:"Plaintext authentication passwords, session tokens, or sensitive personal health data.", d:["The precise geographical IP addresses of users attempting to access the application.", "The comprehensive timestamps indicating exactly when specific system errors occurred.", "The generic HTTP response status codes returned by the server during regular operations."], e:"Logging sensitive data like passwords or health records violates privacy laws and creates a massive security exposure if logs are compromised."},
    {c:"A09 Logging Failures", q:"Which of the following does OWASP consider a definitive logging failure under A09?", a:"Login failures and high-value financial transactions not being logged with sufficient context.", d:["Logging all incoming HTTP requests including the full request and response body payload content.", "Logging user session IDs entirely alongside every authentication event for comprehensive audit trails.", "Logging highly detailed stack traces within production error responses natively returned to end users."], e:"Not logging logins, failed logins, and high-value transactions is explicitly a logging failure under A09."},
    {c:"A09 Logging Failures", q:"What does OWASP strictly recommend regarding extensive log data encoding and validation?", a:"Encode and validate log data to fully prevent injection and forgery in backend log management systems.", d:["Store all logs as raw unencoded plaintext to heavily simplify manual search and backend grep operations.", "Compress all log entries utilizing standard gzip compression before writing to reduce disk consumption.", "Encrypt individual log entries exclusively so that only senior SIEM administrators can physically read them."], e:"OWASP recommends encoding log data correctly to prevent log injection and log forgery attacks on the SIEM."},
    {c:"A09 Logging Failures", q:"According to OWASP, what should happen immediately when application logs detect suspicious activity?", a:"High-priority alerting systems should be triggered so response teams can aggressively act in near real-time.", d:["Detailed log entries should be securely archived for formal review during the next quarterly audit cycle.", "Suspicious activity should be silently and safely recorded without ever notifying any security personnel.", "The application should automatically and permanently block the user without logging the specific event."], e:"OWASP recommends effective alerting so that suspicious activities are detected and responded to in a timely fashion."},
    {c:"A09 Logging Failures", q:"OWASP explicitly recommends what specific foundational approach for high-value transactions?", a:"Create robust audit trails with append-only integrity controls to thoroughly prevent subsequent tampering.", d:["Store vital audit data directly within the exact same mutable table as the primary transaction records.", "Allow secure audit records to be safely updated by administrators for routine operational corrections.", "Keep formal audit trails completely optional for standard transactions strictly below a certain dollar amount."], e:"OWASP recommends audit trails with integrity controls (append-only) for high-value transactions."},
    {c:"A09 Logging Failures", q:"What does OWASP strongly recommend regarding penetration testing activities and active logging?", a:"Ensure that application logging is sufficient for penetration test findings to be comprehensively understood.", d:["Disable all application logging immediately during penetration tests to strictly avoid polluting audit records.", "Penetration testers should absolutely never review system logs as it is always outside their testing scope.", "Logging verbosity levels should be heavily reduced during active testing to vastly improve application performance."], e:"OWASP recommends ensuring sufficient logging for penetration testers to understand the impact of findings."},
    {c:"A09 Logging Failures", q:"According to OWASP, where should sensitive application logs absolutely NOT be exclusively stored?", a:"Only on the local server — logs should universally be sent to centralized, secure log management systems.", d:["In a heavily centralized SIEM system that aggregates logs from absolutely all running application servers.", "In append-only secure cloud storage featuring immutable data retention policies correctly configured.", "In a heavily dedicated logging database with strict role-based access control aggressively enforced."], e:"OWASP warns against storing logs only locally, recommending centralized log management solutions to prevent attacker wiping."},
    {c:"A09 Logging Failures", q:"What does OWASP critically say about establishing monitoring and alerting thresholds?", a:"Establish highly effective monitoring and alerting so suspicious activity is consistently detected quite quickly.", d:["Set alerting thresholds as incredibly high as natively possible to essentially avoid generating any false positives.", "Disable strict alerting completely for non-production environments to greatly reduce developer notification fatigue.", "Configure all system alerts to trigger only strictly after regular business hours for the internal operations team review."], e:"OWASP recommends effective monitoring and alerting with appropriate thresholds for timely incident detection."},
    {c:"A09 Logging Failures", q:"What does OWASP highly recommend for formal incident response related specifically to A09?", a:"Establish or adopt a comprehensive incident response and recovery plan modeled on NIST 800-61r2 guidelines.", d:["Create an entirely new incident response plan completely from scratch without referencing any existing standards.", "Defer comprehensive incident response planning entirely until strictly after the very first security breach occurs.", "Outsource absolutely all incident response exclusively to a third party with absolutely no internal capability maintained."], e:"OWASP recommends establishing or adopting an incident response plan, explicitly referencing NIST 800-61r2."},

    // --- A10: MISHANDLING OF EXCEPTIONAL CONDITIONS (12) ---
    {c:"A10 Exceptional Conditions", q:"What is the primary focus of the new A10:2025 Mishandling of Exceptional Conditions?", a:"Unsafe system error handling, failing open, and a general lack of overall resilience.", d:["The complete inability to correctly configure basic cloud infrastructure access permissions.", "The utilization of outdated, highly vulnerable third-party components within the application.", "The unintentional exposure of sensitive data transmitted entirely over unencrypted channels."], e:"A10 focuses on how applications behave during errors or edge cases, emphasizing secure failure and resilience."},
    {c:"A10 Exceptional Conditions", q:"Which Common Weakness Enumeration is highly notable in the new A10:2025 category?", a:"CWE-636: Not Failing Securely, which is more commonly known as system 'Failing Open'.", d:["CWE-89: Improper Neutralization of Special Elements utilized within SQL Commands.", "CWE-352: Cross-Site Request Forgery allowing unauthorized state-changing actions.", "CWE-502: Deserialization of Untrusted Data originating from External User Input."], e:"CWE-636 (Failing Open) occurs when an application encounters an error and defaults to granting access rather than denying it."},
    {c:"A10 Exceptional Conditions", q:"What specific attack vector is very commonly enabled by mishandled system exceptions?", a:"Applications crashing unexpectedly and subsequently exposing sensitive stack traces.", d:["Applications encrypting data automatically utilizing deprecated cryptographic algorithms.", "Applications rendering untrusted HTML code directly within the user's internet browser.", "Applications granting administrative privileges silently to newly registered user accounts."], e:"Unhandled exceptions frequently result in the application crashing and dumping sensitive internal stack traces to the user."},
    {c:"A10 Exceptional Conditions", q:"How does OWASP explicitly recommend handling exceptional system conditions securely?", a:"Ensure the application fails securely, universally defaulting to a denied access state.", d:["Ensure the application ignores the exception entirely and attempts to continue executing.", "Ensure the application immediately restarts the backend server to resolve the condition.", "Ensure the application automatically grants access temporarily to prevent user frustration."], e:"Applications should 'fail closed', meaning that if a security check or critical function fails, access is securely denied."},
    {c:"A10 Exceptional Conditions", q:"Which precise scenario represents a critical mishandling of an exceptional condition?", a:"A backend database timeout causes the authorization check to automatically approve access.", d:["A highly predictable session identifier allows an attacker to easily hijack a user session.", "An application incorporates a vulnerable third-party logging library into its build process.", "An attacker successfully modifies a URL parameter to view another customer's invoice data."], e:"A database timeout causing the system to 'fail open' and grant access is the exact definition of mishandling an exceptional condition."},
    {c:"A10 Exceptional Conditions", q:"Why exactly was A10 Mishandling of Exceptional Conditions newly introduced in 2025?", a:"Complex modern applications often behave unpredictably and insecurely during edge cases.", d:["Traditional SQL injection attacks have become entirely obsolete in modern web development.", "Cryptographic standards have weakened significantly, requiring a completely new category.", "Cloud infrastructure providers mandated specific compliance regulations regarding error states."], e:"Modern systems are highly complex, and when they encounter unexpected states or edge cases, they frequently fail in insecure ways."},
    {c:"A10 Exceptional Conditions", q:"What does OWASP state is a primary cause of an application 'failing open'?", a:"Improperly tested fallback logic that prioritizes system availability over system security.", d:["Applying excessively strict web application firewall rules that natively block legitimate traffic.", "Storing user passwords utilizing incredibly fast, general-purpose cryptographic hash algorithms.", "Failing to regularly update foundational operating system components running on the server."], e:"When fallback logic prioritizes availability over security, errors in access checks often result in the system failing open."},
    {c:"A10 Exceptional Conditions", q:"Which architectural pattern does OWASP recommend to mitigate exceptional condition failures?", a:"Implementing robust resilience patterns such as circuit breakers and proper bulkheads.", d:["Deploying all backend microservices entirely onto a single, highly powerful monolithic server.", "Caching all sensitive database queries indefinitely to massively reduce load on the backend.", "Utilizing strictly asymmetric cryptography for absolutely all internal backend communications."], e:"Resilience patterns like circuit breakers prevent cascading failures and unpredictable states during exceptional conditions."},
    {c:"A10 Exceptional Conditions", q:"What is the fundamental difference between A10 Exceptional Conditions and A05 Security Misconfiguration?", a:"A10 involves runtime logic flaws during errors, while A05 involves static environmental setup issues.", d:["A10 strictly deals with network-level perimeter firewalls, while A05 strictly deals with application code.", "A10 is entirely exclusive to legacy on-premise servers, while A05 is completely exclusive to cloud hosting.", "A10 requires physical hardware access to successfully exploit, while A05 can be rapidly exploited remotely."], e:"A10 deals with how the application's code and logic respond to unpredictable runtime states, not static configuration."},
    {c:"A10 Exceptional Conditions", q:"How can aggressive, unhandled timeouts lead to a severe A10 vulnerability?", a:"If a critical security service times out, the application might blindly proceed without verification.", d:["Timeouts frequently cause the backend database to automatically corrupt all natively stored data.", "Timeouts force the application server to natively disable all transport layer encryption protocols.", "Timeouts allow remote attackers to directly read the underlying operating system file architecture."], e:"If an authorization or validation service times out and the application does not fail closed, it blindly bypasses the check."},
    {c:"A10 Exceptional Conditions", q:"Which testing methodology is highly recommended to uncover A10:2025 vulnerabilities?", a:"Chaos engineering and negative testing specifically aimed at generating unexpected system states.", d:["Standard automated static code analysis scanning primarily looking for known insecure syntax patterns.", "Basic network port scanning strictly designed to identify undocumented open services on the host.", "Routine compliance auditing focused entirely on verifying standardized data retention policies."], e:"Chaos engineering and negative testing are crucial for intentionally triggering edge cases to see how the system handles exceptions."},
    {c:"A10 Exceptional Conditions", q:"What role does proper logging play specifically in mitigating A10 Exceptional Conditions?", a:"It guarantees that edge cases and unexpected states are recorded for subsequent architectural review.", d:["It actively and automatically patches the underlying vulnerability immediately upon first detection.", "It physically prevents the application from returning detailed stack traces directly to the end user.", "It inherently encrypts the resulting error state to completely shield it from any external observation."], e:"Properly logging exceptions allows teams to identify unstable edge cases and improve the system's resilience architecture."}
];

// --- QUIZ LOGIC ---
const MASTER_POOL = pool_part_1.concat(pool_part_2);
let examQs = [], userAns = {}, flagged = {}, curr = 0, answered = {};

function initExam() {
    let pool = [...MASTER_POOL];
    for (let i = pool.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [pool[i], pool[j]] = [pool[j], pool[i]];
    }
    // Select all 120 questions
    examQs = pool.slice(0, 120);
    userAns = {}; flagged = {}; answered = {}; curr = 0;

    // Pre-shuffle options for each question
    examQs.forEach((q, i) => {
        let opts = [q.a, ...q.d];
        for (let j = opts.length - 1; j > 0; j--) {
            const k = Math.floor(Math.random() * (j + 1));
            [opts[j], opts[k]] = [opts[k], opts[j]];
        }
        examQs[i]._opts = opts;
    });

    document.getElementById('start-screen').style.display='none';
    document.getElementById('results-screen').style.display='none';
    document.getElementById('exam-ui').style.display='flex';
    document.getElementById('footer').style.display='flex';

    renderSide(); loadQ(0); updateProgress();
}

function updateProgress() {
    const cnt = Object.keys(answered).length;
    document.getElementById('progress-display').innerText = `${cnt} / 120`;
    document.getElementById('finish-btn').style.display = cnt === 120 ? 'inline-block' : 'none';
}

function renderSide() {
    const sb = document.getElementById('sidebar'); sb.innerHTML='';
    examQs.forEach((q,i) => {
        const b = document.createElement('button');
        b.className = 'nav-btn'; b.innerText = i+1;
        b.id = `nav-${i}`; b.onclick = () => loadQ(i);
        sb.appendChild(b);
    });
}

function loadQ(i) {
    curr = i;
    const q = examQs[i];

    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
    document.getElementById(`nav-${i}`).classList.add('active');
    document.getElementById('status').innerText = `Q ${i+1} / 120`;

    const con = document.getElementById('question-container'); con.innerHTML='';
    const card = document.createElement('div'); card.className='card';

    let html = `<div class="q-meta"><span class="tag">${q.c}</span><span class="q-num">#${i+1}</span></div><div class="q-text">${q.q}</div>`;

    const isAnswered = answered[i] !== undefined;

    q._opts.forEach((o, oi) => {
        let cls = 'option';
        if (isAnswered) {
            cls += ' locked';
            if (o === q.a) cls += ' opt-correct';
            else if (o === userAns[i]) cls += ' opt-wrong';
            else cls += ' opt-dim';
        }
        const clickHandler = isAnswered ? '' : `onclick="ans(${i}, ${oi})"`;
        html += `<div class="${cls}" ${clickHandler}>${o}</div>`;
    });

    if (isAnswered) {
        const wasCorrect = userAns[i] === q.a;
        html += `<div class="explanation-box"><strong>${wasCorrect ? '✓ Correct' : '✗ Incorrect'}</strong><br>${q.e}</div>`;
        if (i < 119) {
            html += `<div class="next-btn-wrap"><button class="btn btn-p" onclick="loadQ(${i+1})">Next Question →</button></div>`;
        }
    }

    card.innerHTML = html; con.appendChild(card);
    con.scrollTop = 0;
}

function ans(qi, optIdx) {
    const q = examQs[qi];
    userAns[qi] = q._opts[optIdx];
    answered[qi] = true;

    const navBtn = document.getElementById(`nav-${qi}`);
    if (userAns[qi] === q.a) {
        navBtn.classList.add('answered-correct');
    } else {
        navBtn.classList.add('answered-wrong');
    }

    loadQ(qi);
    updateProgress();
}

function nav(d) {
    const n = curr + d;
    if(n >= 0 && n < 120) loadQ(n);
}

function flag() {
    flagged[curr] = !flagged[curr];
    const b = document.getElementById(`nav-${curr}`);
    if(flagged[curr]) b.classList.add('flagged'); else b.classList.remove('flagged');
}

function finish() {
    if(!confirm('Finish the quiz and see your results?')) return;
    document.getElementById('exam-ui').style.display='none';
    document.getElementById('footer').style.display='none';

    const resScreen = document.getElementById('results-screen');
    resScreen.style.display='block';
    resScreen.scrollTop = 0;

    let score = 0;
    let html = '';

    examQs.forEach((q, i) => {
        const correct = userAns[i] === q.a;
        if(correct) score++;
        html += `<div class="review-item ${correct?'correct':'wrong'}">
            <strong>Q${i+1} [${q.c}]: ${q.q}</strong><br>
            Your Answer: <b style="color:${correct?'#3fb950':'#ff7b72'}">${userAns[i]||'Skipped'}</b><br>
            ${!correct ? `Correct Answer: <b style="color:#3fb950">${q.a}</b>` : ''}
            <div class="review-explanation">Rationale: ${q.e}</div>
        </div>`;
    });

    const pct = Math.round((score/120)*100);

    document.getElementById('score-circle').innerText = `${pct}%`;
    document.getElementById('raw-score').innerText = `You answered ${score} out of 120 questions correctly.`;
    document.getElementById('review-list').innerHTML = html;
}
</script>
</body>
</html>
</script>