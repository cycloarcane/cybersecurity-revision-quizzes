const MASTER_POOL = [
    // ===== A: CORE TECHNICAL SKILLS (12 questions) =====
    {c:"Core Technical Skills", q:"During an infrastructure penetration test, you run an Nmap SYN scan against a target and receive no response on a particular port. What is the most accurate interpretation of this result?", a:"The port is likely filtered by a firewall that is silently dropping the SYN packets.", d:["The port is definitively closed and the service behind it is not running at all.", "The host is offline and not responding to any type of network traffic at all.", "The port is open but the service is configured to ignore SYN-only packets."], e:"When Nmap receives no response to a SYN probe, it marks the port as 'filtered'. A closed port would return a RST/ACK. No response typically indicates a firewall is silently dropping the packet."},
    {c:"Core Technical Skills", q:"You need to fingerprint a remote operating system without sending any packets to the target. Which technique should you use?", a:"Passive OS fingerprinting by analysing network traffic characteristics like TTL and window size.", d:["Active OS fingerprinting using Nmap's -O flag to send specially crafted TCP/IP probe packets.", "Banner grabbing by connecting to open services and reading the version strings that are returned.", "Running a vulnerability scan with authenticated credentials to read system information remotely."], e:"Passive OS fingerprinting analyses existing network traffic (e.g. using p0f) to determine the OS from TCP/IP stack characteristics like default TTL, window size, and DF bit settings without generating any traffic."},
    {c:"Core Technical Skills", q:"An Nmap scan returns a port as 'open|filtered'. Which scan type most commonly produces this ambiguous result?", a:"A UDP scan, because the lack of response from a UDP port cannot distinguish open from filtered.", d:["A TCP SYN scan, because some firewalls respond to SYN probes with ambiguous flag combinations.", "A TCP Connect scan, because incomplete handshakes can leave the port state undetermined.", "A TCP ACK scan, because the ACK flag alone cannot determine whether a port is listening or not."], e:"UDP scans commonly return 'open|filtered' because an open UDP port may simply not respond, and a filtered port also produces no response. Nmap cannot distinguish between the two without additional probing."},
    {c:"Core Technical Skills", q:"You discover a service running on an unusual port that returns no recognisable banner. What is the most effective next step?", a:"Use Nmap's service version detection (-sV) to probe the port with protocol-specific handshakes.", d:["Assume the service is a custom application and skip it to focus on standard well-known ports.", "Run a full vulnerability scan against the port using default plugin sets to identify the service.", "Perform a TCP traceroute to the port to determine what type of device is hosting the service."], e:"Nmap's -sV flag sends protocol-specific probes to elicit responses that can identify the service. This is the standard approach for evaluating unknown services per the CRT syllabus requirement for 'evaluation of unknown services'."},
    {c:"Core Technical Skills", q:"What is the primary difference between Nmap's -sS (SYN) scan and -sT (Connect) scan?", a:"A SYN scan sends a RST after receiving SYN-ACK, never completing the three-way handshake.", d:["A SYN scan uses raw ICMP packets instead of TCP, making it faster but less reliable overall.", "A Connect scan requires root privileges while a SYN scan can be run as an unprivileged user.", "A SYN scan only works against TCP services, whereas Connect scan also works against UDP services."], e:"SYN scan sends SYN, receives SYN-ACK (port open) or RST (closed), then sends RST to tear down without completing the handshake. Connect scan completes the full three-way handshake via the OS TCP stack. SYN scan requires root/raw socket privileges."},
    {c:"Core Technical Skills", q:"During a penetration test, you capture traffic using tcpdump and save it for later analysis. What file format should you save it in for maximum tool compatibility?", a:"PCAP format, which is the standard capture format supported by Wireshark and most analysis tools.", d:["CSV format, which allows easy import into spreadsheet applications for manual traffic review.", "JSON format, which provides structured output compatible with modern SIEM and logging platforms.", "XML format, which enables parsing by automated vulnerability scanning and correlation engines."], e:"PCAP (Packet Capture) is the de facto standard format for network traffic capture. It is supported by tcpdump, Wireshark, tshark, and virtually all network analysis tools. The CRT syllabus specifically references PCAP file analysis."},
    {c:"Core Technical Skills", q:"You run an Nmap XMAS scan (-sX) against a target. What TCP flags does this scan type set?", a:"FIN, PSH, and URG flags are all set simultaneously in the outgoing probe packet.", d:["SYN, FIN, and RST flags are all set simultaneously to confuse stateful firewall inspection.", "ACK and FIN flags are set to probe whether the port is filtered by a stateless packet filter.", "Only the URG flag is set to trigger a response from services that process urgent data pointers."], e:"An XMAS scan sets the FIN, PSH, and URG flags simultaneously (hence 'lit up like a Christmas tree'). Per RFC 793, a closed port should respond with RST while an open port should drop the packet silently."},
    {c:"Core Technical Skills", q:"Which Nmap scan technique is most effective for determining whether a stateless packet filter is in place?", a:"A TCP ACK scan (-sA), which checks if ACK packets pass through to determine filtering rules.", d:["A TCP SYN scan (-sS), which identifies open ports by sending standard connection initiation requests.", "A UDP scan (-sU), which tests for firewall rules by sending empty UDP datagrams to target ports.", "A TCP FIN scan (-sF), which bypasses all types of firewalls by using an unexpected TCP flag value."], e:"The ACK scan is specifically designed to map firewall rulesets. It sends ACK packets (which don't initiate connections) and analyses whether they are dropped (filtered) or receive RST responses (unfiltered)."},
    {c:"Core Technical Skills", q:"You need to perform a ping sweep of a /24 network to identify live hosts, but ICMP echo requests are being blocked. What alternative technique would you use?", a:"TCP SYN or ACK probes to common ports such as 80 and 443 to discover live hosts.", d:["SNMP broadcast queries to the subnet to enumerate all devices with SNMP agents running.", "DNS reverse lookups for every IP in the range to identify hosts with registered PTR records.", "Sending fragmented ICMP packets to bypass the firewall rule blocking standard echo requests."], e:"When ICMP is blocked, TCP-based host discovery (e.g., Nmap's -PS and -PA options) sending SYN or ACK packets to common ports is the most reliable alternative for identifying live hosts on a network."},
    {c:"Core Technical Skills", q:"What does the Nmap --script=vuln option do during a penetration test?", a:"It executes NSE scripts categorised as vulnerability checks against the discovered services.", d:["It enables passive vulnerability detection by monitoring network traffic during the port scan.", "It performs an authenticated vulnerability scan using default credentials for each open service.", "It generates a formatted vulnerability report compatible with common reporting frameworks."], e:"The --script=vuln flag runs Nmap Scripting Engine (NSE) scripts in the 'vuln' category, which test for specific known vulnerabilities. This is distinct from full vulnerability scanners but provides quick targeted checks during enumeration."},
    {c:"Core Technical Skills", q:"You find a target with Nmap showing port 8443 open but the service is listed as 'unknown'. After connecting with netcat, you see an HTTP/1.1 response. What does this tell you?", a:"The service is an HTTPS or HTTP server on a non-standard port that Nmap's probes did not identify.", d:["The target is running a proxy server that forwards all connections to a backend HTTP web server.", "The port is being used for a tunnelled SSH connection that mimics HTTP headers in its banner.", "The service is a network management console that only responds to GET requests over plaintext."], e:"HTTP responses on non-standard ports (like 8443) are very common for web management interfaces, API servers, and alternate HTTPS endpoints. Manual investigation with netcat or curl confirms the protocol when automated detection fails."},
    {c:"Core Technical Skills", q:"During a network assessment, you want to identify all FTP servers on a target /16 network as quickly as possible. Which approach is most efficient?", a:"Run a targeted Nmap SYN scan on port 21 across the entire range with increased parallelism.", d:["Perform a full 65535-port scan of every host first, then filter the results for port 21 entries.", "Use passive network sniffing to wait for FTP traffic to appear on the network over several hours.", "Query the organisation's DNS servers for all PTR records and connect to each host individually."], e:"A targeted SYN scan on a single port (21) across a large range is the fastest approach. Scanning all ports on all hosts would be extremely slow. The CRT syllabus requires candidates to 'accurately identify all hosts that meet a defined set of criteria'."},

    // ===== B: INFORMATION GATHERING & RECONNAISSANCE (10 questions) =====
    {c:"Reconnaissance", q:"During a DNS reconnaissance, you attempt a zone transfer against a target domain's name server and it succeeds. What type of information would you expect to obtain?", a:"A complete listing of all DNS records for the domain, including hostnames and IP address mappings.", d:["Only the SOA record and the authoritative name server addresses for the target domain zone.", "The internal DHCP lease table showing all dynamically assigned IP addresses on the network.", "The firewall ruleset for the DNS server, including permitted inbound and outbound port ranges."], e:"A successful DNS zone transfer (AXFR) returns all records in the zone file, including A, AAAA, CNAME, MX, NS, TXT, PTR records, and more. This can reveal internal hostnames, IP addresses, and network structure."},
    {c:"Reconnaissance", q:"You discover a CNAME record pointing to an S3 bucket that returns a 'NoSuchBucket' error. What vulnerability does this indicate?", a:"A dangling DNS entry that is susceptible to subdomain takeover by registering the missing bucket.", d:["A DNS cache poisoning vulnerability that allows redirection of the subdomain to any IP address.", "A misconfigured SSL certificate that prevents the browser from connecting to the intended resource.", "An expired domain name registration that allows the entire parent domain to be claimed by others."], e:"A dangling DNS entry occurs when a CNAME points to a resource that no longer exists. An attacker can claim the orphaned resource (e.g., create the S3 bucket) and serve arbitrary content under the victim's subdomain. This is explicitly covered in the CRT v2.0 syllabus."},
    {c:"Reconnaissance", q:"What information can be derived from a DNS TXT record that contains a SPF (Sender Policy Framework) entry?", a:"The IP addresses and domains authorised to send email on behalf of the organisation's domain.", d:["The internal mail server configuration including authentication credentials and relay permissions.", "The SSL certificate chain for the mail servers including intermediate certificate authority details.", "The geographic locations of all mail servers and their physical hosting facility addresses."], e:"SPF records in DNS TXT entries specify which IP addresses and domains are authorised to send email for that domain. This reveals infrastructure information about mail servers and third-party email services used by the organisation."},
    {c:"Reconnaissance", q:"You query a DNS server and obtain an HINFO record for a target host. What does this record type reveal?", a:"The host's hardware type and operating system, providing useful fingerprinting intelligence.", d:["The history of IP address changes for the host over the last twelve months of DNS records.", "The HTTP headers that the host returns when a web request is made to its primary service.", "The hierarchical position of the host within the organisation's Active Directory domain tree."], e:"HINFO (Host Information) records contain CPU type and operating system information. While rarely used in modern configurations due to security concerns, they provide direct fingerprinting data when present."},
    {c:"Reconnaissance", q:"During passive DNS monitoring of a target organisation, what type of intelligence are you primarily gathering?", a:"Historical DNS resolution data showing which domains resolved to which IP addresses over time.", d:["Real-time interception of DNS queries from internal users to identify browsing patterns and habits.", "Active enumeration of all subdomains by brute-forcing common hostname prefixes against the server.", "Direct modification of DNS cache entries to redirect traffic during the reconnaissance phase."], e:"Passive DNS monitoring collects historical DNS resolution data from various vantage points without directly querying the target. This reveals infrastructure changes, related domains, and historical IP address associations."},
    {c:"Reconnaissance", q:"What is the primary purpose of querying DNS SRV records during a penetration test?", a:"To discover specific services, their hostnames, port numbers, and priority within the domain.", d:["To retrieve the SSL certificates associated with each service running on the target's domain.", "To enumerate all user accounts that are authorised to access each service on the network.", "To identify which DNS server is the primary authority for the zone and initiate a transfer."], e:"SRV (Service) records specify the hostname, port, priority, and weight of servers providing specific services (e.g., _ldap._tcp, _sip._tcp). They reveal what services the organisation runs and on which hosts."},
    {c:"Reconnaissance", q:"You find a DMARC policy in a DNS TXT record that reads 'v=DMARC1; p=none; rua=mailto:reports@example.com'. What does this indicate about the domain's email security?", a:"The domain monitors email authentication failures but does not reject or quarantine failing messages.", d:["The domain strictly rejects all emails that fail both SPF and DKIM authentication checks outright.", "The domain quarantines suspicious emails in a separate folder for administrator review before delivery.", "The domain has disabled all email authentication mechanisms and accepts messages from any sender."], e:"A DMARC policy of 'p=none' means the domain owner is only monitoring authentication results via reports (rua) but takes no action on emails that fail SPF/DKIM checks. This is a weak posture that allows spoofing. The CRT v2.0 syllabus explicitly includes DMARC in TXT record assessment."},
    {c:"Reconnaissance", q:"When performing DNS reconnaissance, you discover that the target's MX records point to 'mail.google.com'. What can you infer about the target?", a:"The organisation uses Google Workspace for email, meaning their mail infrastructure is cloud-hosted.", d:["The organisation runs its own mail server software that happens to be registered under Google's name.", "The organisation's email is being intercepted and routed through a Google security proxy appliance.", "The organisation has an expired MX record that is incorrectly pointing to a decommissioned server."], e:"MX records pointing to Google's mail servers indicate the organisation uses Google Workspace (formerly G Suite) for email. This reveals their email provider and suggests cloud adoption, which shifts the attack surface."},
    {c:"Reconnaissance", q:"What is the purpose of querying the DNS SOA record for a target domain?", a:"To identify the primary authoritative name server and the zone administrator's email contact.", d:["To discover all the subdomains and their corresponding IP addresses within the target domain.", "To retrieve the encryption keys used for securing DNS queries between the resolver and server.", "To determine the physical geographic location of the servers hosting the target domain's website."], e:"The SOA (Start of Authority) record contains the primary name server, the responsible party's email (encoded in DNS format), and zone timing parameters like serial number, refresh, retry, expire, and minimum TTL values."},
    {c:"Reconnaissance", q:"During reconnaissance, you perform reverse DNS lookups across a target's IP range and discover several PTR records with naming conventions like 'fw-01', 'vpn-gw', and 'dc-prod'. Why are these findings significant?", a:"They reveal the function of network hosts, mapping out infrastructure roles like firewalls and DCs.", d:["They confirm that all discovered hosts are directly accessible from the public internet via those IPs.", "They indicate the operating system running on each host, since PTR records encode platform information.", "They prove that the DNS server is vulnerable to zone transfers and will reveal all internal records."], e:"PTR record naming conventions often reveal the purpose of hosts (fw = firewall, vpn-gw = VPN gateway, dc = domain controller). This intelligence helps map the network architecture and prioritise targets during the assessment."},

    // ===== C: NETWORKS (15 questions) =====
    {c:"Networks", q:"You discover a network where hosts on VLAN 10 can communicate with hosts on VLAN 20 despite no router being configured between them. What is the most likely cause?", a:"A VLAN hopping attack is occurring, possibly through switch spoofing or double tagging of frames.", d:["The switch has failed and is operating in hub mode, broadcasting all frames to every physical port.", "Both VLANs are using the same IP subnet, so the switch is treating them as a single broadcast domain.", "A DNS misconfiguration is resolving hostnames across VLANs, allowing cross-VLAN name resolution."], e:"VLAN hopping via switch spoofing (negotiating a trunk link) or double-tagging (exploiting native VLAN handling) can allow frames to cross VLAN boundaries without a router. The CRT syllabus covers VLAN tagging security implications."},
    {c:"Networks", q:"On a switched network, you want to intercept traffic between two hosts that are not on your local segment. Which technique would be most effective?", a:"ARP spoofing to poison the ARP caches of both hosts so their traffic routes through your machine.", d:["Enabling promiscuous mode on your network interface to capture all packets on the physical segment.", "Configuring your machine as a DHCP server to assign yourself as the default gateway for the subnet.", "Sending ICMP redirect messages to both hosts instructing them to route traffic via your IP address."], e:"On a switched network, promiscuous mode alone won't capture traffic between other hosts. ARP spoofing (cache poisoning) tricks both hosts into sending traffic through the attacker's machine, enabling a man-in-the-middle position."},
    {c:"Networks", q:"What is the purpose of IEEE 802.1Q tagging in the context of network security assessments?", a:"It encapsulates VLAN membership information within Ethernet frames for trunk link communication.", d:["It provides encryption for all frames traversing the network to protect against passive sniffing.", "It authenticates network devices before allowing them to join the local area network segment.", "It limits the bandwidth available to each port to prevent denial-of-service flooding attacks."], e:"802.1Q inserts a 4-byte tag into Ethernet frames that identifies the VLAN membership of each frame. This is used on trunk links between switches. Understanding VLAN tagging is essential for VLAN hopping attacks and traffic analysis."},
    {c:"Networks", q:"You capture network traffic and observe frames with two 802.1Q tags. What type of attack could this represent?", a:"A double-tagging VLAN hopping attack where the outer tag is stripped by the first switch encountered.", d:["A legitimate trunk link carrying traffic for multiple VLANs between two properly configured switches.", "An ARP cache poisoning attack using modified Ethernet frames to redirect traffic between two hosts.", "A STP manipulation attack attempting to become the root bridge by injecting crafted BPDU frames."], e:"Double-tagging is a VLAN hopping technique where an attacker sends a frame with two 802.1Q tags. The first switch strips the outer tag (matching the native VLAN), and the inner tag causes the frame to be forwarded to the target VLAN."},
    {c:"Networks", q:"During a network assessment, you need to join a specific VLAN from your Linux attack machine. What must you configure?", a:"A virtual sub-interface tagged with the target VLAN ID using vconfig or the ip link command.", d:["A static ARP entry mapping your MAC address to the target VLAN's default gateway IP address.", "A custom firewall rule allowing your interface to accept frames from the specified VLAN number.", "A modified network driver that injects the VLAN ID into every outgoing Ethernet frame's payload."], e:"To join a specific VLAN from Linux, you create a tagged sub-interface (e.g., 'ip link add link eth0 name eth0.10 type vlan id 10'). The CRT syllabus requires candidates to 'connect to a specific VLAN given the VLAN ID from both Linux and Windows systems'."},
    {c:"Networks", q:"What information can be derived from analysing the TTL (Time to Live) value in captured IP packets?", a:"An estimate of the number of routing hops between the source and destination, and potential OS type.", d:["The exact geographic distance between the source and destination hosts measured in kilometres.", "The total bandwidth capacity of the network path from the source host to the destination server.", "The encryption algorithm being used to protect the payload data within the captured IP packets."], e:"Different operating systems use characteristic default TTL values (Linux: 64, Windows: 128, Cisco: 255). By comparing the received TTL with known defaults, you can estimate hop count and infer the source OS."},
    {c:"Networks", q:"You perform a traceroute to a target and notice that hops 5 through 7 return no response, but hop 8 responds. What does this most likely indicate?", a:"A firewall or router at those hops is configured to drop ICMP time-exceeded messages silently.", d:["The network path includes a VPN tunnel that encapsulates traffic, hiding three intermediate routers.", "Those three hops represent a single device with multiple interfaces that only responds on the last.", "The network segment between hops 4 and 8 is down and traffic is being routed via an alternate path."], e:"When traceroute hops show asterisks (timeouts), it typically means the intermediate devices are configured not to send ICMP Time Exceeded messages, often as a security measure. Traffic still passes through them as the subsequent hop responds."},
    {c:"Networks", q:"During a penetration test, you discover that the network uses DHCP. How can this be exploited to position yourself as a man-in-the-middle?", a:"Deploy a rogue DHCP server that assigns your machine's IP address as the default gateway to clients.", d:["Modify the legitimate DHCP server's configuration file to redirect all traffic through your host.", "Send DHCP RELEASE messages on behalf of all clients to force them to disconnect from the network.", "Use DHCP to assign duplicate IP addresses to the legitimate gateway, causing a network-wide outage."], e:"A rogue DHCP server can respond to DHCP Discover requests faster than the legitimate server, assigning the attacker's IP as the default gateway. All client traffic then routes through the attacker's machine."},
    {c:"Networks", q:"What is the significance of identifying a network using STP (Spanning Tree Protocol) during an assessment?", a:"An attacker could send crafted BPDUs to become the root bridge, redirecting network traffic flows.", d:["STP presence confirms the network uses VLANs, enabling VLAN hopping through double-tagging attacks.", "STP-enabled networks are immune to ARP spoofing because the protocol validates MAC address tables.", "STP automatically encrypts all inter-switch traffic, requiring the attacker to decrypt captured frames."], e:"STP determines the network topology by electing a root bridge. If an attacker sends superior BPDUs (with a lower bridge priority), they can become the root bridge and redirect traffic through their device for interception."},
    {c:"Networks", q:"You need to map a remote network and identify all routable subnets. Which combination of techniques would be most effective?", a:"Traceroute to multiple targets combined with SNMP queries and analysis of routing table information.", d:["Performing a port scan of every IP address in the entire private address range from your position.", "Running a vulnerability scanner in discovery mode with all default plugins enabled across the range.", "Sending broadcast pings to the 255.255.255.255 address and waiting for responses from all subnets."], e:"Traceroute reveals intermediate routers and subnet boundaries. SNMP queries (if community strings are known) can dump full routing tables. Together they provide the most complete network map, as required by the CRT syllabus."},
    {c:"Networks", q:"During a test, you observe TCP packets with the SYN flag set being sent to a host, but all responses have the RST and ACK flags set. What does this indicate?", a:"The destination ports being probed are all closed, with the host's TCP stack rejecting the connections.", d:["A stateful firewall is intercepting the connections and sending forged RST packets back to you.", "The target host is currently rebooting and its network stack is in an initialisation error state.", "The host is running an intrusion prevention system that terminates all inbound SYN connections."], e:"Per RFC 793, a host that receives a SYN on a closed port responds with RST/ACK. This is the standard TCP behaviour for closed ports and is how port scanners determine that a port is closed."},
    {c:"Networks", q:"What is the purpose of the TCP three-way handshake, and why is understanding it critical for penetration testing?", a:"It establishes a reliable TCP connection using SYN, SYN-ACK, and ACK packets in sequence.", d:["It negotiates the encryption parameters for the connection using a Diffie-Hellman key exchange.", "It authenticates both endpoints using mutual certificate verification before data transfer begins.", "It determines the maximum transmission unit for the path to prevent IP fragmentation issues."], e:"The three-way handshake (SYN → SYN-ACK → ACK) establishes TCP connections. Understanding it is fundamental to penetration testing because scan types (SYN, Connect, FIN) manipulate different stages of this handshake."},
    {c:"Networks", q:"You are analysing a PCAP file and notice a large number of ARP requests for the gateway IP originating from a single host with a different MAC. What is likely occurring?", a:"An ARP spoofing attack where the host is sending gratuitous ARP replies to hijack gateway traffic.", d:["The host is performing a legitimate ARP probe to verify that no IP address conflicts exist on the LAN.", "The network switch is flooding ARP requests because its CAM table has been overflowed by an attacker.", "A DHCP server is renewing leases and broadcasting updated MAC-to-IP mappings across the network."], e:"Repeated ARP messages claiming ownership of the gateway IP from an unexpected MAC address is the signature of ARP spoofing/cache poisoning. The attacker is trying to associate their MAC with the gateway's IP to intercept traffic."},
    {c:"Networks", q:"How can a penetration tester bypass network filtering that blocks outbound connections on non-standard ports?", a:"Tunnel exploitation traffic over allowed ports like 80, 443, or 53 using encapsulation or proxying.", d:["Modify the firewall rules directly to allow outbound traffic on the required port for the exploit.", "Use fragmented IP packets to split the TCP header across fragments so the port is not inspectable.", "Switch from TCP-based exploits to UDP-based exploits, as firewalls rarely filter outbound UDP traffic."], e:"Tunnelling over permitted ports (HTTP on 80, HTTPS on 443, DNS on 53) is a standard technique for bypassing egress filtering. Tools like Chisel, SSH tunnels, and DNS tunnelling allow penetration testers to route traffic through allowed channels."},
    {c:"Networks", q:"What security risk does LLMNR (Link-Local Multicast Name Resolution) present on a Windows network?", a:"An attacker can respond to LLMNR queries with their own IP, capturing NTLMv2 authentication hashes.", d:["LLMNR allows remote code execution on any host that has the protocol enabled in its network stack.", "LLMNR leaks the full Active Directory structure including all user accounts and group memberships.", "LLMNR provides unauthenticated access to network shares by bypassing SMB authentication entirely."], e:"LLMNR is a fallback name resolution protocol. When DNS resolution fails, Windows hosts broadcast LLMNR queries. An attacker can respond with their IP, causing the victim to send NTLMv2 authentication hashes that can be relayed or cracked offline."},

    // ===== D: NETWORK SERVICES (20 questions) =====
    {c:"Network Services", q:"You discover SNMP v1 running on a network device with the community string 'public'. What is the most significant risk this presents?", a:"Full read access to the device's MIB, exposing network configuration, routes, and interface details.", d:["Remote code execution on the device through a buffer overflow in the SNMPv1 protocol implementation.", "The ability to perform a denial of service attack by overwhelming the device with SNMP trap messages.", "Automatic propagation of malware to all other SNMP-enabled devices sharing the same community string."], e:"SNMPv1 with a known community string like 'public' allows full read access to the MIB tree, revealing system information, interface configurations, routing tables, and ARP caches. With 'private', write access enables configuration changes."},
    {c:"Network Services", q:"You find an NFS export configured as '/home *(rw,no_root_squash)'. Why is this particularly dangerous?", a:"Remote root users retain root privileges on the share, allowing creation of SUID binaries for escalation.", d:["The export is readable by any host but files are restricted to the owning user's permissions only.", "NFS traffic is encrypted but the key is derived from the export path, making it easy to decrypt.", "The wildcard means only hosts in the local subnet can mount the share with read-write permissions."], e:"no_root_squash means the remote root user maps to local root (UID 0) on the NFS server. An attacker can mount the share, create a SUID-root binary, then execute it on the target to gain root access. The CRT syllabus covers this explicitly."},
    {c:"Network Services", q:"An SMTP server responds to the VRFY command with '252 2.1.5 user@target.com'. What does this tell you?", a:"The mail server confirms the email address exists, enabling enumeration of valid user accounts.", d:["The server is an open relay that will forward email to any destination without authentication checks.", "The server uses TLS encryption for all SMTP connections and the certificate is valid and trusted.", "The server is rejecting the connection because your IP is listed on a DNS-based blackhole list."], e:"The SMTP VRFY command verifies whether a mailbox exists on the server. A positive response enables user enumeration. The CRT syllabus specifically covers 'valid username discovery via EXPN and VRFY' for SMTP."},
    {c:"Network Services", q:"You discover an SSH server accepting connections on the target. After fingerprinting, you determine it runs SSH protocol version 1. Why is this a significant finding?", a:"SSHv1 is vulnerable to man-in-the-middle attacks due to weak integrity checking in the protocol design.", d:["SSHv1 uses stronger encryption than SSHv2 but has a slower key exchange that can be timed out.", "SSHv1 only supports password authentication and cannot use public key or certificate-based methods.", "SSHv1 is immune to brute force attacks because it implements automatic account lockout after five tries."], e:"SSH protocol version 1 has fundamental cryptographic weaknesses including vulnerability to insertion attacks and MITM attacks. The CRT syllabus requires understanding of 'versions 1 and 2 of the SSH protocol' and their security implications."},
    {c:"Network Services", q:"During an assessment, you find SSH authorized_keys files with overly permissive entries. How can this be exploited?", a:"If you can write to a user's authorized_keys file, you can add your own public key for passwordless access.", d:["Authorized_keys files can be decoded to recover the private keys needed to authenticate as that user.", "The presence of authorized_keys means the SSH server will accept any connection without key validation.", "Overly permissive authorized_keys entries automatically grant sudo privileges to all authenticated users."], e:"The CRT syllabus covers exploitation of SSH trust relationships through 'the use, creation or modification of ~/.ssh/authorized_keys files'. Writing your public key into this file grants you access as that user without knowing their password."},
    {c:"Network Services", q:"You discover a TFTP service running on a Cisco device. What is the primary attack vector this presents?", a:"Downloading the device's configuration file, which may contain passwords and SNMP community strings.", d:["Exploiting a buffer overflow in the TFTP service to gain a remote shell on the networking device.", "Using TFTP to upload and execute arbitrary firmware that includes a persistent backdoor implant.", "Leveraging TFTP to perform a denial of service by filling the device's storage with large file uploads."], e:"TFTP provides no authentication. On Cisco devices, it is commonly used for configuration backup. An attacker can download configuration files that contain enable passwords (often type 7 encrypted, easily reversed) and SNMP community strings."},
    {c:"Network Services", q:"What is the security implication of discovering a Berkeley R-service (.rhosts) file containing '+ +'?", a:"It grants password-free access to every user from every host, completely bypassing authentication.", d:["It restricts access to only the root user from the localhost, following the principle of least privilege.", "It enables encrypted communication between trusted hosts using a pre-shared key in the file itself.", "It logs all remote access attempts to syslog but does not enforce any actual access control restrictions."], e:"In Berkeley R-services, '+ +' in .rhosts or /etc/hosts.equiv means 'any user from any host'. This grants password-free access to anyone, completely undermining authentication. The CRT syllabus covers impact of 'poorly-configured trust relationships'."},
    {c:"Network Services", q:"You find an X11 server with host-based access control enabled and no xhost restrictions. What can you do?", a:"Connect to the display remotely to capture screenshots, keystrokes, and inject commands into terminals.", d:["Execute arbitrary code on the server by exploiting a buffer overflow in the X11 display manager protocol.", "Modify the X11 configuration to install a persistent rootkit that survives system reboots completely.", "Access the file system of the X11 server through a directory traversal vulnerability in the protocol."], e:"X11 with permissive host-based access control allows remote users to connect to the display. An attacker can then capture screenshots (xwd), log keystrokes (xinput), and inject keystrokes into open terminal windows."},
    {c:"Network Services", q:"You discover RPC services running on a Linux target. After running rpcinfo, you identify mountd and nfsd. What should you do next?", a:"Enumerate NFS exports with showmount to identify shared directories and assess their access controls.", d:["Immediately attempt to exploit a known RPC buffer overflow vulnerability in the portmapper service.", "Run a brute-force attack against the RPC authentication mechanism to obtain valid user credentials.", "Ignore the RPC services as they are only used for internal communication and present no attack surface."], e:"When NFS-related RPC services (mountd, nfsd) are found, the next step is to enumerate exports using 'showmount -e target' to discover shared directories and check for misconfigured access controls that allow unauthorised mounting."},
    {c:"Network Services", q:"You find a web server running on a target device at port 443. The TLS configuration uses the RC4 cipher exclusively. Why is this a finding?", a:"RC4 has known biases and vulnerabilities that allow partial plaintext recovery from encrypted traffic.", d:["RC4 is a block cipher with a small key size that makes brute-force attacks computationally feasible.", "RC4 requires client-side certificates, which prevents standard browsers from connecting to the server.", "RC4 is an asymmetric encryption algorithm that exposes the server's private key during the handshake."], e:"RC4 is a stream cipher with known statistical biases. Attacks like NOMORE and Bar Mitzvah can recover plaintext. Modern TLS best practice requires disabling RC4 entirely in favour of AES-GCM or ChaCha20-Poly1305."},
    {c:"Network Services", q:"During testing, you capture LDAP traffic on port 389 and can read bind requests in cleartext. What is the security impact?", a:"User credentials including Distinguished Names and passwords are transmitted without encryption.", d:["LDAP queries are visible but bind credentials are always hashed before transmission on port 389.", "Only the LDAP directory structure is visible; authentication tokens are exchanged on a separate port.", "Cleartext LDAP only exposes the server's schema definition, not any actual directory entry contents."], e:"LDAP on port 389 without STARTTLS transmits everything in cleartext, including bind (authentication) requests containing usernames and passwords. This allows credential interception via network sniffing. LDAPS on port 636 provides encryption."},
    {c:"Network Services", q:"You identify an SMB share on a Windows server that allows anonymous access. What is the first thing you should enumerate?", a:"The share contents and permissions, along with user and group information via null session queries.", d:["The operating system kernel version to immediately search for a matching remote code execution exploit.", "The web server configuration by looking for IIS configuration files stored on the accessible share.", "The SNMP community strings by reading the Windows registry hive files from the shared directory."], e:"Anonymous SMB access enables null session attacks. You can enumerate share contents, list users (via RID cycling), discover groups, read password policies, and gather system information — all without valid credentials."},
    {c:"Network Services", q:"What is the security significance of discovering NTP (Network Time Protocol) running on a target?", a:"NTP can be queried to reveal connected clients, peer information, and internal network addressing.", d:["NTP servers are always vulnerable to remote code execution due to parsing flaws in timestamp fields.", "NTP traffic can be intercepted and modified to cause authentication tokens on the network to expire.", "NTP provides direct access to the system clock configuration, allowing an attacker to alter log times."], e:"NTP's monlist and peer commands can reveal internal IP addresses and associated hosts. NTP reflection/amplification can also be used for DDoS. The ntpq utility can extract peer lists, showing network topology information."},
    {c:"Network Services", q:"You find FTP running with anonymous access enabled and write permissions to the web server's document root. What attack does this enable?", a:"Uploading a web shell to the document root for remote command execution through the web server.", d:["Downloading the web server's private TLS key to decrypt all previously captured HTTPS traffic.", "Modifying the FTP server's configuration to create a new administrative user account for persistence.", "Performing a denial of service by filling the disk with uploaded files until the web server crashes."], e:"Anonymous FTP with write access to the web root is a critical finding. An attacker can upload a web shell (e.g., PHP) that is then accessible and executable through the web server, providing remote command execution."},
    {c:"Network Services", q:"You attempt to extract information from an SNMP-enabled device but SNMPv3 is in use with AuthPriv security level. What does this mean?", a:"Both authentication and encryption are enforced, requiring valid credentials and encrypting all traffic.", d:["Authentication is required but traffic is sent in cleartext, making the data interceptable via sniffing.", "The device uses SNMPv3 headers but falls back to community strings for backward compatibility with v2c.", "Only the initial handshake is encrypted, after which all SNMP data exchanges occur in plain text."], e:"SNMPv3 AuthPriv provides both authentication (using HMAC-SHA/MD5) and privacy (using AES/DES encryption). This is the most secure SNMP configuration, making community string guessing and traffic sniffing ineffective."},
    {c:"Network Services", q:"During a penetration test, you discover VNC running on port 5900 with no authentication configured. What is the immediate impact?", a:"Full remote desktop access to the target system without requiring any credentials or interaction.", d:["View-only access to the target's display, with keyboard and mouse input disabled by default.", "Access to a login screen where the operating system's local authentication is still enforced.", "An encrypted tunnel to the target that requires a separate key exchange before the session begins."], e:"VNC with no authentication allows anyone to connect and gain full interactive desktop access, including keyboard and mouse control. This provides the same access as physically sitting at the machine's console."},
    {c:"Network Services", q:"You find an RDP service that supports Network Level Authentication (NLA). How does this affect your attack approach?", a:"You must provide valid credentials before the RDP session is established, preventing unauthenticated exploits.", d:["NLA has no impact on attacks because it only encrypts the display stream after authentication succeeds.", "NLA disables clipboard sharing and drive redirection, limiting post-exploitation data exfiltration options.", "NLA forces the use of smart card authentication, making password-based brute force attacks impossible."], e:"NLA requires users to authenticate before a full RDP session is established. This prevents exploitation of vulnerabilities in the RDP display handling code (like BlueKeep) and limits brute-force attacks to pre-authentication."},
    {c:"Network Services", q:"What technique would you use to extract Cisco router configuration files if you have discovered SNMP write access with the 'private' community string?", a:"Use SNMP SET requests to trigger a TFTP configuration copy from the router to your controlled server.", d:["Directly read the configuration file from the router's flash memory using SNMP GET requests on the MIB.", "Exploit the SNMPv1 protocol to inject CLI commands directly into the router's command line interface.", "Modify the SNMP community string to 'cisco' which triggers an automatic configuration backup to FTP."], e:"With SNMP write access, you can set the appropriate OIDs to instruct the Cisco device to copy its running configuration to a TFTP server you control. This is a well-known technique using the CISCO-CONFIG-COPY-MIB."},
    {c:"Network Services", q:"You discover a Finger daemon running on a Unix host. What useful information can you extract from it?", a:"Currently logged-in users, their idle times, login sources, and home directory locations on the system.", d:["The list of all installed software packages and their version numbers on the target Unix operating system.", "The complete contents of each user's home directory, including configuration files and private keys.", "The firewall rules currently applied to the host, showing which inbound connections are permitted."], e:"The Finger daemon returns information about logged-in users including username, real name, terminal, idle time, login time, and office information. The CRT syllabus covers how the finger daemon can be 'abused' for reconnaissance."},
    {c:"Network Services", q:"What does it mean when a TLS-enabled service is found to support the TLS_RSA_WITH_RC4_128_SHA cipher suite?", a:"The server uses RSA key exchange without forward secrecy and the deprecated RC4 stream cipher.", d:["The server employs a modern authenticated encryption mode with RSA signatures for key verification.", "The server requires mutual TLS authentication with both client and server certificates for each session.", "The server is configured with the strongest available cipher suite including perfect forward secrecy."], e:"This cipher suite uses static RSA key exchange (no forward secrecy — if the server key is compromised, all past traffic can be decrypted) and the RC4 cipher (deprecated due to known biases). Both are significant weaknesses."},

    // ===== E: WINDOWS SECURITY ASSESSMENT (20 questions) =====
    {c:"Windows Assessment", q:"You have gained access to a Windows host and want to extract password hashes from the local SAM database. Which tool would you use?", a:"Use a tool like secretsdump, mimikatz, or reg save to extract SAM and SYSTEM hive files for offline cracking.", d:["Run the 'net user' command with the /hashes flag to display password hashes for all local user accounts.", "Access the SAM file directly at C:\Windows\System32\config\SAM while the operating system is running.", "Use PowerShell's Get-Credential cmdlet to retrieve stored password hashes from the Windows Credential Store."], e:"The SAM database is locked while Windows is running. Tools like secretsdump (Impacket), mimikatz (lsadump::sam), or copying the SAM/SYSTEM registry hives via 'reg save' allow offline hash extraction. This is a core CRT post-exploitation skill."},
    {c:"Windows Assessment", q:"During Active Directory enumeration, you discover a user account with a Service Principal Name (SPN) set. What attack does this enable?", a:"Kerberoasting — requesting a TGS ticket for the SPN and cracking the service account's password offline.", d:["Pass-the-Hash — using the user's NTLM hash to authenticate to other services across the domain.", "Golden Ticket — forging Kerberos TGT tickets to impersonate any user within the Active Directory forest.", "DCSync — replicating the domain controller's password database using the account's replication privileges."], e:"Accounts with SPNs registered in AD are vulnerable to Kerberoasting. Any authenticated domain user can request a TGS ticket for the service, which is encrypted with the service account's password hash and can be cracked offline."},
    {c:"Windows Assessment", q:"You have obtained NTLM password hashes from a compromised Windows host. The hashes begin with 'aad3b435b51404eeaad3b435b51404ee'. What does this tell you?", a:"The LANMAN hash portion is blank, indicating the password is longer than 14 characters or LM hashing is disabled.", d:["The password is empty and the account can be accessed without providing any authentication credentials.", "The hash is corrupted and cannot be used for either pass-the-hash attacks or offline cracking attempts.", "The account uses a smartcard for authentication and the password hash field is a reserved placeholder."], e:"'aad3b435b51404ee' is the LM hash of an empty string. When LM hashing is disabled (default on modern Windows), this placeholder appears. The NT hash (second half) is the one that matters for cracking or pass-the-hash attacks."},
    {c:"Windows Assessment", q:"You need to enumerate Active Directory users and groups from a Linux attack machine. Which tool is most appropriate?", a:"Use ldapsearch or Impacket's GetADUsers.py to query the domain controller's LDAP service directly.", d:["Run enum4linux against the domain controller to retrieve user listings via the SMB null session method.", "Use nmap's LDAP scripts which automatically dump the entire Active Directory forest object hierarchy.", "Install RSAT tools under Wine on your Linux machine to run Active Directory Users and Computers remotely."], e:"ldapsearch allows direct LDAP queries against the domain controller to enumerate users, groups, OUs, SPNs, and other AD objects. Impacket provides purpose-built Python tools for AD enumeration from Linux."},
    {c:"Windows Assessment", q:"What is the significance of identifying FSMO (Flexible Single Master Operations) roles during an Active Directory assessment?", a:"FSMO role holders are high-value targets — compromising them can grant control over AD-wide operations.", d:["FSMO roles are only relevant for replication timing and have no impact on the security assessment scope.", "Identifying FSMO roles reveals which servers can be safely taken offline without affecting authentication.", "FSMO role holders run a different version of Active Directory with additional debug-level attack surface."], e:"FSMO roles (Schema Master, Domain Naming Master, RID Master, PDC Emulator, Infrastructure Master) control critical AD functions. The PDC Emulator receives password changes first, making it a priority target for credential harvesting."},
    {c:"Windows Assessment", q:"You've compromised a Windows workstation and found cached domain credentials. What are these and how can they be exploited?", a:"Hashed copies of recent domain logins stored locally, crackable offline even when the DC is unreachable.", d:["Cleartext passwords stored in the registry that can be read directly with standard user-level access.", "Kerberos ticket-granting tickets cached in memory that expire after the default 10-hour TGT lifetime.", "Stored VPN credentials that allow remote access to the corporate network from outside the organisation."], e:"Windows caches domain credentials (as MS-Cache v2 hashes) so users can log in when the DC is unavailable. These can be extracted from the SECURITY registry hive and cracked offline, though the hash format is slower to crack than NTLM."},
    {c:"Windows Assessment", q:"You have local administrator access on a Windows machine and discover a service running as SYSTEM with a writable binary path. How can you exploit this?", a:"Replace the service binary with a malicious payload that executes as SYSTEM when the service restarts.", d:["Modify the service's registry key to change the account it runs under from SYSTEM to your own account.", "Use the service's PID to inject a DLL into its process space using the standard Windows API functions.", "Stop the service and read its configuration file to extract the SYSTEM account's cleartext password."], e:"If a service runs as SYSTEM and its binary path is writable by a lower-privileged user, replacing the binary with a payload provides SYSTEM-level execution on service restart. This is a classic Windows privilege escalation technique."},
    {c:"Windows Assessment", q:"During a Windows assessment, you discover that the AlwaysInstallElevated registry key is set to 1 in both HKLM and HKCU. What does this mean?", a:"Any user can install MSI packages with SYSTEM privileges, enabling trivial privilege escalation.", d:["Windows Installer is disabled and no software can be installed by any user including administrators.", "MSI packages require a digital signature from Microsoft before they can be executed on the system.", "Elevated installations are logged with enhanced audit detail but standard installation privileges apply."], e:"When AlwaysInstallElevated is set to 1 in both HKLM and HKCU, any user can install .msi packages with SYSTEM privileges. An attacker can create a malicious MSI package containing a payload to escalate to SYSTEM."},
    {c:"Windows Assessment", q:"You need to perform RID cycling against a Windows domain controller. What does this technique accomplish?", a:"Enumerating user and group accounts by incrementally querying Security Identifiers via anonymous sessions.", d:["Cracking password hashes by cycling through Rainbow tables indexed by the account's Relative Identifier.", "Bypassing Kerberos pre-authentication by replaying previously captured RID-based authentication tokens.", "Escalating domain privileges by modifying the Relative Identifier value in your current access token."], e:"RID cycling uses anonymous SMB (null session) access to query SIDs with incrementing RIDs (500 for Administrator, 501 for Guest, 1000+ for user accounts). This enumerates domain accounts without authentication."},
    {c:"Windows Assessment", q:"What is the purpose of extracting Group Policy Objects (GPOs) during an Active Directory penetration test?", a:"GPOs may contain stored credentials, mapped drives, scheduled tasks, and security policy configurations.", d:["GPOs only define desktop wallpaper settings and screen saver timeouts with no security relevance.", "GPO extraction triggers a domain-wide alert, so it is used specifically to test incident response speed.", "GPOs contain the master encryption keys for BitLocker, allowing offline decryption of all domain drives."], e:"GPOs can contain Group Policy Preferences (GPP) with stored credentials (cpassword), reveal security policies, software deployment settings, login scripts, mapped drives, and scheduled tasks — all valuable for privilege escalation."},
    {c:"Windows Assessment", q:"You discover an unquoted service path on a Windows system: 'C:\Program Files\My App\Service\service.exe'. How can this be exploited?", a:"Place a malicious executable named 'My.exe' in C:\Program Files\ to be executed instead of the service.", d:["Modify the executable name in the service configuration to point to your payload file using sc.exe.", "Inject a DLL named service.dll into the same directory to be loaded when the legitimate service starts.", "Rename the legitimate service binary and replace it with your payload using the same original filename."], e:"Windows resolves unquoted paths with spaces by trying each possible path segment. For 'C:\Program Files\My App\Service\service.exe', Windows tries 'C:\Program.exe', then 'C:\Program Files\My.exe', etc. Placing an executable at these paths hijacks execution."},
    {c:"Windows Assessment", q:"What Windows command would you use to identify all running services and their associated executable paths during a local assessment?", a:"Run 'wmic service get name,pathname,startmode' or use 'sc query' with PowerShell's Get-WmiObject.", d:["Execute 'tasklist /svc' to display all service executables alongside their full file system path details.", "Use 'netstat -anob' to list all services by their network connections and associated binary file paths.", "Run 'systeminfo' with the /services flag to generate a complete report of installed services and paths."], e:"'wmic service get name,pathname,startmode' returns service names, executable paths, and start modes. This is essential for identifying unquoted service paths and writable binary locations for privilege escalation."},
    {c:"Windows Assessment", q:"You have domain user credentials and want to check if any domain accounts have Kerberos pre-authentication disabled. Why is this important?", a:"Accounts without pre-authentication can have their AS-REP encrypted data requested and cracked offline.", d:["These accounts bypass Kerberos entirely and authenticate using cleartext NTLM over the network.", "Disabling pre-authentication grants the account unconditional access to all domain resources and shares.", "Accounts without pre-authentication cannot change their passwords, so they use a permanent static key."], e:"AS-REP Roasting targets accounts with 'Do not require Kerberos preauthentication' set. Without pre-auth, anyone can request an AS-REP encrypted with the user's password hash and crack it offline — no authentication required."},
    {c:"Windows Assessment", q:"During a Windows assessment, you find the WSUS (Windows Server Update Services) server communicating over HTTP. What attack does this enable?", a:"Man-in-the-middle injection of malicious updates that execute with SYSTEM privileges on client machines.", d:["Direct exploitation of the WSUS server to distribute ransomware to all managed domain workstations.", "Downloading the complete list of missing patches for every client to plan targeted exploitation attacks.", "Hijacking the WSUS administrator session to approve a backdoored update for domain-wide deployment."], e:"If WSUS uses HTTP instead of HTTPS, an attacker in a MITM position can intercept update requests and inject malicious updates (e.g., using WSUSpendu/SharpWSUS) that execute as SYSTEM on target machines."},
    {c:"Windows Assessment", q:"You need to determine the patch level of a compromised Windows host. What is the most reliable method?", a:"Run 'systeminfo' or 'wmic qfe list' to enumerate all installed hotfixes and their KB article numbers.", d:["Check the Windows version number in the About dialog, as it reflects the cumulative update level.", "Review the Windows Update log file at C:\Windows\Logs\WindowsUpdate.log for the latest update entry.", "Query the registry key HKLM\SOFTWARE\Microsoft\Updates for the most recently applied service pack."], e:"'systeminfo' and 'wmic qfe list' provide comprehensive lists of installed patches and hotfixes with KB numbers and installation dates. These can be cross-referenced against known exploits to identify missing critical patches."},
    {c:"Windows Assessment", q:"What technique allows you to extract cleartext passwords from a running Windows system's memory?", a:"Use mimikatz to access LSASS process memory and extract credentials stored by WDigest or Kerberos.", d:["Read the SAM registry hive directly while the system is running to decode the stored plaintext passwords.", "Dump the pagefile.sys to disk and parse it for password strings that were swapped out of memory.", "Run 'net user' with debug privileges to retrieve password hashes and reverse them to their plaintext."], e:"Mimikatz can extract cleartext credentials from the LSASS process memory, particularly when WDigest authentication is enabled (default on older systems). It can also extract Kerberos tickets, NTLM hashes, and PIN codes."},
    {c:"Windows Assessment", q:"You discover a Windows service running with a writable DACL that allows SERVICE_ALL_ACCESS to your user. How can you escalate privileges?", a:"Modify the service configuration to change the binary path to your payload and restart the service.", d:["Read the service's stored credentials to obtain the password of the account the service runs under.", "Inject a malicious thread into the service process using the WriteProcessMemory Windows API function.", "Stop the service permanently to trigger a failover that executes an alternate binary with elevated rights."], e:"With SERVICE_ALL_ACCESS (or SERVICE_CHANGE_CONFIG), you can use 'sc config <service> binpath= \"cmd /c <payload>\"' to change the service binary path to execute your payload, which runs with the service account's privileges."},
    {c:"Windows Assessment", q:"During an internal penetration test, you capture NTLMv2 hashes using Responder. Which is faster to crack — NTLMv2 or Net-NTLMv2?", a:"These are the same thing — 'Net-NTLMv2' and 'NTLMv2 hash' refer to the challenge-response captured on the wire.", d:["NTLMv2 is faster to crack because it uses a simpler hashing algorithm than the network-captured variant.", "Net-NTLMv2 is faster because the challenge is known, reducing the brute-force search space significantly.", "Neither can be cracked offline; both must be relayed in real-time to authenticate against other services."], e:"'Net-NTLMv2' (the challenge-response hash captured via Responder) and 'NTLMv2 hash' in capture context refer to the same thing. Both can be cracked offline using hashcat mode 5600, though they are significantly slower to crack than raw NTLM hashes."},
    {c:"Windows Assessment", q:"You have compromised a domain user account and want to enumerate all hosts where you have local administrator privileges. What tool would you use?", a:"Use BloodHound or CrackMapExec to map admin access relationships across domain-joined systems.", d:["Run 'net view /domain' from a command prompt to list all machines where your account has admin access.", "Query the Domain Controller's LDAP for the AdminSDHolder object which list all admin-accessible hosts.", "Use Group Policy Results (gpresult) to check which machines have granted your account elevated rights."], e:"BloodHound analyses AD relationships to find attack paths. CrackMapExec (CME) can test admin access across multiple hosts by attempting authenticated SMB connections. Both are standard tools for mapping lateral movement opportunities."},
    {c:"Windows Assessment", q:"What is the DLL search order hijacking technique, and why is it relevant during a Windows assessment?", a:"Windows searches for DLLs in a predictable order, so placing a malicious DLL in a higher-priority location hijacks loading.", d:["DLL hijacking involves modifying an existing system DLL in System32 to include backdoor code for persistence.", "The technique exploits a race condition in the DLL loading process to swap a legitimate DLL mid-execution.", "DLL hijacking requires administrative privileges to modify the system PATH variable and redirect DLL lookups."], e:"Windows searches for DLLs in a specific order: application directory, current directory, system directories, PATH directories. If an application loads a DLL without specifying its full path, placing a malicious DLL in a higher-priority search location causes it to be loaded instead."},

    // ===== F: LINUX/UNIX SECURITY ASSESSMENT (15 questions) =====
    {c:"Linux Assessment", q:"You have gained shell access to a Linux host as a low-privileged user. You find a binary with the SUID bit set owned by root. How can this be leveraged?", a:"If the SUID binary can be exploited or abused, it executes with root privileges regardless of the caller.", d:["SUID binaries always prompt for the root password before executing, preventing privilege escalation.", "The SUID bit only affects group permissions, so it grants the file's group privileges, not root access.", "SUID binaries run in a sandboxed environment that prevents them from modifying any system files."], e:"SUID (Set User ID) binaries execute with the file owner's permissions. A root-owned SUID binary runs as root regardless of who executes it. If the binary can be exploited (e.g., shell escape, path injection), the attacker gains root."},
    {c:"Linux Assessment", q:"On a Linux system, you find the /etc/shadow file is world-readable. What is the immediate impact of this misconfiguration?", a:"Any local user can read all password hashes and crack them offline to gain access to other accounts.", d:["Users can change other users' passwords by directly editing the hash values in the shadow file.", "The system will fail to authenticate any users because the shadow file permissions are incorrect.", "Only the root account's hash is stored in shadow; other user hashes remain protected in /etc/passwd."], e:"The /etc/shadow file stores password hashes that should only be readable by root (permissions 640 or 600). World-readable shadow files expose all user password hashes to offline cracking attacks."},
    {c:"Linux Assessment", q:"You discover a cron job running as root that executes a script from a world-writable directory. How can you exploit this?", a:"Replace or modify the script with a malicious payload that will execute with root privileges at the next run.", d:["The cron daemon ignores scripts in world-writable directories as a built-in security protection measure.", "Cron jobs always run with the permissions of the file owner, not the cron entry's configured user.", "You can only read the script output but cannot influence its execution or modify its contents."], e:"If a root cron job executes a script that a low-privileged user can modify (writable directory or writable script), the attacker can inject commands that execute as root on the next cron schedule."},
    {c:"Linux Assessment", q:"What is the purpose of the 'noexec' mount option on a Linux filesystem, and how can it be bypassed during a penetration test?", a:"It prevents execution of binaries on the partition, but can be bypassed by using an interpreter like /bin/bash.", d:["It prevents all file read and write operations on the partition, making it completely inaccessible to users.", "It encrypts the filesystem contents at rest and requires a passphrase to mount the partition for access.", "It cannot be bypassed under any circumstances and completely prevents code execution from the partition."], e:"The noexec mount option prevents direct execution of binaries on the partition. However, it can be bypassed by calling an interpreter (e.g., 'bash script.sh', 'python payload.py') or by loading shared libraries from the partition."},
    {c:"Linux Assessment", q:"You find a Linux system where /etc/passwd contains password hashes instead of the 'x' placeholder. What does this indicate?", a:"Shadow passwords are not enabled, meaning all users can read the password hashes directly from passwd.", d:["The system uses an enhanced security mode where both passwd and shadow store redundant hash copies.", "The hashes in /etc/passwd are decoy values designed to mislead attackers while the real hashes are hidden.", "This is the standard configuration for modern Linux distributions and presents no additional security risk."], e:"When the second field of /etc/passwd contains actual hashes instead of 'x', shadow passwords are not in use. Since /etc/passwd must be world-readable (for UID/GID lookups), all user password hashes are exposed to every user."},
    {c:"Linux Assessment", q:"During post-exploitation on a Linux host, you want to check for interesting files. Which command would help find all SUID binaries?", a:"Run 'find / -perm -4000 -type f 2>/dev/null' to locate all files with the SUID permission bit set.", d:["Use 'ls -la /usr/bin/ | grep suid' to list all SUID binaries installed in the standard binary directories.", "Execute 'chmod -R +s /' to recursively identify and mark all files that should have the SUID bit enabled.", "Run 'locate suid' to search the file database for all binaries with SUID in their filename or attributes."], e:"The find command with -perm -4000 searches for files with the SUID bit (4000) set. This is a standard post-exploitation technique for discovering potential privilege escalation vectors on Linux systems."},
    {c:"Linux Assessment", q:"You have obtained the /etc/shadow file from a Linux target. The password hash starts with '$6$'. What hashing algorithm is being used?", a:"SHA-512 (crypt format), which is the default hashing algorithm on most modern Linux distributions.", d:["MD5 (crypt format), which was the original Linux password hashing algorithm from early distributions.", "Blowfish (bcrypt format), which is commonly used on BSD-based operating systems for password storage.", "SHA-256 (crypt format), which provides a moderate level of security between MD5 and SHA-512 hashing."], e:"Linux password hash prefixes: $1$ = MD5, $2a$/$2b$ = bcrypt, $5$ = SHA-256, $6$ = SHA-512. SHA-512 ($6$) is the default on most modern Linux distributions including Ubuntu, CentOS, and RHEL."},
    {c:"Linux Assessment", q:"You discover a Linux host with an NFS export that has root_squash enabled. How does this affect your exploitation approach?", a:"Remote root access is mapped to the 'nobody' user, preventing direct root-level file manipulation on the share.", d:["Root squash completely prevents any user from mounting the NFS export from an external host entirely.", "Root squash encrypts all NFS traffic when accessed by the root user but leaves other users unaffected.", "Root squash only applies to read operations; root users can still write files with full root permissions."], e:"Root squash maps remote root (UID 0) to nobody/nfsnobody, preventing a remote root user from creating SUID files or modifying root-owned files. Exploitation requires UID manipulation to match a non-root user who has access."},
    {c:"Linux Assessment", q:"You find a writable library path in a Linux application's LD_LIBRARY_PATH. How can this be exploited for privilege escalation?", a:"Place a malicious shared library in the writable path to be loaded by a privileged process before the legitimate one.", d:["Modify the LD_LIBRARY_PATH variable in the system profile to redirect all library loading system-wide.", "Compile a static binary that does not use shared libraries and place it in the library path for execution.", "LD_LIBRARY_PATH exploitation is not possible because the dynamic linker ignores it for SUID binaries."], e:"If a privileged application searches a writable directory for shared libraries (via LD_LIBRARY_PATH or RPATH), a malicious library placed there gets loaded instead. Note: LD_LIBRARY_PATH is typically ignored for SUID binaries, but RPATH compiled into binaries is not."},
    {c:"Linux Assessment", q:"During enumeration of a Solaris host, you find an r-service with /etc/hosts.equiv containing the entry '+ root'. What does this allow?", a:"The root user from any remote host can authenticate to this system via rlogin/rsh without a password.", d:["Only the local root user can use r-services; the plus sign simply enables the service for localhost.", "All users from the host named 'root' can connect without passwords, but no special privileges are given.", "The entry is a comment line in the hosts.equiv format and has no functional effect on authentication."], e:"In /etc/hosts.equiv, '+' means 'any host' and 'root' specifies the user. Together, '+ root' allows the root user from any host to authenticate via rlogin/rsh without a password — a critical misconfiguration."},
    {c:"Linux Assessment", q:"You have compromised a Linux web server and want to maintain persistence. Which technique is least likely to be detected by standard monitoring?", a:"Adding an SSH public key to an existing user's authorized_keys file for persistent passwordless access.", d:["Creating a new root-level user account in /etc/passwd with UID 0 and a known password hash value.", "Installing a kernel module rootkit that hides processes and network connections from system utilities.", "Adding a cron job that connects back to your command-and-control server every five minutes for access."], e:"Adding an SSH key to an existing user's authorized_keys is subtle because it doesn't create new accounts, modify system binaries, or generate periodic network connections. Standard monitoring may not detect an additional key in an existing file."},
    {c:"Linux Assessment", q:"What is the security implication of finding 'PermitRootLogin yes' in an SSH server's sshd_config?", a:"Direct root login via SSH is allowed, enabling brute-force attacks directly against the most privileged account.", d:["SSH connections are restricted to the root user only, preventing all standard user accounts from logging in.", "Root login is permitted but all commands executed as root are logged with enhanced audit verbosity levels.", "The setting only affects password authentication; key-based root login is always enabled by default regardless."], e:"PermitRootLogin yes allows direct SSH authentication as root. This enables brute-force attacks against the root account and eliminates the need for privilege escalation if root's password is compromised."},
    {c:"Linux Assessment", q:"You find a Linux binary running with capabilities set (CAP_NET_RAW). What does this specific capability allow?", a:"The process can use raw sockets for network operations like packet sniffing and crafting without root.", d:["The process can bind to any network port below 1024, bypassing the standard privileged port restriction.", "The process has full root access to the system and can perform any operation without restriction.", "The process can modify network interface configurations and change IP addresses on the host's adapters."], e:"CAP_NET_RAW allows a process to use raw and packet sockets. This enables network sniffing (like tcpdump) and crafting custom packets without full root privileges. Other capabilities grant different specific permissions."},
    {c:"Linux Assessment", q:"During post-exploitation, you discover a Solaris host where the password hashes in /etc/shadow use the traditional DES-based crypt. What is the maximum password length this supports?", a:"Eight characters — any characters beyond the eighth position are silently ignored during hashing.", d:["Fourteen characters — matching the same limitation as the legacy Windows LANMAN hash algorithm.", "Twenty-four characters — which is the standard maximum for all Unix-derived password hashing methods.", "There is no character limit — DES crypt processes the full password regardless of length for hashing."], e:"Traditional DES-based Unix crypt only uses the first 8 characters of a password. Any additional characters are ignored. This means a 20-character password provides no more security than its first 8 characters under DES crypt."},
    {c:"Linux Assessment", q:"You find a world-writable /tmp directory on a Linux system without the sticky bit set. What is the security risk?", a:"Any user can delete or rename other users' files in /tmp, enabling symlink attacks against privileged processes.", d:["The /tmp directory's contents are automatically replicated to all user home directories when written.", "World-writable /tmp directories cause the system to swap all temporary file contents to unencrypted disk.", "Without the sticky bit, files in /tmp are automatically assigned root ownership regardless of the creator."], e:"Without the sticky bit (chmod +t), any user can delete or rename files owned by other users in a world-writable directory. This enables symlink race conditions where an attacker replaces a temp file used by a privileged process."},

    // ===== G: WEB TECHNOLOGIES (20 questions) =====
    {c:"Web Technologies", q:"During a web application test, you discover that the server returns different error messages for valid and invalid usernames during login. What vulnerability does this represent?", a:"Username enumeration through differential responses, allowing an attacker to compile a list of valid users.", d:["An SQL injection vulnerability in the authentication query that reveals internal database error messages.", "A cross-site scripting vulnerability where the error message reflects unsanitised input back to the user.", "An insecure direct object reference that exposes user account details through the error response body."], e:"Different error messages for valid vs. invalid usernames (e.g., 'Incorrect password' vs. 'User not found') allow attackers to enumerate valid accounts. The CRT syllabus covers 'username enumeration' as a common authentication vulnerability."},
    {c:"Web Technologies", q:"You intercept an HTTP request and notice a session token being transmitted in the URL query string. What is the primary risk?", a:"The session token will be recorded in server logs, browser history, and potentially leaked via Referer headers.", d:["URL-based session tokens are automatically encrypted by the TLS protocol and present minimal risk.", "The session token in the URL is only visible to the user's browser and cannot be intercepted in transit.", "Session tokens in URLs are valid for a single request only, making them immune to hijacking or replay."], e:"Session IDs in URLs are logged in web server access logs, browser history, proxy logs, and sent in the Referer header when following external links. The CRT syllabus specifically covers 'security implications of session IDs exposed in URLs'."},
    {c:"Web Technologies", q:"You discover a web application that uses client-side JavaScript validation but performs no server-side input validation. What is the security implication?", a:"An attacker can bypass all validation using a proxy tool like Burp Suite to modify requests after the browser.", d:["Client-side validation is sufficient because JavaScript executes in a sandboxed environment in the browser.", "The application is only vulnerable to cross-site scripting because other injection attacks require server-side flaws.", "No security risk exists because modern browsers enforce JavaScript validation and prevent request tampering."], e:"Client-side validation can always be bypassed by intercepting requests with a proxy, using curl/wget, or disabling JavaScript. The CRT syllabus states candidates must understand 'the flaws associated with client-side validation' and the need for server-side validation."},
    {c:"Web Technologies", q:"What is the difference between reflected XSS and stored XSS in terms of attack vector and impact?", a:"Reflected XSS requires the victim to click a crafted link, while stored XSS executes for every user viewing the page.", d:["Reflected XSS persists in the database and affects all users, while stored XSS only affects the original attacker.", "Reflected XSS only works in Internet Explorer, while stored XSS is effective across all modern web browsers.", "Reflected XSS can execute arbitrary server-side code, while stored XSS is limited to client-side JavaScript."], e:"Reflected XSS is injected via user input that is immediately reflected in the response (requires social engineering). Stored XSS is persisted (e.g., in a database) and executes every time any user views the affected page, making it higher impact."},
    {c:"Web Technologies", q:"You are testing for SQL injection and the application returns no visible errors. What technique should you use to confirm the vulnerability?", a:"Blind SQL injection using Boolean-based conditions or time-based delays to infer query results.", d:["Abandon SQL injection testing entirely, as the absence of error messages means the input is being sanitised.", "Switch to testing for LDAP injection instead, as SQL databases always return errors when injection occurs.", "Use UNION-based injection to append additional SELECT statements that return visible output in the response."], e:"When error messages are suppressed, blind SQL injection uses Boolean conditions (e.g., 'AND 1=1' vs 'AND 1=2' producing different responses) or time delays (e.g., 'WAITFOR DELAY') to confirm the vulnerability and extract data."},
    {c:"Web Technologies", q:"You discover that a web application is vulnerable to SQL injection in a MySQL database. What command can you use to read arbitrary files from the server?", a:"Use the LOAD_FILE() function within a SQL injection payload to read file contents from the filesystem.", d:["Use the xp_cmdshell stored procedure to execute a file read command on the underlying operating system.", "Use the UTL_FILE package to open and read file handles through the database's built-in file access layer.", "Use the COPY FROM statement to import file contents into a temporary database table for extraction."], e:"MySQL's LOAD_FILE('/etc/passwd') function reads file contents when the MySQL user has FILE privilege. For MSSQL, xp_cmdshell is the equivalent. For Oracle, UTL_FILE. For PostgreSQL, COPY or pg_read_file()."},
    {c:"Web Technologies", q:"During a web test, you discover the application sets cookies without the HttpOnly flag. What does this enable?", a:"JavaScript running in the browser can access the cookie value, making it stealable via cross-site scripting.", d:["The cookie is transmitted over both HTTP and HTTPS connections without any transport-layer protection.", "The cookie persists permanently in the browser and is never deleted even after the browser session closes.", "The cookie is shared with all subdomains and third-party sites that the application communicates with."], e:"The HttpOnly flag prevents client-side JavaScript from accessing the cookie via document.cookie. Without it, an XSS vulnerability can be used to steal session tokens. The Secure flag controls HTTPS-only transmission."},
    {c:"Web Technologies", q:"You find a file upload feature on a web application. What is the most dangerous attack scenario?", a:"Uploading a server-side script (e.g., PHP web shell) that is stored and executable in the web root directory.", d:["Uploading a large file to consume disk space and cause a denial-of-service condition on the web server.", "Uploading an HTML file containing JavaScript to perform a stored cross-site scripting attack on other users.", "Uploading a malformed image file that crashes the server's image processing library during thumbnail creation."], e:"If the application stores uploaded files in the web root without proper validation and the server executes them (e.g., a .php file on Apache with mod_php), an attacker gains remote code execution through a web shell."},
    {c:"Web Technologies", q:"What is the purpose of using a client-side proxy like Burp Suite during a web application penetration test?", a:"To intercept, inspect, and modify all HTTP/HTTPS traffic between the browser and the target application.", d:["To cache web pages locally for faster loading times while repeatedly testing the same application pages.", "To automatically discover and exploit all vulnerabilities in the web application without manual intervention.", "To generate a site map of the application for documentation purposes without actively testing for flaws."], e:"Client-side proxies intercept HTTP(S) requests and responses, allowing testers to view, modify, and replay traffic. This enables manipulation of parameters, headers, cookies, and request bodies. The CRT syllabus covers 'parameter manipulation techniques, particularly the use of client-side proxies'."},
    {c:"Web Technologies", q:"You discover a web application where changing a parameter from 'user_id=123' to 'user_id=124' shows another user's data. What is this vulnerability?", a:"An Insecure Direct Object Reference (IDOR) where the application fails to verify resource ownership.", d:["A cross-site request forgery vulnerability where the parameter change forges a request on behalf of another.", "A server-side request forgery vulnerability where the user_id parameter triggers an internal API lookup.", "A session fixation attack where the application assigns the wrong user's session to the current request."], e:"IDOR occurs when the application exposes direct references to internal objects (like user IDs) and fails to verify that the requesting user is authorised to access the referenced object. This is a common authorisation flaw."},
    {c:"Web Technologies", q:"What is a CSRF (Cross-Site Request Forgery) attack, and what is the most common defence against it?", a:"A CSRF attack forces a victim's browser to make authenticated requests to a target site using anti-CSRF tokens to prevent it.", d:["A CSRF attack injects malicious scripts into the target website's pages, which is prevented by input encoding.", "A CSRF attack intercepts authentication tokens in transit, and HTTPS is the primary defence mechanism against it.", "A CSRF attack exploits SQL injection to forge administrative requests, prevented by parameterised database queries."], e:"CSRF exploits the browser's automatic inclusion of cookies with requests. If a victim visits an attacker-controlled page, their browser can be tricked into making requests to a target site with their session. Anti-CSRF tokens (unique per session/request) are the primary defence."},
    {c:"Web Technologies", q:"You find a web application that passes a filename parameter to include a local file. What type of vulnerability is this, and what is the most impactful exploitation?", a:"Local File Inclusion (LFI), which can be escalated to read sensitive files or achieve remote code execution.", d:["An open redirect vulnerability that can be used to redirect users to malicious phishing websites.", "A path normalisation issue that only affects the display of file names in the application's user interface.", "A broken access control vulnerability that requires valid authentication credentials to exploit effectively."], e:"LFI allows an attacker to include local files (e.g., /etc/passwd, log files). With techniques like log poisoning, PHP filter chains, or /proc/self/environ, LFI can often be escalated to remote code execution."},
    {c:"Web Technologies", q:"During a web test, you discover the application uses Base64 encoding for a cookie that contains user role information. Is this secure?", a:"No — Base64 is encoding, not encryption, and can be trivially decoded and re-encoded to tamper with the role.", d:["Yes — Base64 provides sufficient obfuscation to prevent casual tampering with the cookie's stored values.", "Yes — Base64 encoding combined with the cookie's integrity is protected by the browser's same-origin policy.", "No — but only if the attacker has access to the server-side decoding key that reverses the Base64 operation."], e:"Base64 is a reversible encoding scheme, not encryption. Any user can decode a Base64 cookie, modify the content (e.g., change 'role=user' to 'role=admin'), re-encode it, and send it back. The CRT syllabus covers 'identification and exploitation of encoded values'."},
    {c:"Web Technologies", q:"What HTTP response code indicates that the server understood the request but refuses to authorise it?", a:"403 Forbidden — the server understood the request but the client does not have permission to access it.", d:["401 Unauthorized — the server requires valid authentication credentials that have not been provided yet.", "404 Not Found — the server cannot find the requested resource at the specified URL path location.", "500 Internal Server Error — the server encountered an unexpected condition preventing request fulfilment."], e:"403 Forbidden means the server understood the request but refuses to fulfil it (authorisation failure). 401 indicates authentication is required. The CRT syllabus requires understanding of 'all HTTP methods and response codes'."},
    {c:"Web Technologies", q:"You discover a web application that uses WebSockets. How does this affect your testing approach?", a:"WebSocket connections bypass standard HTTP request-response patterns and require dedicated proxy interception.", d:["WebSockets are always encrypted and cannot be intercepted by standard penetration testing proxy tools.", "WebSocket traffic is identical to standard HTTP and requires no modification to your testing methodology.", "WebSockets only transfer binary data and therefore cannot be exploited through text-based injection attacks."], e:"WebSockets maintain persistent bidirectional connections that don't follow the HTTP request-response model. Burp Suite can intercept WebSocket messages, but testers need to adapt their methodology. The CRT v2.0 syllabus explicitly includes WebSockets."},
    {c:"Web Technologies", q:"What is the purpose of the HTTP OPTIONS method, and why is it relevant to web security testing?", a:"It reveals the HTTP methods supported by the server, potentially exposing dangerous methods like PUT or DELETE.", d:["It sets optional configuration parameters for the web server's security headers and CORS policy settings.", "It initiates an encrypted channel between the client and server before any data is transmitted over HTTP.", "It requests the server to cache all subsequent responses for improved performance during the test session."], e:"The OPTIONS method returns which HTTP methods are supported for a resource. Finding PUT, DELETE, TRACE, or CONNECT methods enabled can indicate security misconfigurations. TRACE can enable Cross-Site Tracing (XST) attacks."},
    {c:"Web Technologies", q:"You discover a web application that reflects the contents of the HTTP Host header in page links. What vulnerability could this indicate?", a:"Host header injection, potentially enabling password reset poisoning, cache poisoning, or SSRF attacks.", d:["A DNS rebinding vulnerability that allows the attacker to bypass the browser's same-origin security policy.", "A misconfigured TLS certificate that does not match the server's hostname causing browser security warnings.", "An information disclosure vulnerability limited to revealing the internal hostname of the web application."], e:"If the application trusts the Host header for generating links (e.g., in password reset emails), an attacker can inject their own domain. This can redirect password reset links to attacker-controlled servers or poison web caches."},
    {c:"Web Technologies", q:"During web application testing, you find that the server includes 'X-Powered-By: PHP/7.4.3' in its response headers. Why is this a finding?", a:"It reveals the specific server technology and version, enabling targeted exploit research and version-specific attacks.", d:["This header is a mandatory HTTP standard and its presence indicates the server is configured correctly.", "The header confirms the application is using an outdated protocol and must immediately upgrade to HTTP/3.", "X-Powered-By is a security header that protects against cross-site scripting by identifying the server runtime."], e:"Technology disclosure headers like X-Powered-By reveal the server-side language and exact version. This allows attackers to search for known CVEs and exploits specific to that version, reducing the effort needed for exploitation."},
    {c:"Web Technologies", q:"What is the risk of a web application that uses predictable session identifiers, such as sequential integers?", a:"An attacker can guess or enumerate valid session IDs to hijack active sessions of other authenticated users.", d:["Predictable session IDs only affect performance by causing session collisions on the server's session store.", "Sequential session IDs are vulnerable to cross-site scripting but not to session hijacking or impersonation.", "The risk is limited to the application logging sequential IDs which consumes excessive disk space over time."], e:"If session IDs follow a predictable pattern (sequential, time-based, short length), an attacker can guess valid session IDs and hijack other users' sessions. The CRT syllabus requires candidates to 'harvest and analyse session identifiers for weaknesses'."},
    {c:"Web Technologies", q:"You discover OS command injection in a web application. The input is appended to a command with a pipe character filtered. What alternative can you use?", a:"Use the semicolon (;), newline (%0a), or backtick operators to chain or substitute commands instead.", d:["Command injection requires the pipe character specifically and no alternative characters can be used.", "Switch to exploiting the vulnerability as SQL injection since the same input reaches the database layer.", "Use URL encoding of the pipe character (%7C) which will always bypass server-side input filtering rules."], e:"Multiple command separator characters exist in shell environments: semicollon (;), newline, backticks (`cmd`), $() substitution, && and || operators. If one is filtered, others may still work. The CRT syllabus covers identification and exploitation of OS command injection."},

    // ===== H: DATABASES (8 questions) =====
    {c:"Databases", q:"You have gained SQL injection access to a Microsoft SQL Server. What stored procedure can be used to execute operating system commands?", a:"xp_cmdshell, which runs OS commands and returns the output as rows in a result set when enabled.", d:["sp_execute, which provides a generic interface for running external programs from within SQL queries.", "sys_exec, which is a built-in system function available in all editions of Microsoft SQL Server by default.", "dbms_scheduler, which creates operating system jobs that execute commands on the underlying server."], e:"xp_cmdshell is a SQL Server extended stored procedure that executes OS commands. It is disabled by default on modern SQL Server versions but can be re-enabled by an attacker with sysadmin privileges using sp_configure."},
    {c:"Databases", q:"You discover an Oracle database with the default 'SCOTT/TIGER' credentials still active. What level of access does this provide?", a:"A default demo account with limited privileges that can be used as a foothold for further privilege escalation.", d:["Full DBA-level access including the ability to create users, modify schemas, and execute system commands.", "Read-only access to the data dictionary views, allowing enumeration of all database objects and users.", "No practical access because the SCOTT account is automatically locked on all Oracle installations after 12c."], e:"SCOTT/TIGER is a classic Oracle demo account with limited privileges in its own schema. However, any authenticated access can be leveraged for further enumeration and potential privilege escalation through Oracle-specific techniques."},
    {c:"Databases", q:"In a MySQL database accessed via SQL injection, what query would you use to enumerate all databases on the server?", a:"SHOW DATABASES; or SELECT schema_name FROM information_schema.schemata to list all available databases.", d:["SELECT name FROM sys.databases to query the system catalogue for all database instances on the server.", "SELECT datname FROM pg_database to retrieve the list of databases from the PostgreSQL system catalogue.", "Run the stored procedure sp_databases to return a result set containing all databases on the instance."], e:"MySQL uses SHOW DATABASES or queries against information_schema.schemata. MSSQL uses sys.databases or sp_databases. PostgreSQL uses pg_database. Knowing the correct syntax per database platform is essential for SQL injection exploitation."},
    {c:"Databases", q:"You have compromised a Microsoft SQL Server with sysadmin privileges. What technique can you use to read files from the server's filesystem?", a:"Use BULK INSERT or OPENROWSET to read file contents into a table, or xp_cmdshell with type/cat commands.", d:["SQL Server has no capability to read the filesystem directly even with the highest level of privileges.", "Use the DBCC READFILE command which is a dedicated file system access interface built into SQL Server.", "Mount the filesystem as an external data source using the EXTERNAL TABLE feature introduced in SQL 2019."], e:"With sysadmin privileges, BULK INSERT can load file contents into tables, OPENROWSET(BULK...) can read files, and xp_cmdshell can execute 'type' commands. These are standard post-exploitation techniques for MSSQL."},
    {c:"Databases", q:"What is the Oracle TNS Listener, and why is it significant during a penetration test?", a:"It manages client-to-database connections and can reveal version information, SIDs, and service names when queried.", d:["It is the Oracle backup service that stores complete database copies on network-accessible file shares.", "It is an auditing component that logs all database queries and cannot be directly queried by remote clients.", "It is Oracle's implementation of TLS that encrypts all database traffic between the client and the server."], e:"The TNS (Transparent Network Substrate) Listener accepts incoming connections on port 1521. It can be queried to reveal Oracle version, SID names, and service details. Tools like tnscmd and odat can enumerate this information."},
    {c:"Databases", q:"You gain access to a PostgreSQL database and want to achieve command execution on the underlying server. What approach would you use?", a:"Use the COPY TO/FROM PROGRAM feature to execute OS commands and read or write their output to tables.", d:["PostgreSQL does not support any form of OS command execution regardless of the user's privilege level.", "Call the pg_execute_os() function which is available to all PostgreSQL users for running shell commands.", "Create a PL/SQL procedure that invokes the Java runtime environment to spawn an operating system process."], e:"PostgreSQL's COPY TO/FROM PROGRAM (requires superuser) allows executing OS commands. For example: COPY (SELECT '') TO PROGRAM 'id > /tmp/output'. Alternatively, user-defined functions in C or PL/Python can achieve code execution."},
    {c:"Databases", q:"What is a common method for identifying the database version during a blind SQL injection attack?", a:"Use conditional statements that return different responses based on version-specific functions or variables.", d:["Blind SQL injection cannot be used to determine the database type or version under any circumstances.", "Send a UNION SELECT with the VERSION() function, as all database platforms support this exact syntax.", "Trigger a deliberate syntax error and extract the database version from the detailed error message text."], e:"In blind SQLi, conditional logic like IF(SUBSTRING(@@version,1,1)='5', SLEEP(5), 0) (MySQL) or CASE WHEN (SELECT version()) LIKE 'PostgreSQL%' THEN pg_sleep(5) END allows version detection through timing or Boolean responses."},
    {c:"Databases", q:"You discover a web application using JDBC connection strings stored in a configuration file. What sensitive information might these contain?", a:"Database server addresses, port numbers, database names, and potentially cleartext usernames and passwords.", d:["Only the database driver class name and the JDBC API version number used by the application connector.", "The SQL queries that the application will execute, including all parameterised stored procedure definitions.", "The database schema definition and table structures but not any authentication or connection credentials."], e:"JDBC connection strings typically follow the format 'jdbc:type://host:port/dbname?user=X&password=Y'. They can contain server addresses, ports, database names, and credentials. The CRT syllabus covers recognition of 'common database connection string formats, e.g. JDBC, ODBC'."}
];
