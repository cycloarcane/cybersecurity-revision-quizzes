const pool = [
// --- 1. RECON & ENUMERATION — 12 questions ---
{c:"Recon & Enumeration", q:"What is the primary protocol Active Directory uses for directory queries and object lookups?", a:"LDAP (Lightweight Directory Access Protocol) on TCP ports 389 and 636 for TLS.", d:["SNMP (Simple Network Management Protocol) on UDP ports 161 and 162 for traps.", "SMTP (Simple Mail Transfer Protocol) on TCP ports 25 and 587 for submission.", "SIP (Session Initiation Protocol) on TCP and UDP port 5060 for signalling."], e:"Active Directory is an LDAP-compliant directory service. LDAP on port 389 (or LDAPS on 636) is used for querying objects, attributes, and relationships in the directory."},
{c:"Recon & Enumeration", q:"Which DNS record type is queried to locate domain controllers providing Kerberos authentication services?", a:"SRV records under _kerberos._tcp in the domain's DNS zone for service discovery.", d:["MX records under the domain's root DNS zone for mail exchange server resolution.", "PTR records in the reverse DNS zone for mapping IP addresses to host names.", "CNAME records aliasing the domain controller to a canonical name in the zone."], e:"Active Directory relies heavily on DNS SRV records. Querying _kerberos._tcp.<domain> or _ldap._tcp.<domain> reveals domain controllers, which is a key initial enumeration step."},
{c:"Recon & Enumeration", q:"When performing unauthenticated enumeration, what can an anonymous LDAP bind often reveal?", a:"The base DN, domain naming context, and supported LDAP capabilities of the forest.", d:["The plaintext passwords of all service accounts stored in the directory database.", "The complete group membership and SID history of every domain administrator account.", "The full contents of the SYSVOL share including all Group Policy Object templates."], e:"Even without credentials, an anonymous LDAP bind to the RootDSE often reveals the base DN (e.g., DC=corp,DC=local), naming contexts, and domain functionality level."},
{c:"Recon & Enumeration", q:"What information does the SYSVOL share typically contain that is valuable during enumeration?", a:"Group Policy Objects, logon scripts, and potentially credentials in policy preferences.", d:["The Active Directory database file (ntds.dit) and all associated transaction log files.", "Private keys for every TLS certificate issued by the enterprise certificate authority.", "The master encryption key for BitLocker volumes on all domain-joined workstations."], e:"SYSVOL (\<domain>\SYSVOL) contains GPOs, logon/logoff scripts, and sometimes legacy Group Policy Preferences with embedded credentials (cpassword values)."},
{c:"Recon & Enumeration", q:"Which command in BloodHound's data collection (SharpHound) gathers the most comprehensive dataset?", a:"The -CollectionMethod All flag, which collects sessions, ACLs, trusts, and containers.", d:["The -CollectionMethod DCOnly flag, which only queries a single domain controller host.", "The -CollectionMethod LocalGroup flag, which only gathers local group memberships.", "The -CollectionMethod ObjectProps flag, which only collects basic object properties."], e:"SharpHound's -CollectionMethod All performs comprehensive collection including group membership, sessions, ACLs, trusts, containers, and GPO data needed for full attack path analysis."},
{c:"Recon & Enumeration", q:"What does enumerating SPNs (Service Principal Names) allow an attacker to identify in a domain?", a:"Service accounts tied to specific applications, which are potential Kerberoasting targets.", d:["The physical location of each server in the data centre rack using asset tag records.", "The firmware version of each network switch managed by the domain controller server.", "The backup schedule for each volume shadow copy stored on the file server shares."], e:"SPNs map services to accounts. Enumerating them reveals service accounts (often with weak passwords) that can be targeted for Kerberoasting to obtain crackable TGS tickets."},
{c:"Recon & Enumeration", q:"Which LDAP filter would enumerate all user accounts with the 'Do not require Kerberos preauthentication' flag set?", a:"(userAccountControl:1.2.840.113556.1.4.803:=4194304) filtering on the UAC bit value.", d:["(objectClass=computer)(operatingSystem=*Server*) filtering on the OS attribute field.", "(servicePrincipalName=*) filtering on any account that has a registered SPN value.", "(memberOf=CN=Domain Admins,*) filtering on the distinguished name of the group."], e:"The UAC flag DONT_REQUIRE_PREAUTH has the value 4194304. This LDAP filter finds AS-REP Roastable accounts that don't require preauthentication."},
{c:"Recon & Enumeration", q:"What is the significance of the AdminCount attribute being set to 1 on a user object?", a:"It indicates the account is or was protected by AdminSDHolder as a privileged account.", d:["It indicates the account has been disabled by an administrator and cannot log on.", "It indicates the account password is stored using reversible encryption in the DB.", "It indicates the account is a managed service account with automatic password rotation."], e:"AdminCount=1 flags accounts protected by the AdminSDHolder mechanism, meaning they have (or had) membership in privileged groups like Domain Admins, making them high-value targets."},
{c:"Recon & Enumeration", q:"During initial network reconnaissance, what does scanning for port 88 open on a host indicate?", a:"The host is likely a domain controller running the Kerberos Key Distribution Center.", d:["The host is running a web application server using an alternative HTTP listener port.", "The host is an SMTP mail relay configured to accept inbound email from the internet.", "The host is a database server running Microsoft SQL Server on a non-default TCP port."], e:"Port 88 is the Kerberos KDC port. Finding it open strongly indicates the host is a domain controller, since the KDC runs on every DC as part of the AD authentication infrastructure."},
{c:"Recon & Enumeration", q:"What PowerShell cmdlet from the ActiveDirectory module enumerates all domain trusts?", a:"Get-ADTrust -Filter *, which returns all trust relationships for the current domain.", d:["Get-ADComputer -Filter *, which returns all computer objects joined to the domain.", "Get-ADGroupMember -Identity 'Domain Users', which returns all standard user accounts.", "Get-ADReplicationSite -Filter *, which returns all configured replication site objects."], e:"Get-ADTrust -Filter * enumerates all trust relationships, revealing trust direction, type (forest/external/parent-child), and whether SID filtering is enabled."},
{c:"Recon & Enumeration", q:"What does null session enumeration via SMB typically attempt to gather from a target system?", a:"User and group listings, share names, and password policy details from the SAM.", d:["The BitLocker recovery key for the system volume stored in the Active Directory.", "The plaintext LAPS password for the local administrator account on that machine.", "The Kerberos ticket-granting ticket cached in the LSASS memory on that system."], e:"Null sessions (anonymous SMB connections) can sometimes enumerate users, groups, shares, and password policies via legacy configurations, especially on older or misconfigured systems."},
{c:"Recon & Enumeration", q:"Which tool uses SAMR and LSARPC named pipes over SMB to enumerate domain users and groups remotely?", a:"rpcclient or enum4linux, both leveraging RPC interfaces over the SMB transport.", d:["Wireshark or tcpdump, both capturing raw network packets on the physical interface.", "Burp Suite or ZAP, both intercepting HTTP requests through a local proxy listener.", "Metasploit or Cobalt Strike, both generating shellcode payloads for initial access."], e:"Tools like rpcclient and enum4linux use the SAMR (Security Account Manager Remote) and LSARPC pipes over SMB to query user accounts, group memberships, and domain information."},

// --- 2. NTLM ATTACKS — 10 questions ---
{c:"NTLM Attacks", q:"What is the fundamental mechanism exploited in an NTLM relay attack?", a:"Forwarding a captured NTLM authentication to a different service the victim can access.", d:["Cracking the NTLM hash offline using rainbow tables to recover the plaintext password.", "Injecting a forged NTLM hash into the LSASS process to create a new logon session.", "Downgrading the Kerberos authentication to force the use of DES encryption ciphers."], e:"NTLM relay forwards the authentication handshake (Type 1/2/3 messages) from a victim to a target service, authenticating as the victim without knowing their password."},
{c:"NTLM Attacks", q:"What protocol does Responder primarily poison to capture NTLM hashes on a local network segment?", a:"LLMNR and NBT-NS, which handle name resolution when DNS queries fail to resolve.", d:["ARP and RARP, which handle the mapping of IP addresses to physical MAC addresses.", "DHCP and BOOTP, which handle the dynamic assignment of IP addresses to new hosts.", "ICMP and IGMP, which handle network diagnostics and multicast group registrations."], e:"Responder poisons LLMNR (Link-Local Multicast Name Resolution) and NBT-NS (NetBIOS Name Service) responses, directing victims to send NTLM authentication to the attacker."},
{c:"NTLM Attacks", q:"Which Microsoft security feature, when enforced, prevents NTLM relay attacks by binding authentication to the channel?", a:"Extended Protection for Authentication (EPA), which binds NTLM to the TLS channel.", d:["Credential Guard, which isolates LSASS secrets inside a virtualisation-based enclave.", "BitLocker Drive Encryption, which encrypts the system volume at rest on the disk.", "AppLocker application control policies, which restrict executable file path locations."], e:"EPA (Channel Binding) ties the NTLM authentication to the specific TLS session, preventing an attacker from relaying the authentication to a different service endpoint."},
{c:"NTLM Attacks", q:"What attack technique uses a captured NTLMv2 hash directly without cracking it, by injecting it into memory?", a:"Pass-the-hash, which authenticates using the NT hash without knowing the password.", d:["Kerberoasting, which requests service tickets encrypted with a service account key.", "AS-REP Roasting, which targets accounts without Kerberos preauthentication enabled.", "Silver Ticket forgery, which creates a service ticket signed with a service key only."], e:"Pass-the-hash injects the NT hash into an authentication session, allowing the attacker to authenticate as the user to NTLM-accepting services without cracking the password."},
{c:"NTLM Attacks", q:"Why is SMB signing important as a mitigation against NTLM relay attacks targeting file shares?", a:"SMB signing validates message integrity, preventing modification of relayed auth packets.", d:["SMB signing encrypts all file transfer data to prevent eavesdropping of shared content.", "SMB signing compresses SMB packets to improve network throughput between endpoints.", "SMB signing rotates the session key after each file operation for forward secrecy."], e:"When SMB signing is required, the server validates message signatures. A relay attacker cannot produce valid signatures since they don't know the session key derived from the password."},
{c:"NTLM Attacks", q:"What does the ntlmrelayx tool's --delegate-access flag enable when relaying to LDAP?", a:"It configures resource-based constrained delegation on the target computer account.", d:["It grants the relayed user account full Domain Admin group membership immediately.", "It disables NTLM authentication entirely across the domain by modifying GPO settings.", "It exports the NTLM hash of the domain controller machine account to a local file."], e:"The --delegate-access flag creates a new machine account and configures RBCD (resource-based constrained delegation) on the target, enabling S4U2Proxy abuse for access."},
{c:"NTLM Attacks", q:"What is the NTLM downgrade attack also known as, and what does it accomplish?", a:"An attack forcing NTLMv1 responses, which are trivially convertible to crackable hashes.", d:["An attack converting Kerberos tickets to a format compatible with legacy NTLMv2 tools.", "An attack that disables NTLM entirely, forcing all clients to use plaintext credentials.", "An attack that resets the NTLM hash of a target account to a known attacker value."], e:"Forcing NTLMv1 (via Responder or modified challenge) produces responses that can be cracked to NT hashes using rainbow tables or converted via crack.sh, regardless of password complexity."},
{c:"NTLM Attacks", q:"In the context of NTLM relay, what is the significance of targeting LDAP on a domain controller?", a:"LDAP relay to a DC can modify directory objects like adding users or changing ACLs.", d:["LDAP relay to a DC automatically grants kernel-level code execution on that server.", "LDAP relay to a DC causes the domain controller to reboot into Directory Restore mode.", "LDAP relay to a DC exports the complete ntds.dit file to the attacker's SMB share."], e:"Successfully relaying NTLM to LDAP on a DC allows write operations against the directory — creating accounts, modifying group memberships, setting ACLs, or configuring delegation."},
{c:"NTLM Attacks", q:"What attack uses IPv6 to perform NTLM relay by answering DHCPv6 requests on a network?", a:"mitm6, which configures itself as a rogue IPv6 DNS server to intercept WPAD requests.", d:["EvilFOCA, which exploits IPv6 SLAAC to perform denial of service on all local hosts.", "Inveigh, which exclusively poisons mDNS responses over IPv4 multicast addresses only.", "Bettercap, which exclusively performs ARP spoofing attacks on the IPv4 network layer."], e:"mitm6 exploits Windows' preference for IPv6, acting as a rogue DHCPv6 server to become the DNS server, then capturing NTLM authentication via spoofed WPAD proxy configurations."},
{c:"NTLM Attacks", q:"What is a Net-NTLMv2 hash and why can it not be directly used for pass-the-hash?", a:"It is a challenge-response hash bound to a specific server nonce, not a static credential.", d:["It is a salted SHA-256 hash that requires the original salt value to replay correctly.", "It is a Kerberos ticket encrypted with the KDC master key and therefore non-portable.", "It is a time-stamped SAML assertion that expires within sixty seconds of issuance."], e:"Net-NTLMv2 is a challenge-response value tied to a specific server challenge. Unlike the NT hash, it cannot be replayed — it must be cracked offline or relayed in real-time."},

// --- 3. KERBEROS ATTACKS — 12 questions ---
{c:"Kerberos Attacks", q:"What is Kerberoasting, and what account property makes it possible?", a:"Requesting TGS tickets for SPNs, which are encrypted with the service account's key.", d:["Intercepting AS-REQ traffic and decrypting it using the domain controller's public key.", "Modifying the krbtgt account password hash to forge arbitrary ticket-granting tickets.", "Exploiting a buffer overflow in the Kerberos KDC service to achieve code execution."], e:"Kerberoasting requests TGS tickets for accounts with SPNs. These tickets are encrypted with the service account's NT hash and can be cracked offline to recover the password."},
{c:"Kerberos Attacks", q:"What is AS-REP Roasting, and what makes an account vulnerable to this attack?", a:"Requesting an AS-REP for accounts without preauthentication, then cracking the response.", d:["Replaying a previously captured AS-REP message to authenticate as a different user.", "Injecting a crafted AS-REP into the KDC response queue to bypass ticket validation.", "Intercepting the AS-REP between the client and KDC to extract the session key pair."], e:"AS-REP Roasting targets accounts with 'Do not require Kerberos preauthentication' enabled. The KDC returns an encrypted AS-REP that can be cracked offline without authentication."},
{c:"Kerberos Attacks", q:"What is a Golden Ticket attack, and what secret is required to perform it?", a:"Forging a TGT using the krbtgt account NTLM hash, granting domain-wide access.", d:["Forging a TGS using the domain controller machine account hash for a single service.", "Stealing a valid TGT from domain controller memory using a kernel-mode driver exploit.", "Requesting a special TGT from the KDC using an expired domain administrator password."], e:"A Golden Ticket is a forged TGT created with the krbtgt hash. Since the KDC uses krbtgt's key to encrypt all TGTs, possessing this hash allows forging tickets for any user."},
{c:"Kerberos Attacks", q:"What is a Silver Ticket attack, and how does it differ from a Golden Ticket?", a:"Forging a TGS for a single service using that service account's NTLM hash directly.", d:["Forging a TGT for all services using the domain controller machine account hash value.", "Capturing a valid TGS from network traffic and replaying it against a different server.", "Requesting a privileged TGS from the KDC by exploiting a flaw in the referral process."], e:"A Silver Ticket forges a TGS for a specific service using that service's NT hash. Unlike Golden Tickets, it never touches the KDC, making it stealthier but limited to one service."},
{c:"Kerberos Attacks", q:"What is the Diamond Ticket technique, and why is it considered stealthier than a Golden Ticket?", a:"It modifies a legitimately requested TGT rather than forging one entirely from scratch.", d:["It encrypts the forged ticket using AES-256 instead of the weaker RC4 cipher suite.", "It uses a valid certificate from ADCS to request a ticket through the PKINIT protocol.", "It requests a TGT from a secondary KDC to avoid detection by the primary DC sensors."], e:"Diamond Tickets decrypt a legitimate TGT (using the krbtgt key), modify its PAC to include privileged groups, and re-encrypt it. This passes validation checks that detect pure forgeries."},
{c:"Kerberos Attacks", q:"What is unconstrained delegation, and why is it dangerous from an attack perspective?", a:"The server stores the user's forwarded TGT in memory, enabling impersonation to any service.", d:["The server requests a new TGT on behalf of the user using only the service session key.", "The server forwards its own machine account TGT to the target service for authentication.", "The server caches the user's password hash locally to speed up future re-authentication."], e:"Unconstrained delegation allows a server to store users' forwarded TGTs. An attacker controlling such a server can extract these TGTs and impersonate those users to any service."},
{c:"Kerberos Attacks", q:"How does the Printer Bug (SpoolSample) facilitate Kerberos attacks against unconstrained delegation?", a:"It coerces a target machine to authenticate to an attacker-controlled host, sending its TGT.", d:["It exploits a vulnerability in the print spooler to achieve remote code execution as SYSTEM.", "It modifies the printer driver on a domain controller to inject a backdoor DLL on startup.", "It intercepts print jobs between clients and servers to extract credentials from documents."], e:"The Printer Bug uses the MS-RPRN RpcRemoteFindFirstPrinterChangeNotification function to coerce a DC to authenticate to an attacker's host with unconstrained delegation, forwarding its TGT."},
{c:"Kerberos Attacks", q:"What is constrained delegation with protocol transition (S4U2Self + S4U2Proxy)?", a:"A mechanism allowing a service to obtain tickets to specified services on behalf of any user.", d:["A mechanism encrypting all Kerberos traffic between the client and the KDC using IPsec.", "A mechanism that restricts users to authenticating with smart cards only at the workstation.", "A mechanism rotating the service account password every thirty days automatically."], e:"S4U2Self obtains a service ticket to itself on behalf of any user (protocol transition), and S4U2Proxy then uses that ticket to request a ticket to an allowed target service."},
{c:"Kerberos Attacks", q:"What is resource-based constrained delegation (RBCD), and why is it significant for attackers?", a:"Delegation configured on the target resource, which any account with write access can set.", d:["Delegation configured at the forest root that applies to every domain in the topology.", "Delegation requiring manual approval from a domain admin for each individual delegation.", "Delegation limited to a single protocol type such as HTTP or CIFS on the target host."], e:"RBCD is configured via msDS-AllowedToActOnBehalfOfOtherIdentity on the target. Any principal with write access to a computer object can configure RBCD, enabling S4U2Proxy abuse."},
{c:"Kerberos Attacks", q:"What encryption type is preferred for Kerberoasting because it is significantly faster to crack?", a:"RC4-HMAC (etype 23), which uses the raw NT hash and is much faster to brute-force.", d:["AES-256-CTS (etype 18), which uses a PBKDF2-derived key adding significant complexity.", "DES-CBC-MD5 (etype 3), which is the only encryption type supported by modern clients.", "Camellia-256 (etype 26), which is the default cipher in Active Directory environments."], e:"RC4-HMAC (etype 23) tickets are encrypted with the raw NT hash, making them orders of magnitude faster to crack than AES tickets which use PBKDF2-derived keys with 4096 iterations."},
{c:"Kerberos Attacks", q:"What is a Kerberos delegation abuse chain starting from a machine account with an SPN you control?", a:"Use S4U2Self to get a ticket as any user, then S4U2Proxy to access the target service.", d:["Use AS-REQ to request a TGT for the machine, then inject it into the KDC ticket cache.", "Use TGS-REQ to obtain a cross-realm referral ticket, then present it to the foreign KDC.", "Use a certificate to request a PKINIT TGT, then downgrade it to an NTLM session token."], e:"Controlling a machine account with an SPN that is allowed to delegate (via RBCD), you use S4U2Self to obtain a forwardable ticket as any user, then S4U2Proxy to access the target."},
{c:"Kerberos Attacks", q:"What is a Sapphire Ticket, and how does it achieve stealthier privilege escalation?", a:"It uses S4U2Self and U2U to obtain a real PAC from the KDC for inclusion in a forged ticket.", d:["It uses a compromised ADCS template to issue a ticket-signing certificate for the krbtgt.", "It performs a cross-realm ticket modification to inject SID history from a foreign domain.", "It replaces the service ticket session key with a static value to simplify key management."], e:"Sapphire Tickets use S4U2Self+U2U to get a legitimate PAC for a privileged user from the KDC, then embed it in a forged ticket. The real PAC passes even strict validation checks."},

// --- 4. CREDENTIAL ACCESS — 10 questions ---
{c:"Credential Access", q:"What tool extracts credential material from the LSASS process memory on a Windows system?", a:"Mimikatz, using its sekurlsa::logonpasswords module to dump cached credentials.", d:["Hashcat, using its dictionary attack mode to crack captured network hash values.", "BloodHound, using its SharpHound collector to map Active Directory attack paths.", "Nessus, using its credentialed scan profile to identify missing security patches."], e:"Mimikatz's sekurlsa::logonpasswords reads LSASS memory to extract NTLM hashes, Kerberos tickets, and sometimes plaintext passwords from cached logon sessions."},
{c:"Credential Access", q:"What is the DPAPI (Data Protection API), and why is it relevant to credential theft?", a:"A Windows API protecting user secrets like browser passwords, which can be decrypted with keys.", d:["A Linux API for managing SSH key pairs stored in the user's home directory on disk.", "A network protocol for distributing encryption keys to domain-joined certificate servers.", "A hardware interface for communicating with Trusted Platform Module chips on endpoints."], e:"DPAPI protects secrets like Chrome passwords, RDP credentials, and Wi-Fi keys. With the user's password or domain backup key, attackers can decrypt all DPAPI-protected data."},
{c:"Credential Access", q:"What does the DCSync attack simulate, and what permission is required to perform it?", a:"It simulates domain controller replication to extract password hashes using replication rights.", d:["It simulates a domain join operation to register a rogue computer in the domain directory.", "It simulates a Group Policy update to push a malicious script to all domain workstations.", "It simulates a DNS zone transfer to obtain all host records from the domain DNS servers."], e:"DCSync uses the MS-DRSR (Directory Replication Service Remote) protocol. It requires Replicating Directory Changes and Replicating Directory Changes All rights, typically held by Domain Admins."},
{c:"Credential Access", q:"What is LAPS (Local Administrator Password Solution), and what risk does it mitigate?", a:"It randomises local admin passwords per machine, preventing lateral movement with shared creds.", d:["It enforces multi-factor authentication for all remote desktop connections to servers.", "It encrypts the SAM database on each endpoint using a unique volume-specific key.", "It rotates the domain administrator password on a scheduled thirty-day interval."], e:"LAPS stores unique, randomised local administrator passwords in AD attributes, preventing attackers from using one compromised local admin password to move laterally across machines."},
{c:"Credential Access", q:"What file contains the Active Directory database, and where is it located on a domain controller?", a:"ntds.dit, located by default in %SystemRoot%\NTDS on every domain controller.", d:["SAM, located by default in %SystemRoot%\System32\config on every domain workstation.", "SYSTEM, located by default in %SystemRoot%\System32\config on every Windows computer.", "SECURITY, located by default in %SystemRoot%\System32\config on domain controllers."], e:"ntds.dit is the AD database containing all objects and password hashes. Extracting it (via Volume Shadow Copy, ntdsutil, or DCSync) enables offline extraction of all domain credentials."},
{c:"Credential Access", q:"What technique extracts credentials from a domain controller by creating a Volume Shadow Copy?", a:"Using vssadmin or diskshadow to copy ntds.dit and the SYSTEM hive from a shadow copy.", d:["Using robocopy to mirror the SYSVOL share to a remote attacker-controlled file server.", "Using wmic to query the Win32_UserAccount class for plaintext password attribute values.", "Using netsh to export the wireless network profiles containing stored WPA2 passphrases."], e:"Creating a VSS snapshot allows copying the locked ntds.dit and SYSTEM hive. The SYSTEM hive contains the boot key needed to decrypt password hashes in the ntds.dit file."},
{c:"Credential Access", q:"What does Credential Guard protect against, and how does it achieve this protection?", a:"It isolates LSASS secrets in a virtualisation-based security enclave, blocking hash extraction.", d:["It blocks all network authentication attempts that use the NTLM protocol on the system.", "It encrypts the entire hard drive using BitLocker with TPM-backed key storage at boot.", "It prevents users from saving passwords in web browsers by disabling the password API."], e:"Credential Guard uses VBS (Virtualisation-Based Security) to isolate NTLM hashes and Kerberos keys in a secure enclave that even local admins and kernel-level code cannot read."},
{c:"Credential Access", q:"What is a Group Policy Preferences (GPP) password, and why is it a well-known vulnerability?", a:"Credentials stored in GPP XML files encrypted with a publicly known AES key from Microsoft.", d:["Passwords stored in clear text within the Group Policy template ADM files on the SYSVOL.", "Encryption keys embedded in the registry on each client after a Group Policy refresh cycle.", "Hashed passwords stored in the NTDS.dit file using an undocumented proprietary algorithm."], e:"GPP allowed embedding credentials in XML files on SYSVOL. Microsoft published the AES key (MS14-025), so any domain user can decrypt cpassword values found in these files."},
{c:"Credential Access", q:"What does the secretsdump.py tool from Impacket extract from a remote target?", a:"SAM hashes, LSA secrets, cached domain credentials, and ntds.dit hashes via DCSync.", d:["Running process listings, active TCP connections, and loaded kernel driver information.", "File system directory trees, NTFS permission ACLs, and disk volume usage statistics.", "Event log entries, scheduled task configurations, and Windows service startup settings."], e:"secretsdump.py can remotely dump SAM hashes, LSA secrets (including service account passwords), domain cached credentials, and perform DCSync to extract all domain hashes."},
{c:"Credential Access", q:"Why are Managed Service Accounts (MSAs) and Group Managed Service Accounts (gMSAs) more secure than standard service accounts?", a:"Their passwords are complex, automatically rotated, and managed entirely by Active Directory.", d:["They are exempt from Kerberos authentication and use certificate-based smart card logon.", "They store their credentials in hardware security modules rather than in the AD database.", "They can only authenticate from a single IP address specified during the account creation."], e:"gMSAs have 240-character auto-generated passwords rotated every 30 days by AD. This eliminates weak passwords, removes human management, and makes Kerberoasting impractical."},

// --- 5. LATERAL MOVEMENT — 10 questions ---
{c:"Lateral Movement", q:"What is the primary difference between PsExec-style lateral movement and WMI-based execution?", a:"PsExec creates a service and writes to disk, while WMI executes commands without a service.", d:["PsExec uses Kerberos for authentication, while WMI exclusively uses NTLM relay tickets.", "PsExec requires local administrator rights, while WMI works with standard user privileges.", "PsExec operates over HTTP port 80, while WMI uses the HTTPS port 443 for transport."], e:"PsExec uploads a service binary and creates a Windows service (disk artefact + service event log), while WMI uses DCOM to execute commands without creating a service, leaving fewer artefacts."},
{c:"Lateral Movement", q:"What authentication technique allows an attacker to use a Kerberos ticket for lateral movement without a password?", a:"Pass-the-ticket, which injects a stolen TGT or TGS into the current logon session.", d:["Pass-the-hash, which injects an NTLM hash to authenticate via the NTLM challenge protocol.", "Overpass-the-hash, which uses an NT hash to request a fresh Kerberos TGT from the KDC.", "Certificate-based auth, which uses a stolen PFX file to request a PKINIT TGT from the KDC."], e:"Pass-the-ticket loads a previously extracted Kerberos ticket (TGT or TGS) into memory using tools like Rubeus ptt, allowing access to services without the password or hash."},
{c:"Lateral Movement", q:"What is overpass-the-hash (pass-the-key), and how does it differ from standard pass-the-hash?", a:"It uses an NT hash or AES key to request a legitimate Kerberos TGT from the domain KDC.", d:["It converts an NTLMv2 response into a Kerberos ticket without contacting the domain KDC.", "It replays a previously captured Net-NTLM hash against a different SMB share on the net.", "It downgrades Kerberos authentication to NTLM to leverage a weaker challenge-response."], e:"Overpass-the-hash uses the NT hash (or AES key) to perform a Kerberos AS-REQ, obtaining a legitimate TGT. This converts NTLM material into Kerberos tickets for stealthier access."},
{c:"Lateral Movement", q:"Which Windows feature enables remote command execution and is commonly abused for lateral movement?", a:"WinRM (Windows Remote Management) over HTTP port 5985 or HTTPS port 5986.", d:["WSUS (Windows Server Update Services) over HTTP port 8530 for update distribution.", "SCCM (System Center Configuration Manager) over HTTP port 80 for client management.", "ADFS (Active Directory Federation Services) over HTTPS port 443 for token issuance."], e:"WinRM (PowerShell Remoting) enables remote command execution and is commonly used for lateral movement. It uses HTTP/5985 or HTTPS/5986 and supports both NTLM and Kerberos auth."},
{c:"Lateral Movement", q:"What is DCOM-based lateral movement, and which common object is frequently abused?", a:"Leveraging Distributed COM to execute commands remotely, often via the MMC20 Application object.", d:["Leveraging Active Directory Sites and Services to redirect replication traffic to rogue DCs.", "Leveraging DNS dynamic updates to register malicious A records for name resolution poisoning.", "Leveraging Certificate Authority web enrollment to issue certificates for impersonation."], e:"DCOM (Distributed Component Object Model) allows remote object activation. The MMC20.Application COM object's ExecuteShellCommand method is commonly abused for lateral movement."},
{c:"Lateral Movement", q:"What is the significance of the 'Local Administrator' group for lateral movement in a domain?", a:"Members can authenticate remotely and execute code, making shared credentials a pivot vector.", d:["Members are automatically synchronised to the Domain Admins group every replication cycle.", "Members can only log on interactively at the console and cannot authenticate over the net.", "Members are restricted to read-only access on the local machine's file system shares."], e:"Local administrator access enables remote code execution via SMB, WMI, WinRM, and more. Shared local admin passwords (before LAPS) allow attackers to move laterally to every machine."},
{c:"Lateral Movement", q:"How does an attacker use the Windows admin share (C$) for lateral movement?", a:"By authenticating with admin credentials to copy files and execute payloads via SCM or WMI.", d:["By connecting anonymously to C$ since it requires no authentication by default on servers.", "By mounting C$ as a local drive letter which automatically grants kernel debugging privileges.", "By accessing C$ over FTP, which Windows exposes on port 21 for all administrative shares."], e:"With local admin credentials, an attacker can access 	arget\C$ over SMB, copy malicious binaries, and use the Service Control Manager or WMI to execute them remotely."},
{c:"Lateral Movement", q:"What technique uses scheduled tasks on a remote system for lateral movement?", a:"Creating a remote scheduled task via schtasks.exe or the ITaskSchedulerService RPC interface.", d:["Modifying the local task scheduler XML file and waiting for the domain controller to sync.", "Registering a new COM class in the remote registry that executes on every user login event.", "Exploiting a vulnerability in the Windows Task Scheduler to escalate from user to SYSTEM."], e:"Attackers can create scheduled tasks on remote systems using schtasks /create /s <target> or Impacket's atexec.py, executing commands as SYSTEM through the task scheduler service."},
{c:"Lateral Movement", q:"What does RDP (Remote Desktop Protocol) lateral movement provide that other methods do not?", a:"A full interactive GUI session, allowing manual interaction with applications and desktops.", d:["Encrypted traffic that is invisible to all network monitoring and IDS detection systems.", "Automatic privilege escalation from a standard user account to the local administrator.", "Persistent access that survives system reboots without any additional persistence mechanism."], e:"RDP provides a full interactive desktop session, useful for interacting with GUI applications, browsing files, and performing actions that require visual interaction rather than command-line."},
{c:"Lateral Movement", q:"What tool from Impacket performs lateral movement by executing commands through Windows Management Instrumentation?", a:"wmiexec.py, which uses WMI's Win32_Process Create method to run commands remotely.", d:["smbclient.py, which only provides SMB file share browsing and file transfer operations.", "getTGT.py, which only requests Kerberos ticket-granting tickets using password or hashes.", "lookupsid.py, which only performs SID brute-forcing to enumerate domain user accounts."], e:"wmiexec.py uses WMI's Win32_Process.Create to execute commands remotely, providing a semi-interactive shell without writing a service binary to disk."},

// --- 6. PRIVILEGE ESCALATION — 10 questions ---
{c:"Privilege Escalation", q:"What is the PrintNightmare vulnerability (CVE-2021-34527), and how can it be exploited in AD environments?", a:"A print spooler flaw allowing remote code execution as SYSTEM by loading a malicious driver.", d:["A Kerberos KDC flaw allowing golden ticket creation without the krbtgt account hash value.", "A DNS server flaw allowing zone transfer hijacking to redirect all domain authentication.", "An LDAP server flaw allowing anonymous modification of all directory object attributes."], e:"PrintNightmare exploits the Windows Print Spooler service to load a malicious DLL as SYSTEM, enabling local privilege escalation and remote code execution on vulnerable systems."},
{c:"Privilege Escalation", q:"What is the ZeroLogon vulnerability (CVE-2020-1472), and what does it allow an attacker to do?", a:"A Netlogon flaw that resets the domain controller machine account password to an empty value.", d:["A Kerberos flaw that allows requesting TGTs for any account without valid credentials.", "A DNS flaw that enables poisoning all SRV records in the _msdcs zone of the domain.", "A Group Policy flaw that pushes attacker-controlled scripts to all domain-joined clients."], e:"ZeroLogon exploits a cryptographic flaw in the Netlogon protocol to set the DC machine account password to empty, granting the attacker DCSync rights via the DC's identity."},
{c:"Privilege Escalation", q:"What makes the 'SeImpersonatePrivilege' dangerous when held by a compromised service account?", a:"It allows impersonating any token on the system, enabling escalation to SYSTEM via potato attacks.", d:["It allows modifying the system boot configuration to disable driver signature enforcement.", "It allows reading the Security event log to extract cached user authentication credentials.", "It allows resetting the passwords of all user accounts in the local Security Account Manager."], e:"SeImpersonatePrivilege allows impersonating tokens from other processes. Potato attacks (JuicyPotato, PrintSpoofer, GodPotato) coerce SYSTEM to authenticate, then impersonate that token."},
{c:"Privilege Escalation", q:"What privilege escalation path exists when a user has 'GenericWrite' permissions on a computer object?", a:"Configure resource-based constrained delegation (RBCD) to impersonate any user to that host.", d:["Directly reset the computer account password by modifying the unicodePwd attribute in LDAP.", "Inject a Group Policy Object that executes a startup script on the computer at next reboot.", "Read the LAPS password attribute in clear text to obtain the local administrator credentials."], e:"GenericWrite on a computer object allows modifying msDS-AllowedToActOnBehalfOfOtherIdentity, enabling RBCD. The attacker then uses S4U2Self and S4U2Proxy to impersonate privileged users."},
{c:"Privilege Escalation", q:"What is the noPac (Sam-the-Admin) attack, and which CVEs does it chain?", a:"It chains CVE-2021-42278 and CVE-2021-42287 to escalate from user to domain admin access.", d:["It chains CVE-2020-1472 and CVE-2021-34527 to exploit Netlogon and the print spooler.", "It chains CVE-2022-26923 and CVE-2021-42278 to abuse ADCS templates and machine names.", "It chains CVE-2019-1040 and CVE-2021-42287 to relay NTLM and impersonate the KDC."], e:"noPac exploits machine account name spoofing (CVE-2021-42278) and KDC confusion during S4U2Self (CVE-2021-42287), allowing a standard user to obtain a TGT as a domain controller."},
{c:"Privilege Escalation", q:"How can an attacker escalate privileges by abusing membership in the 'Backup Operators' group?", a:"By using backup privileges to copy the ntds.dit and SYSTEM hive, then extracting all hashes.", d:["By logging into the domain controller console and resetting the domain admin password.", "By directly writing to the SYSVOL share and planting a startup script in the default GPO.", "By modifying the DNS zone to add a new SRV record pointing to an attacker-controlled DC."], e:"Backup Operators have SeBackupPrivilege which allows reading any file regardless of ACLs, including ntds.dit and the SYSTEM hive, enabling offline extraction of all domain password hashes."},
{c:"Privilege Escalation", q:"What is the DnsAdmins privilege escalation technique?", a:"Loading a malicious DLL into the DNS service running as SYSTEM on the domain controller.", d:["Modifying DNS conditional forwarder records to redirect domain authentication traffic.", "Creating a new DNS zone that shadows the existing domain zone with poisoned records.", "Registering a DNS SRV record that points the KDC service to an attacker-controlled host."], e:"Members of DnsAdmins can configure the DNS service to load an arbitrary DLL via the ServerLevelPluginDll registry value. When the DNS service restarts, it loads the DLL as SYSTEM."},
{c:"Privilege Escalation", q:"What Windows privilege allows loading kernel drivers, and how is it abused for escalation?", a:"SeLoadDriverPrivilege, which enables loading vulnerable drivers to achieve kernel code execution.", d:["SeDebugPrivilege, which enables attaching a debugger to the LSASS process for hash dumping.", "SeAssignPrimaryTokenPrivilege, which enables creating new processes with a different token.", "SeTcbPrivilege, which enables acting as part of the operating system's trusted computing base."], e:"SeLoadDriverPrivilege allows loading a vulnerable signed driver (e.g., Capcom.sys) which provides a kernel-level read/write primitive, enabling escalation to SYSTEM."},
{c:"Privilege Escalation", q:"What is the significance of the 'Account Operators' group for privilege escalation in Active Directory?", a:"Members can create and modify most accounts and groups, potentially adding users to privileged groups.", d:["Members have full administrative control of every domain controller in the entire forest.", "Members can modify the schema partition to add new attributes and object classes to AD.", "Members can issue and revoke TLS certificates from the enterprise certificate authority."], e:"Account Operators can create accounts and modify non-protected groups. While they cannot modify Domain Admins directly, they can often escalate through intermediate group memberships."},
{c:"Privilege Escalation", q:"What is the NTLM coercion technique known as PetitPotam, and why is it impactful?", a:"It coerces domain controllers to authenticate via EFS RPC, enabling relay to ADCS for escalation.", d:["It forces domain controllers to send their machine account hashes via ICMP echo requests.", "It triggers a memory corruption in the NTLM authentication module of the domain controller.", "It downgrades the domain functional level to enable weaker authentication across the forest."], e:"PetitPotam uses the MS-EFSRPC API to coerce a DC to authenticate to an attacker. When relayed to ADCS web enrollment (HTTP), the attacker obtains a DC certificate for authentication."},

// --- 7. ACL & GPO ABUSE — 10 questions ---
{c:"ACL & GPO Abuse", q:"What does the 'WriteDacl' permission on a domain object allow an attacker to do?", a:"Modify the object's access control list to grant themselves any permission, including full control.", d:["Read the object's encrypted attribute values including the LAPS and DPAPI backup keys.", "Delete the object and all its child objects from the Active Directory database permanently.", "Move the object to a different organisational unit within the domain directory tree structure."], e:"WriteDacl allows modifying the Discretionary Access Control List (DACL), enabling the attacker to grant themselves GenericAll, DCSync rights, or any other permission on that object."},
{c:"ACL & GPO Abuse", q:"How can 'GenericAll' permission on a user object be abused for privilege escalation?", a:"Reset the user's password, set an SPN for Kerberoasting, or modify their group memberships.", d:["Only view the user's display name and email address attributes in the global address list.", "Only send email messages on behalf of the user through the Exchange mail transport agent.", "Only read the user's logon timestamp attribute to determine when they last authenticated."], e:"GenericAll grants full control. On a user object this enables password resets, SPN modification (targeted Kerberoasting), shadow credentials attacks, and group membership changes."},
{c:"ACL & GPO Abuse", q:"What is a shadow credentials attack, and what permission is needed to perform it?", a:"Writing to msDS-KeyCredentialLink to add attacker keys, then using PKINIT to obtain a TGT.", d:["Modifying the userCertificate attribute to inject a rogue certificate into the user's store.", "Changing the servicePrincipalName to create a new SPN for Kerberos service ticket requests.", "Resetting the unicodePwd attribute directly over LDAP to set a new known password value."], e:"With write access to msDS-KeyCredentialLink, an attacker adds their own key pair. They then use PKINIT (certificate-based auth) to obtain a TGT as the target, using tools like Whisker and Rubeus."},
{c:"ACL & GPO Abuse", q:"What does 'ForceChangePassword' permission on a user object allow?", a:"Resetting the target user's password without knowing their current password value.", d:["Viewing the target user's current password hash stored in the Active Directory database.", "Forcing the target user to change their password at next interactive logon to the domain.", "Disabling the target user's account by modifying the userAccountControl attribute flags."], e:"ForceChangePassword (ExtendedRight on the user object) allows setting a new password without the current one, enabling account takeover. Net user or Set-ADAccountPassword can be used."},
{c:"ACL & GPO Abuse", q:"How can an attacker abuse 'WriteOwner' permission on a domain object?", a:"Change the object owner to themselves, then use owner rights to grant full control via WriteDacl.", d:["Directly decrypt all encrypted attributes on the object including confidential bitlocker keys.", "Move the object to a different domain in the forest without requiring cross-domain permissions.", "Delete the object's replication metadata to prevent it from syncing to other domain controllers."], e:"WriteOwner allows changing the object's owner. The owner implicitly has WriteDacl, so the attacker takes ownership, then modifies the DACL to grant themselves any permissions needed."},
{c:"ACL & GPO Abuse", q:"What is GPO abuse, and how can editing a Group Policy Object lead to domain compromise?", a:"Modifying a GPO linked to privileged OUs to deploy scheduled tasks, scripts, or registry changes.", d:["Creating a new standalone GPO that automatically applies to every object in the entire forest.", "Deleting all existing GPOs to disable security settings and expose all domain-joined machines.", "Linking a GPO to the Schema partition to modify the Active Directory schema replication topology."], e:"If an attacker can edit a GPO linked to an OU containing Domain Admins or DCs, they can add immediate scheduled tasks, logon scripts, or registry modifications for code execution."},
{c:"ACL & GPO Abuse", q:"What BloodHound edge represents the ability to read the LAPS password for a computer?", a:"ReadLAPSPassword, indicating the principal can read the ms-Mcs-AdmPwd attribute on the object.", d:["ReadGMSAPassword, indicating the principal can read the msDS-ManagedPassword blob attribute.", "HasSIDHistory, indicating the principal's SID history contains the target's security identifier.", "CanPSRemote, indicating the principal can establish a PowerShell remoting session to the host."], e:"The ReadLAPSPassword edge in BloodHound identifies principals that can read ms-Mcs-AdmPwd (LAPS password attribute) on computer objects, providing local admin access."},
{c:"ACL & GPO Abuse", q:"What is an ACL-based attack path, and why is BloodHound essential for discovering these?", a:"A chain of misconfigured permissions leading to escalation, often invisible without graph analysis.", d:["A network routing path between VLANs that allows direct TCP connections to domain controllers.", "A sequence of software vulnerabilities requiring patches to be applied in a specific order.", "A firewall rule chain that must be evaluated sequentially to determine packet filtering results."], e:"ACL attack paths chain permissions (e.g., GenericWrite→RBCD→impersonation) across multiple objects. BloodHound's graph analysis reveals these multi-hop paths that manual review would miss."},
{c:"ACL & GPO Abuse", q:"How can 'AddMember' permission on a group be abused for privilege escalation?", a:"Add a controlled account to the group, inheriting all permissions granted to that group.", d:["Enumerate all existing members of the group and read their confidential attribute values.", "Modify the group's managed-by attribute to take administrative ownership of the group.", "Delete the group from the directory, removing all members' permissions simultaneously."], e:"AddMember (WriteProperty on the member attribute) allows adding any principal to the group. If the group has privileged access (e.g., Server Operators), this grants those privileges."},
{c:"ACL & GPO Abuse", q:"What is the AdminSDHolder mechanism, and how can its ACL be abused for persistence?", a:"It stamps its ACL onto privileged accounts hourly, so backdooring it persists ACL changes.", d:["It rotates the krbtgt account password every sixty minutes to prevent golden ticket abuse.", "It synchronises GPO settings to all domain controllers via the SYSVOL replication service.", "It validates Kerberos ticket signatures against the KDC certificate store every hour."], e:"AdminSDHolder's ACL is applied to all protected accounts (Domain Admins, etc.) every 60 minutes by SDProp. Adding an attacker ACE to AdminSDHolder creates a persistent backdoor."},

// --- 8. DOMAIN DOMINANCE — 10 questions ---
{c:"Domain Dominance", q:"After obtaining Domain Admin privileges, what is typically the first credential extraction step?", a:"Performing a DCSync attack to dump the krbtgt hash and all domain account hashes.", d:["Running a port scan of the entire network to discover additional domain controllers.", "Installing a keylogger on the domain controller to capture future admin logon events.", "Modifying the default domain password policy to allow all future passwords to be blank."], e:"DCSync (using secretsdump or mimikatz lsadump::dcsync) is the standard first step after DA, extracting the krbtgt hash (for Golden Tickets) and all domain credentials."},
{c:"Domain Dominance", q:"What is the significance of the krbtgt account in maintaining domain dominance?", a:"Its hash encrypts all TGTs, so possessing it allows forging tickets for any user indefinitely.", d:["It is the default service account for all SQL Server instances registered in the domain.", "It controls the replication schedule between domain controllers in different AD sites.", "It is the account that the ADCS certificate authority uses to sign all issued certificates."], e:"The krbtgt account's key encrypts all TGTs in the domain. With its hash, an attacker can forge Golden Tickets for any identity, maintaining access until the hash is changed twice."},
{c:"Domain Dominance", q:"Why must the krbtgt password be reset twice to fully invalidate Golden Tickets?", a:"The KDC retains the current and previous password, so both must be rotated to invalidate.", d:["The first reset only changes the password on the PDC emulator and the second syncs to all.", "Active Directory stores three generations of krbtgt keys and needs two resets to cycle them.", "The first reset clears the in-memory cache and the second clears the on-disk ntds.dit copy."], e:"The KDC accepts tickets encrypted with both the current and previous krbtgt password. Two resets ensure both stored keys are attacker-unknown, invalidating forged tickets."},
{c:"Domain Dominance", q:"What is a Skeleton Key attack, and where is it deployed?", a:"A memory patch on the DC's LSASS that allows authentication with a master password for any user.", d:["A registry modification on client workstations that disables the local security authority.", "A DNS poisoning attack that redirects all Kerberos traffic to an attacker-controlled KDC.", "A Group Policy change that adds a universal backdoor account to every machine's admin group."], e:"Skeleton Key (deployed via mimikatz misc::skeleton on a DC) patches LSASS in memory, allowing any account to authenticate with a master password while legitimate passwords still work."},
{c:"Domain Dominance", q:"What is DCShadow, and how does it differ from DCSync?", a:"DCShadow registers a rogue DC to push malicious changes, while DCSync only reads replication data.", d:["DCShadow extracts password hashes via replication, while DCSync modifies directory objects.", "DCShadow targets the backup domain controllers only, while DCSync targets the primary DC.", "DCShadow operates over LDAP on port 389 only, while DCSync uses Kerberos on port 88."], e:"DCShadow temporarily registers the attacker's machine as a domain controller, then uses replication to push arbitrary changes (like modifying SID History), while DCSync only reads data."},
{c:"Domain Dominance", q:"What does dumping the DPAPI domain backup key allow an attacker to do?", a:"Decrypt any domain user's DPAPI-protected secrets, including browser passwords and credentials.", d:["Decrypt the BitLocker recovery keys for all encrypted volumes stored in Active Directory.", "Decrypt the TLS private keys used by all web servers that have certificates from the domain CA.", "Decrypt the Kerberos session keys embedded in all currently valid ticket-granting tickets."], e:"The DPAPI domain backup key (extractable via mimikatz lsadump::backupkeys) can decrypt any domain user's DPAPI master keys, providing access to all their protected secrets."},
{c:"Domain Dominance", q:"After domain compromise, what ADCS-based action provides long-term credential access?", a:"Stealing the CA private key to forge certificates for any user, enabling persistent authentication.", d:["Revoking all existing certificates to force users to re-enrol with weaker key parameters.", "Publishing a new CRL distribution point that serves forged revocation list information.", "Modifying the CA audit policy to suppress all certificate issuance logging and events."], e:"Extracting the CA private key (DPAPI-protected on the CA server) allows forging certificates for any user. These certificates enable PKINIT authentication independently of password changes."},
{c:"Domain Dominance", q:"What is the significance of the 'Domain Controllers' group SID in forged Kerberos tickets?", a:"Including the DC group SID (S-1-5-21-<domain>-516) in a ticket grants replication privileges.", d:["Including the DC group SID causes the ticket to be accepted by all trusting forest domains.", "Including the DC group SID automatically extends the ticket lifetime to ten years from issuance.", "Including the DC group SID bypasses all Group Policy restrictions applied to standard users."], e:"Adding the Domain Controllers group SID to a Golden Ticket's PAC grants the forged identity DCSync replication rights, as DCs are authorised for directory replication by default."},
{c:"Domain Dominance", q:"What tool can extract all Active Directory objects and attributes for comprehensive offline analysis?", a:"ADExplorer snapshots or ldapdomaindump, which export full directory data for offline review.", d:["Autoruns, which only enumerates auto-start programs and scheduled tasks on local machines.", "Process Monitor, which only captures real-time file system and registry activity on one host.", "Network Monitor, which only captures raw network packet data on the local interface adapter."], e:"ADExplorer (Sysinternals) can take snapshots of the entire directory, and ldapdomaindump exports users, groups, computers, and policies for thorough offline analysis and documentation."},
{c:"Domain Dominance", q:"What operational security consideration should an attacker address when using DCSync?", a:"DCSync generates Windows event 4662 for directory replication, which may trigger SOC alerts.", d:["DCSync requires physical access to the domain controller hardware serial console port.", "DCSync only works during the scheduled replication window defined in the AD site topology.", "DCSync causes visible network outages on all domain-joined workstations during execution."], e:"DCSync generates event ID 4662 (an object operation was performed) with replication-specific GUIDs. Security monitoring solutions often alert on non-DC sources performing replication."},

// --- 9. PERSISTENCE — 10 questions ---
{c:"Persistence", q:"How does adding a Security Identifier (SID) to an account's SID History enable persistence?", a:"The SID is included in all authentication tokens, granting access associated with that SID.", d:["The SID replaces the account's primary security identifier permanently in the database.", "The SID is only evaluated during interactive logon at the domain controller console.", "The SID is used to encrypt Kerberos tickets in place of the standard account password."], e:"SID History was designed for migration. Adding a privileged SID (e.g., Domain Admins) to SID History grants those privileges transparently, as the SID appears in all Kerberos PACs."},
{c:"Persistence", q:"What is a computer account-based persistence technique using machine accounts?", a:"Creating a machine account with known credentials and adding it to privileged groups.", d:["Installing a rootkit on the hardware firmware of a domain-joined computer endpoint.", "Cloning an existing computer's SID to create a duplicate object in Active Directory.", "Modifying the computer's BIOS boot sequence to load a pre-OS implant at startup."], e:"Machine accounts created with known passwords (via Impacket addcomputer.py) can be added to groups like Domain Admins or configured for RBCD, providing persistent access."},
{c:"Persistence", q:"What registry key is commonly abused for persistence on compromised Windows hosts in AD environments?", a:"HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run for automatic execution at user logon.", d:["HKLM\SYSTEM\CurrentControlSet\Services\DNS\Parameters for DNS service configuration.", "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon for shell replacement.", "HKLM\SECURITY\Policy\Secrets for LSA secret storage and service account credentials."], e:"The Run registry key executes specified programs at every user logon. Attackers place payloads here (or in RunOnce, or the Startup folder) for persistence on compromised hosts."},
{c:"Persistence", q:"How does the AdminSDHolder persistence mechanism work?", a:"Backdoored ACEs on AdminSDHolder are reapplied to all protected accounts every sixty minutes.", d:["A modified AdminSDHolder template forces all new user accounts to join the Domain Admins.", "The AdminSDHolder backup task exports domain credentials to a hidden share every hour.", "A corrupted AdminSDHolder object causes the KDC to accept expired Kerberos tickets always."], e:"SDProp runs every 60 minutes, copying AdminSDHolder's DACL to all protected groups and accounts. A backdoor ACE on AdminSDHolder persists even if removed from the target objects."},
{c:"Persistence", q:"What is a Golden Certificate, and how does it differ from a Golden Ticket?", a:"A forged certificate using the stolen CA key, enabling PKINIT auth independent of password changes.", d:["A Kerberos TGT forged using the krbtgt hash, granting access to all services in the domain.", "A self-signed TLS certificate installed on the domain controller for LDAPS communication.", "A SAML assertion token forged using the ADFS signing certificate for federated applications."], e:"A Golden Certificate is forged using the stolen CA private key. Unlike Golden Tickets (invalidated by krbtgt rotation), certificates remain valid until the CA key or certificate is revoked."},
{c:"Persistence", q:"How can a rogue domain controller be used for persistence via DCShadow?", a:"By pushing malicious attribute changes through replication that are difficult to detect or remove.", d:["By permanently registering as a legitimate domain controller in the Sites and Services config.", "By intercepting and modifying all LDAP queries passing between clients and real domain controllers.", "By replacing the ntds.dit on legitimate domain controllers with a modified copy over the network."], e:"DCShadow creates a temporary rogue DC to inject changes (SID History, SPNs, ACLs) through replication. These changes are treated as legitimate replication data, making them hard to detect."},
{c:"Persistence", q:"What is a security descriptor-based persistence technique on Active Directory objects?", a:"Adding hidden deny ACEs or allow ACEs that grant an attacker access while blocking legitimate cleanup.", d:["Encrypting the security descriptor with a custom key that only the attacker can decrypt.", "Storing a backdoor password in the security descriptor's SACL (System Access Control List).", "Replacing the security descriptor with a null value to make the object invisible to LDAP."], e:"Attackers can add subtle ACEs to DACLs on critical objects (domain root, AdminSDHolder, GPOs) that grant persistent access while being difficult to spot in manual security reviews."},
{c:"Persistence", q:"What Windows mechanism can execute code at boot time before user logon, providing stealthy persistence?", a:"Windows services configured for automatic start, which run as SYSTEM before any user logs on.", d:["Screensaver executables configured in the user's profile, which run after an idle timeout.", "Scheduled tasks triggered by user logon events, which run in the context of the logon user.", "Startup folder shortcuts in the current user's profile, which run after interactive logon."], e:"Windows services set to auto-start execute as SYSTEM at boot. An attacker creating a malicious service (sc create) gains persistence that runs before user interaction."},
{c:"Persistence", q:"How can modifying the default domain Group Policy Object provide persistence?", a:"Adding logon scripts or scheduled tasks to the Default Domain Policy affects all domain systems.", d:["Deleting the Default Domain Policy forces all clients to use locally cached policy settings.", "Renaming the Default Domain Policy prevents Group Policy from applying to any objects at all.", "Linking a new GPO above the Default Domain Policy in precedence blocks all inherited settings."], e:"The Default Domain Policy GPO is linked at the domain root and applies to all users and computers. Modifying it to include malicious startup scripts or tasks provides domain-wide persistence."},
{c:"Persistence", q:"What makes certificate-based persistence more resilient than password-based backdoors?", a:"Certificates remain valid regardless of password resets and have configurable multi-year lifetimes.", d:["Certificates are stored in tamper-proof hardware modules on every domain-joined workstation.", "Certificates automatically renew themselves without any interaction from the user or attacker.", "Certificates can only be revoked by physically accessing the certificate authority server console."], e:"Certificate-based persistence (via PKINIT) survives password changes, krbtgt rotation, and most incident response actions. Certificates can have long lifetimes and require explicit revocation."},

// --- 10. ADCS ATTACKS — 8 questions ---
{c:"ADCS Attacks", q:"What is ESC1, the most commonly exploited AD Certificate Services misconfiguration?", a:"A template allowing requesters to specify a Subject Alternative Name for any user identity.", d:["A template with an overly long validity period exceeding the standard two-year maximum.", "A template restricted to domain controllers only that cannot be requested by standard users.", "A template requiring manager approval before the certificate authority issues the certificate."], e:"ESC1 occurs when a certificate template allows the enrollee to supply a Subject Alternative Name (SAN). An attacker specifies a DA's UPN in the SAN and authenticates as that user via PKINIT."},
{c:"ADCS Attacks", q:"What is ESC8, and which ADCS component does it target?", a:"NTLM relay to the AD CS HTTP web enrollment endpoint to request certificates as the victim.", d:["Kerberos delegation abuse against the certificate authority's DCOM registration interface.", "SQL injection in the certificate authority's database to modify issued certificate attributes.", "Buffer overflow in the certificate authority's OCSP responder service for code execution."], e:"ESC8 targets the Certificate Authority Web Enrollment (certsrv) or Certificate Enrollment Service (CES) HTTP endpoints, relaying coerced NTLM authentication to request certificates."},
{c:"ADCS Attacks", q:"What tool is primarily used to enumerate and exploit AD Certificate Services misconfigurations?", a:"Certipy, which can find vulnerable templates, request certificates, and authenticate with them.", d:["Hashcat, which is primarily used to crack captured password hashes using GPU acceleration.", "CrackMapExec, which is primarily used for mass credential testing across SMB shares.", "PowerView, which is primarily used for Active Directory object enumeration via PowerShell."], e:"Certipy (by ly4k) is the primary tool for ADCS attacks — it enumerates templates, identifies ESC1-ESC8 vulnerabilities, requests/forges certificates, and performs PKINIT authentication."},
{c:"ADCS Attacks", q:"What is ESC4, and how does it enable privilege escalation through certificate templates?", a:"Write access to a certificate template object, allowing modification to create an ESC1 condition.", d:["A template misconfiguration where the certificate validity period exceeds fifty years total.", "A CA configuration that accepts certificate requests over unencrypted HTTP without TLS.", "A template that uses RSA 1024-bit keys which are weak enough to factor mathematically."], e:"ESC4 occurs when an attacker has write access to a template object. They can modify it to enable the CT_FLAG_ENROLLEE_SUPPLIES_SUBJECT flag, effectively creating an ESC1 vulnerability."},
{c:"ADCS Attacks", q:"What is the 'Certified Pre-Owned' research, and what did it reveal about ADCS security?", a:"A comprehensive study documenting eight escalation paths (ESC1-ESC8) in AD Certificate Services.", d:["A Microsoft security bulletin patching a single critical vulnerability in the certificate authority.", "An automated scanning tool that only tests for weak key lengths in issued certificates.", "A compliance framework for auditing certificate lifecycle management in enterprise environments."], e:"'Certified Pre-Owned' by SpecterOps documented ESC1-ESC8, systematic ADCS attack paths from template misconfigurations to NTLM relay, fundamentally changing AD security assessments."},
{c:"ADCS Attacks", q:"What does ESC6 exploit regarding the certificate authority configuration?", a:"The EDITF_ATTRIBUTESUBJECTALTNAME2 flag on the CA, allowing SAN specification in any request.", d:["The absence of a certificate revocation list distribution point in the CA configuration setup.", "The use of SHA-1 instead of SHA-256 for the certificate authority's root certificate signature.", "The presence of an expired intermediate CA certificate in the authority information access chain."], e:"ESC6 exploits the EDITF_ATTRIBUTESUBJECTALTNAME2 flag enabled on the CA itself, which allows any requester to specify a SAN in any certificate request, regardless of template settings."},
{c:"ADCS Attacks", q:"How can a compromised CA certificate private key be used for long-term domain persistence?", a:"Forge certificates for any domain user or computer, enabling PKINIT authentication as that principal.", d:["Decrypt all previously captured TLS traffic between domain clients and web application servers.", "Sign malicious Windows kernel drivers that bypass driver signature enforcement on all clients.", "Generate valid code-signing certificates that pass SmartScreen and application control policies."], e:"Extracting the CA private key (DPAPI-protected on the CA server) allows forging certificates for any user. These certificates enable PKINIT authentication independently of password changes."},
{c:"ADCS Attacks", q:"What does ESC7 exploit regarding the certificate authority's access control configuration?", a:"The ManageCA or ManageCertificates permissions, enabling approval of pending certificate requests.", d:["The Enroll permission on all templates, which is granted to Domain Users group by default.", "The AutoEnroll permission on the computer template, triggering machine certificate issuance.", "The Read permission on the CA's private key container stored in the registry key database."], e:"ESC7 targets the ManageCA permission (which allows modifying CA configuration) or ManageCertificates (which allows approving pending requests), enabling certificate issuance for escalation."},

// --- 11. TRUST & FOREST ATTACKS — 8 questions ---
{c:"Trust & Forest Attacks", q:"What is SID filtering, and why is it critical for forest trust security?", a:"It removes SIDs from foreign forests in authentication tokens, preventing cross-forest escalation.", d:["It restricts which user SIDs can be assigned to new accounts created in a child domain.", "It encrypts all SID values in Kerberos tickets crossing trust boundaries for confidentiality.", "It validates that SIDs in access tokens match the account's primary domain SID format only."], e:"SID filtering (quarantine) strips SIDs from tokens that don't belong to the trusted domain's SID range, preventing SID History abuse and cross-forest privilege escalation via forged PACs."},
{c:"Trust & Forest Attacks", q:"What is the difference between a parent-child trust and a forest trust in Active Directory?", a:"Parent-child trusts are within a forest with no SID filtering; forest trusts are between forests with filtering.", d:["Parent-child trusts use NTLM authentication only; forest trusts use Kerberos authentication only.", "Parent-child trusts are one-way by default; forest trusts are always two-way and transitive.", "Parent-child trusts share the same krbtgt key; forest trusts share a common CA certificate."], e:"Parent-child trusts (intra-forest) are automatic and transitive without SID filtering by default. Forest trusts are between separate forests with SID filtering enabled, limiting escalation."},
{c:"Trust & Forest Attacks", q:"How can an attacker escalate from a child domain to the forest root domain?", a:"Forge a Golden Ticket with the Enterprise Admins SID injected into the PAC's SID History.", d:["Reset the forest root domain's krbtgt password from the child domain controller console.", "Modify the trust direction from the child domain to make it one-way towards the root.", "Create a new forest trust between the child domain and an external attacker-owned forest."], e:"Within a forest, SID filtering is not enforced on parent-child trusts. An attacker with the child's krbtgt hash forges a Golden Ticket containing the Enterprise Admins SID (from the root domain)."},
{c:"Trust & Forest Attacks", q:"What is the trust key, and how is it used in cross-domain Kerberos authentication?", a:"A shared secret between trusted domains used to encrypt inter-realm Kerberos referral tickets.", d:["The krbtgt hash of the trusting domain shared with all administrators in the trusted domain.", "A certificate issued by both domains' CAs used for mutual TLS during LDAP replication sync.", "An AES master key stored in the forest root that encrypts all cross-domain NTLM traffic."], e:"The trust key (inter-realm key) is a shared secret used to encrypt TGTs for cross-domain referrals. Compromising it allows forging inter-realm tickets for cross-domain access."},
{c:"Trust & Forest Attacks", q:"What is a selective authentication trust, and how does it limit attack surface?", a:"It requires explicit permissions for users in the trusted forest to access specific resources only.", d:["It restricts authentication to NTLM only and disables Kerberos across the trust relationship.", "It limits the number of concurrent user sessions allowed across the trust to a fixed maximum.", "It allows authentication only during business hours defined in the trust configuration policy."], e:"Selective authentication trusts require explicit 'Allowed to Authenticate' permissions on resources, limiting which trusted forest users can access what, reducing the blast radius of compromise."},
{c:"Trust & Forest Attacks", q:"What is the PAC (Privilege Attribute Certificate) in a Kerberos ticket, and why is it important for trust attacks?", a:"It contains the user's group SIDs and privileges, which the target service uses for authorisation.", d:["It contains the encrypted session key shared between the client and the ticket-granting service.", "It contains the digital certificate chain used to validate the KDC's identity to the client.", "It contains the network routing information needed to forward the ticket across VPN tunnels."], e:"The PAC carries the user's SIDs, group memberships, and privilege information. Forging or manipulating the PAC (in Golden/Silver Tickets) directly controls authorisation decisions."},
{c:"Trust & Forest Attacks", q:"What makes forest trusts a harder escalation boundary than domain trusts within a forest?", a:"SID filtering on forest trusts strips foreign SIDs, preventing SID History-based escalation.", d:["Forest trusts use a different Kerberos encryption type that cannot be forged with known tools.", "Forest trusts require hardware smart card authentication that cannot be bypassed remotely.", "Forest trusts encrypt all referral tickets with a quantum-resistant algorithm preventing forgery."], e:"Forest trusts enforce SID filtering, stripping SIDs that don't belong to the trusted domain. This prevents adding Enterprise Admins or Domain Admins SIDs from the target forest."},
{c:"Trust & Forest Attacks", q:"What is the TGT delegation vulnerability across trusts, and how can it be exploited?", a:"Unconstrained delegation across trusts allows capturing TGTs from users in other trusted domains.", d:["Constrained delegation across trusts allows resetting passwords of users in the foreign domain.", "RBCD across trusts allows modifying group memberships of accounts in the trusted forest root.", "Protocol transition across trusts allows issuing Kerberos tickets without the inter-realm key."], e:"If a server in Domain A has unconstrained delegation and a user from trusted Domain B authenticates, their TGT is cached. The attacker can extract and use it to access Domain B resources."},

// --- 12. TOOLS & METHODOLOGY — 10 questions ---
{c:"Tools & Methodology", q:"What is BloodHound's primary purpose in Active Directory penetration testing?", a:"Mapping attack paths by visualising relationships between AD objects and their permissions.", d:["Performing automated exploitation of known CVEs against domain controllers and endpoints.", "Conducting brute-force password attacks against all discovered user accounts in the domain.", "Scanning network ports to identify running services on all domain-joined computer systems."], e:"BloodHound ingests AD data (via SharpHound) and uses graph theory to map attack paths — showing shortest routes to Domain Admin through group memberships, ACLs, sessions, and trusts."},
{c:"Tools & Methodology", q:"What is Impacket, and which programming language is it implemented in?", a:"A Python library of network protocol implementations for interacting with Windows systems.", d:["A C# framework for compiling and executing .NET assemblies in memory on Windows targets.", "A PowerShell module for managing Active Directory objects and Group Policy in the domain.", "A Go toolkit for building cross-platform implants used in command and control frameworks."], e:"Impacket is a Python collection implementing SMB, MSRPC, Kerberos, LDAP, and other Windows protocols. Its tools (secretsdump, wmiexec, getTGT, ntlmrelayx) are essential for AD pentesting."},
{c:"Tools & Methodology", q:"What is Rubeus, and what AD attack category does it primarily support?", a:"A C# tool for Kerberos abuse including ticket requests, roasting, forgery, and delegation attacks.", d:["A Python tool for NTLM relay attacks including hash capture and credential forwarding.", "A PowerShell tool for LDAP enumeration including user, group, and OU object discovery.", "A Go tool for password spraying including lockout-aware throttling and proxy rotation."], e:"Rubeus is a C# Kerberos interaction tool supporting AS-REP Roasting, Kerberoasting, ticket extraction/injection (pass-the-ticket), S4U delegation abuse, and ticket forging."},
{c:"Tools & Methodology", q:"What is CrackMapExec (NetExec), and what operational use case is it designed for?", a:"A post-exploitation tool for mass credential validation and command execution across networks.", d:["A vulnerability scanner that identifies missing patches on Windows servers and workstations.", "A social engineering toolkit for generating phishing emails and credential harvesting pages.", "A wireless network auditing tool for capturing WPA2 handshakes and performing key recovery."], e:"CrackMapExec (now NetExec) automates credential testing across SMB, LDAP, WinRM, MSSQL, and more. It identifies where credentials work and enables mass command execution."},
{c:"Tools & Methodology", q:"What is the recommended order of operations when beginning an AD penetration test?", a:"Enumerate first (users, groups, trusts, ACLs), then identify attack paths before exploitation.", d:["Exploit the first vulnerability found immediately, then enumerate the network post-compromise.", "Begin with password spraying against all users, then use valid credentials to map the domain.", "Start by running Mimikatz on the first available machine, then pivot using captured hashes."], e:"Methodical AD pentesting starts with thorough enumeration (LDAP, DNS, SMB, BloodHound), identifying high-value targets and attack paths, before attempting exploitation and lateral movement."},
{c:"Tools & Methodology", q:"What is PowerView, and how does it differ from the built-in ActiveDirectory PowerShell module?", a:"An offensive PowerShell tool with enumeration functions not available in the standard AD module.", d:["A Microsoft-signed module that can only be run on domain controllers with admin privileges.", "A GUI application for visually browsing the Active Directory object tree in a file explorer.", "A Linux command-line tool that queries Active Directory over LDAP using Python bindings."], e:"PowerView (part of PowerSploit) provides offensive enumeration functions like Find-LocalAdminAccess, Get-DomainObjectAcl, and Get-NetSession that aren't in the standard AD module."},
{c:"Tools & Methodology", q:"When should password spraying be performed during an AD assessment, and what precaution is essential?", a:"After enumerating the password policy to determine lockout thresholds and observation windows.", d:["Before any enumeration, as it provides the fastest path to initial domain-authenticated access.", "Only on the last day of the engagement as a final resort if all other attack vectors have failed.", "At any time without precaution, since domain accounts cannot be locked out by default policy."], e:"Password spraying must respect the lockout policy (threshold, observation window, reset time). Spraying without checking the policy risks locking out accounts and disrupting the client."},
{c:"Tools & Methodology", q:"What is Covenant/Grunt or Sliver, and what role does it play in an AD penetration test?", a:"Command and control (C2) frameworks for managing implants and coordinating post-exploitation.", d:["Static analysis tools for reviewing Active Directory Group Policy Object template XML files.", "Network traffic capture tools for extracting cleartext credentials from unencrypted protocols.", "Vulnerability management platforms for tracking and reporting identified security weaknesses."], e:"C2 frameworks (Covenant, Sliver, Mythic) manage implants on compromised hosts, providing encrypted communication channels, task execution, and coordination for lateral movement."},
{c:"Tools & Methodology", q:"What is the purpose of running SharpHound with the --Loop flag during an assessment?", a:"It continuously collects session data to capture ephemeral admin logons over a longer time window.", d:["It repeats the full data collection including ACLs and trusts every five minutes indefinitely.", "It loops through each domain controller sequentially to ensure complete LDAP data collection.", "It retries failed LDAP queries until the domain controller responds to ensure data completeness."], e:"SharpHound's --Loop flag repeatedly collects session data (who is logged in where) over time, catching administrators who log in temporarily and creating more complete attack paths."},
{c:"Tools & Methodology", q:"What is the significance of the 'Owned' and 'High Value' markings in BloodHound?", a:"They mark compromised nodes and priority targets to calculate shortest paths between them.", d:["They generate automated exploitation scripts for each marked node in the graph database.", "They send email alerts to the security team about compromised accounts in real time.", "They trigger automatic password resets for all accounts connected to the marked nodes."], e:"Marking nodes as 'Owned' (compromised) and 'High Value' (targets like DA) lets BloodHound compute shortest attack paths, showing the most efficient routes to domain dominance."}
];
const MASTER_POOL = pool;
