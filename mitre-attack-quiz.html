<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MITRE ATT&CK Framework Knowledge Quiz</title>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;600;700&family=Outfit:wght@400;500;600;700;900&display=swap');
    :root { --header:#120a1e; --bg:#0a0612; --white:#1a1028; --primary:#bf5af2; --success:#30d158; --danger:#ff453a; --warning:#ffd60a; --text:#c8c0d8; --card:#14101f; --accent:#0a84ff; --border:#2a1e3e; }
    ::-webkit-scrollbar { width:10px; } ::-webkit-scrollbar-track { background:#06030c; } ::-webkit-scrollbar-thumb { background:#bf5af2; border-radius:5px; border:2px solid #06030c; }
    * { box-sizing:border-box; }
    body { font-family:'Outfit',sans-serif; background:var(--bg); color:var(--text); margin:0; display:flex; flex-direction:column; height:100vh; overflow:hidden; }
    .header { background:linear-gradient(135deg, #120a1e 0%, #1a1028 50%, #180e28 100%); color:#fff; padding:15px 30px; display:flex; justify-content:space-between; align-items:center; box-shadow:0 4px 20px rgba(191,90,242,0.1); flex-shrink:0; z-index:10; border-bottom:2px solid var(--primary); }
    .header-title { font-family:'Fira Code',monospace; font-size:1.3em; font-weight:700; letter-spacing:1px; }
    .header-title span { color:var(--primary); }
    .header-title .sub { color:#5a4e6e; font-size:0.65em; letter-spacing:2px; }
    .progress-text { font-family:'Fira Code',monospace; font-size:1.1em; font-weight:700; color:var(--warning); background:rgba(0,0,0,0.4); padding:6px 18px; border-radius:6px; border:1px solid rgba(255,214,10,0.25); }
    .main { display:flex; flex:1; overflow:hidden; }
    .sidebar { width:260px; background:#0d0818; border-right:1px solid var(--border); overflow-y:auto; padding:12px; display:grid; grid-template-columns:repeat(5,1fr); gap:6px; align-content:start; flex-shrink:0; }
    .nav-btn { height:34px; border:1px solid var(--border); background:#140e20; cursor:pointer; font-weight:700; font-size:0.82em; border-radius:5px; transition:all 0.15s; color:#4a3e60; font-family:'Fira Code',monospace; }
    .nav-btn:hover { background:#221838; color:#a090c0; border-color:#bf5af2; }
    .nav-btn.active { background:var(--primary); color:#fff; border-color:var(--primary); box-shadow:0 0 10px rgba(191,90,242,0.4); }
    .nav-btn.answered-correct { background:#0a2010; border-color:var(--success); color:#4ade80; }
    .nav-btn.answered-wrong { background:#2d0a0a; border-color:var(--danger); color:#f87171; }
    .nav-btn.flagged { border:2px solid var(--warning); box-shadow:0 0 8px rgba(255,214,10,0.3); }
    .content { flex:1; padding:35px; overflow-y:auto; display:flex; justify-content:center; align-items:flex-start; }
    .card { background:var(--card); max-width:900px; width:100%; padding:45px; border-radius:12px; box-shadow:0 8px 32px rgba(0,0,0,0.3); margin-bottom:40px; border:1px solid var(--border); }
    .q-meta { display:flex; justify-content:space-between; align-items:center; margin-bottom:22px; border-bottom:1px solid var(--border); padding-bottom:14px; }
    .tag { background:var(--primary); color:#fff; padding:5px 14px; border-radius:20px; font-size:0.72em; font-weight:700; text-transform:uppercase; letter-spacing:1px; font-family:'Fira Code',monospace; }
    .q-num { color:#3e3458; font-family:'Fira Code',monospace; font-size:0.9em; }
    .q-text { font-size:1.25em; font-weight:600; margin-bottom:30px; line-height:1.55; color:#e0d8ee; }
    .option { width:100%; text-align:left; padding:16px 22px; margin-bottom:12px; background:#0d0818; border:2px solid var(--border); border-radius:8px; cursor:pointer; font-size:1.05em; transition:all 0.2s; color:#9088a8; display:block; font-family:'Outfit',sans-serif; }
    .option:hover:not(.locked) { border-color:#bf5af2; background:#1a1230; color:#c8c0d8; }
    .option.locked { cursor:default; }
    .option.opt-correct { border-color:var(--success); background:rgba(48,209,88,0.08); color:#4ade80; font-weight:700; }
    .option.opt-wrong { border-color:var(--danger); background:rgba(255,69,58,0.06); color:#f87171; }
    .option.opt-dim { opacity:0.4; }
    .explanation-box { margin-top:24px; padding:18px 22px; background:rgba(10,132,255,0.06); border:1px solid rgba(10,132,255,0.18); border-radius:8px; font-size:1em; color:#8ab0d8; line-height:1.6; }
    .explanation-box strong { color:#a0c8f0; }
    .next-btn-wrap { text-align:center; margin-top:22px; }
    .footer { background:#0d0818; padding:14px 35px; border-top:1px solid var(--border); display:flex; justify-content:space-between; align-items:center; flex-shrink:0; }
    .btn { padding:11px 28px; border:none; border-radius:6px; font-size:1.05em; font-weight:700; cursor:pointer; color:white; font-family:'Outfit',sans-serif; transition:all 0.2s; }
    .btn:hover { transform:translateY(-1px); }
    .btn-s { background:#221838; } .btn-s:hover { background:#302448; }
    .btn-p { background:var(--primary); } .btn-p:hover { background:#a848d8; }
    .btn-w { background:var(--warning); color:#111; } .btn-w:hover { background:#e0c000; }
    .btn-g { background:var(--success); color:#000; } .btn-g:hover { background:#28b848; }
    #start-screen, #results-screen { position:fixed; top:0; left:0; width:100%; height:100%; background:var(--bg); z-index:2000; overflow-y:auto; }
    .center-wrapper { display:flex; flex-direction:column; align-items:center; justify-content:center; min-height:100vh; padding:40px; box-sizing:border-box; }
    .start-box { background:var(--card); padding:60px; border-radius:16px; box-shadow:0 20px 60px rgba(0,0,0,0.4); max-width:850px; text-align:center; border:1px solid var(--border); position:relative; overflow:hidden; }
    .start-box::before { content:''; position:absolute; top:0; left:0; right:0; height:4px; background:linear-gradient(90deg, var(--primary), var(--accent), var(--primary)); }
    .start-box h1 { color:#fff; margin-bottom:8px; font-size:2.8em; font-family:'Fira Code',monospace; letter-spacing:2px; }
    .start-box h1 span { color:var(--primary); }
    .start-box .subtitle { font-size:1em; color:#5a4e6e; margin-bottom:30px; font-family:'Fira Code',monospace; letter-spacing:3px; text-transform:uppercase; }
    .start-box p { font-size:1.15em; line-height:1.7; color:#6a5e80; margin:25px 0; }
    .start-box .stats { display:flex; justify-content:center; gap:40px; margin:30px 0; }
    .start-box .stat { text-align:center; }
    .start-box .stat-num { font-size:2.2em; font-weight:900; color:var(--primary); font-family:'Fira Code',monospace; }
    .start-box .stat-label { font-size:0.85em; color:#5a4e6e; text-transform:uppercase; letter-spacing:2px; margin-top:4px; }
    .score-circle { width:200px; height:200px; border-radius:50%; display:flex; justify-content:center; align-items:center; font-size:3.8em; font-weight:900; color:white; margin:20px auto; box-shadow:0 10px 30px rgba(0,0,0,0.3); font-family:'Fira Code',monospace; background:linear-gradient(135deg, #1a0e30, #2a1848); border:6px solid #1a0e30; }
    .review-item { text-align:left; background:var(--card); padding:22px; margin-bottom:16px; border-radius:10px; border-left:6px solid #2a1e3e; width:100%; max-width:800px; box-shadow:0 2px 10px rgba(0,0,0,0.2); border:1px solid var(--border); }
    .review-item.correct { border-left-color:var(--success); }
    .review-item.wrong { border-left-color:var(--danger); }
    .review-item strong { color:#e0d8ee; }
    .review-explanation { margin-top:12px; font-size:0.92em; color:#7a6e98; background:rgba(10,132,255,0.06); padding:14px; border-radius:6px; border:1px solid rgba(10,132,255,0.12); }
    #status { font-weight:700; color:#5a4e6e; font-size:1.05em; font-family:'Fira Code',monospace; }
</style>
</head>
<body>

<div id="start-screen">
    <div class="center-wrapper">
        <div class="start-box">
            <h1>MITRE <span>ATT&CK</span></h1>
            <div class="subtitle">Enterprise Framework Knowledge</div>
            <div class="stats">
                <div class="stat"><div class="stat-num">120</div><div class="stat-label">Questions</div></div>
                <div class="stat"><div class="stat-num">Self-paced</div><div class="stat-label">No Timer</div></div>
            </div>
            <p>
                Covers all 14 Enterprise Tactics: Reconnaissance, Resource Development, Initial Access,
                Execution, Persistence, Privilege Escalation, Defense Evasion, Credential Access,
                Discovery, Lateral Movement, Collection, Command &amp; Control, Exfiltration &amp; Impact.<br>
                Includes framework fundamentals, technique IDs, real-world procedures &amp; detection.<br>
                <em style="color:#5a4e6e;">Questions selected from a pool of 150+. Explanation shown after each answer.</em>
            </p>
            <button class="btn btn-p" onclick="initExam()" style="padding:16px 55px; font-size:1.25em; margin-top:10px;">Start Quiz</button>
        </div>
    </div>
</div>

<div class="header">
    <div class="header-title">MITRE <span>ATT&CK</span> Quiz <span class="sub">// Enterprise</span></div>
    <div id="progress-display" class="progress-text">0 / 120</div>
</div>

<div class="main" id="exam-ui" style="display:none;">
    <div class="sidebar" id="sidebar"></div>
    <div class="content" id="question-container"></div>
</div>

<div class="footer" id="footer" style="display:none;">
    <div><button class="btn btn-s" onclick="nav(-1)">Previous</button> <button class="btn btn-w" onclick="flag()" style="margin-left:10px;">Flag</button></div>
    <div id="status">Q 1 / 120</div>
    <div><button class="btn btn-g" id="finish-btn" onclick="finish()" style="display:none;">Finish Quiz</button></div>
</div>

<div id="results-screen" style="display:none;">
    <div class="center-wrapper" style="justify-content:flex-start; padding-top:50px;">
        <div style="background:var(--card); padding:40px; border-radius:12px; max-width:800px; width:100%; box-shadow:0 10px 40px rgba(0,0,0,0.3); text-align:center; border:1px solid var(--border);">
            <h1 style="margin:0; color:#fff; font-family:'Fira Code',monospace;">Quiz Results</h1>
            <div id="score-circle" class="score-circle">0%</div>
            <div id="raw-score" style="font-size:1.2em; color:#6a5e80; margin-bottom:25px; font-family:'Fira Code',monospace;"></div>
            <button class="btn btn-p" onclick="location.reload()">Take New Quiz</button>
        </div>
        <div id="review-list" style="width:100%; max-width:800px; margin-top:25px;"></div>
    </div>
</div>

<script>
const pool = [
    // ===== FRAMEWORK FUNDAMENTALS (15) =====
    {c:"Framework Fundamentals", q:"What does the acronym ATT&CK stand for in the MITRE ATT&CK framework?", a:"Adversarial Tactics, Techniques, and Common Knowledge — a structured knowledge base of cyber threats.", d:["Advanced Threat Tracking and Comprehensive Knowledge — a database of malware signatures and indicators.", "Automated Threat Taxonomy and Categorised Knowledge — an AI-driven classification system for attacks.", "Adversary Tools, Threats, and Countermeasure Knowledge — a defensive mitigation and patching resource."], e:"ATT&CK stands for Adversarial Tactics, Techniques, and Common Knowledge. It was created by MITRE Corporation and publicly released in 2015 as a knowledge base grounded in real-world observations of adversary behaviour."},
    {c:"Framework Fundamentals", q:"How many tactics are included in the current MITRE ATT&CK Enterprise matrix?", a:"14 tactics, ranging from Reconnaissance through to Impact, covering the full attack lifecycle.", d:["7 tactics, aligned with the original Lockheed Martin Cyber Kill Chain phases and stages.", "10 tactics, matching the OWASP Top 10 categories for web application security vulnerabilities.", "21 tactics, providing one tactic per major operating system and cloud platform in the matrix."], e:"The Enterprise matrix contains 14 tactics: Reconnaissance, Resource Development, Initial Access, Execution, Persistence, Privilege Escalation, Defense Evasion, Credential Access, Discovery, Lateral Movement, Collection, Command and Control, Exfiltration, and Impact."},
    {c:"Framework Fundamentals", q:"In MITRE ATT&CK, what is the relationship between a 'tactic' and a 'technique'?", a:"A tactic is the adversary's goal (the 'why'), and a technique is the method used to achieve it (the 'how').", d:["A tactic is a specific tool used in an attack, and a technique is the configuration of that tool.", "A tactic is a detection rule written by defenders, and a technique is the alert it generates.", "A tactic is a vulnerability in software, and a technique is the exploit code that targets it."], e:"Tactics represent the adversary's tactical objective — why they perform an action. Techniques describe how the adversary achieves that objective. For example, the tactic 'Credential Access' can be achieved via the technique 'OS Credential Dumping'."},
    {c:"Framework Fundamentals", q:"What are 'sub-techniques' in the MITRE ATT&CK framework, and how do they relate to techniques?", a:"Sub-techniques describe more specific implementations of a parent technique in greater detail.", d:["Sub-techniques are deprecated techniques that have been removed from the current framework version.", "Sub-techniques are detection methods that defenders use to identify the parent technique in logs.", "Sub-techniques are alternative names used by different threat intelligence vendors for the same method."], e:"Sub-techniques provide granular detail on specific ways a technique can be implemented. For example, T1003 OS Credential Dumping has sub-techniques like T1003.001 (LSASS Memory), T1003.002 (Security Account Manager), and T1003.003 (NTDS)."},
    {c:"Framework Fundamentals", q:"Which three main matrices does MITRE ATT&CK maintain for different operational environments?", a:"Enterprise, Mobile, and Industrial Control Systems (ICS), each tailored to their respective platforms.", d:["Windows, Linux, and macOS, each containing platform-specific techniques and detection guidance.", "Network, Endpoint, and Cloud, organised by the infrastructure layer where attacks are observed.", "Offensive, Defensive, and Hybrid, categorised by whether the action is adversary or defender initiated."], e:"MITRE ATT&CK maintains three matrices: Enterprise (Windows, macOS, Linux, Cloud, Network, Containers), Mobile (Android, iOS), and ICS (Industrial Control Systems). Each covers platform-specific adversary behaviours."},
    {c:"Framework Fundamentals", q:"What platforms does the MITRE ATT&CK Enterprise matrix currently cover?", a:"Windows, macOS, Linux, Cloud (IaaS, SaaS), Network Devices, Containers, Identity Providers, and Office Suite.", d:["Only Windows, macOS, and Linux desktop operating systems in their most recent major versions.", "All platforms are covered under a single unified matrix with no platform-specific differentiation.", "Windows Server, Linux Server, and mainframe systems used in traditional enterprise data centres."], e:"The Enterprise matrix covers a broad set of platforms: Windows, macOS, Linux, PRE (pre-compromise), Office Suite, Identity Provider, SaaS, IaaS, Network Devices, Containers, and ESXi — reflecting the modern hybrid enterprise."},
    {c:"Framework Fundamentals", q:"What is a 'procedure' in MITRE ATT&CK terminology, and how does it differ from a technique?", a:"A procedure is a specific, real-world implementation of a technique by a particular threat actor or malware.", d:["A procedure is an abstract description of an attack method that has not yet been observed in the wild.", "A procedure is a defensive playbook that security teams follow to mitigate a specific known technique.", "A procedure is the unique identifier code assigned to each technique within the ATT&CK knowledge base."], e:"Procedures describe the actual, observed use of techniques by specific adversaries. For example, APT29 using rundll32.exe to execute a DLL payload is a procedure — a concrete implementation of the T1218.011 Rundll32 technique."},
    {c:"Framework Fundamentals", q:"How does MITRE ATT&CK differ from the Lockheed Martin Cyber Kill Chain model?", a:"ATT&CK provides granular technique-level detail and is continuously updated, while Kill Chain defines linear attack phases.", d:["ATT&CK focuses exclusively on pre-compromise activity, while Kill Chain covers the entire attack lifecycle.", "ATT&CK is a proprietary commercial framework, while Kill Chain is an open-source community-driven project.", "ATT&CK is designed only for incident response, while Kill Chain is used for offensive red team operations."], e:"The Cyber Kill Chain defines seven sequential phases of an attack. ATT&CK provides far more granular, non-linear detail with hundreds of techniques across 14 tactics, and is continuously updated based on real-world threat intelligence."},
    {c:"Framework Fundamentals", q:"What is the MITRE ATT&CK Navigator, and how is it used by security teams?", a:"A web-based tool for visualising and annotating the ATT&CK matrix to map coverage, gaps, and threat profiles.", d:["An automated vulnerability scanner that tests systems against every technique in the ATT&CK knowledge base.", "A threat intelligence feed that provides real-time alerts when new techniques are added to the framework.", "A penetration testing tool that generates attack playbooks based on selected adversary group profiles."], e:"The ATT&CK Navigator is an interactive web application that lets users create custom layers on the ATT&CK matrix. Teams use it to visualise defensive coverage, map threat actor profiles, plan red team exercises, and identify detection gaps."},
    {c:"Framework Fundamentals", q:"What is the purpose of the 'Groups' section within the MITRE ATT&CK knowledge base?", a:"It catalogues known threat actor groups, their associated techniques, and the software they commonly use.", d:["It lists cybersecurity vendor organisations that contribute technique data to the ATT&CK framework.", "It defines user roles and permissions for organisations that deploy ATT&CK in their security operations.", "It categorises techniques by the industry sector most frequently targeted by each type of attack."], e:"The Groups section documents tracked threat actors (like APT28, Lazarus Group, FIN7) with their known TTPs, associated software, and targeted sectors. This allows defenders to build threat models based on likely adversaries."},
    {c:"Framework Fundamentals", q:"In MITRE ATT&CK technique IDs, what does the format 'T1059.001' represent?", a:"T1059 is the parent technique (Command and Scripting Interpreter) and .001 is a sub-technique (PowerShell).", d:["T1059 is the tactic identifier and .001 indicates this is the first technique listed under that tactic.", "T1059 is the threat group ID and .001 specifies the particular campaign where this technique was observed.", "T1059 is the mitigation control number and .001 references the specific detection rule to implement."], e:"ATT&CK uses a hierarchical ID system: 'T' prefix for techniques, followed by a four-digit number. Sub-techniques append a three-digit decimal (e.g., T1059.001 = PowerShell under T1059 Command and Scripting Interpreter)."},
    {c:"Framework Fundamentals", q:"What does the 'Data Sources' component of ATT&CK technique entries describe?", a:"The types of sensor data and log sources that can be used to detect a specific adversary technique.", d:["The databases and file systems that adversaries target when performing data exfiltration techniques.", "The open-source intelligence feeds where MITRE originally collected evidence of the technique in use.", "The software vendors whose products are vulnerable to exploitation by the described technique."], e:"Data Sources specify what telemetry is needed to detect a technique. For example, T1003 OS Credential Dumping lists data sources like Process Access, Command Execution, and File Access that defenders should monitor."},
    {c:"Framework Fundamentals", q:"How does MITRE ATT&CK handle techniques that serve multiple tactical purposes?", a:"A single technique can be mapped to multiple tactics — for example, Process Injection maps to both Defense Evasion and Privilege Escalation.", d:["Each technique is assigned to exactly one tactic based on its primary observed purpose in the wild.", "Techniques that serve multiple purposes are split into separate entries with unique IDs for each tactic.", "Multi-purpose techniques are placed in a dedicated 'General' tactic that covers cross-cutting behaviours."], e:"ATT&CK allows techniques to appear under multiple tactics. T1055 Process Injection is under both Defense Evasion and Privilege Escalation because injecting code into another process both evades detection and potentially elevates privileges."},
    {c:"Framework Fundamentals", q:"What role do 'Mitigations' play in the MITRE ATT&CK knowledge base?", a:"They describe security controls and configurations that can prevent or reduce the effectiveness of techniques.", d:["They are automated scripts that security teams can deploy to instantly block all associated techniques.", "They list the specific CVE identifiers for vulnerabilities that must be patched to prevent each technique.", "They provide forensic analysis procedures for investigating incidents after a technique has been executed."], e:"Mitigations (prefixed M followed by four digits) describe defensive measures. For example, M1026 Privileged Account Management mitigates techniques like T1078 Valid Accounts. They link techniques to actionable defensive recommendations."},
    {c:"Framework Fundamentals", q:"What is 'adversary emulation' in the context of MITRE ATT&CK, and how does it differ from a standard penetration test?", a:"Adversary emulation replicates a specific threat actor's known TTPs to test defences against a realistic adversary profile.", d:["Adversary emulation uses only automated scanning tools to identify vulnerabilities without any manual testing.", "Adversary emulation focuses exclusively on social engineering attacks and does not include technical exploitation.", "Adversary emulation is a theoretical exercise that models attacks on paper without executing any actual tests."], e:"Adversary emulation uses ATT&CK to replicate a specific threat group's TTPs (e.g., emulating APT29's known tools and techniques). Unlike generic pen testing, it tests whether defences can detect and respond to a threat the organisation actually faces."},

    // ===== TA0043 RECONNAISSANCE (8) =====
    {c:"TA0043 Reconnaissance", q:"Which MITRE ATT&CK tactic covers adversary activities performed before gaining initial access to a target environment?", a:"Reconnaissance (TA0043) — gathering information to plan future operations against the target organisation.", d:["Initial Access (TA0001) — the first methods adversaries use to gain a foothold inside the target network.", "Resource Development (TA0042) — establishing infrastructure and acquiring tools needed for the operation.", "Discovery (TA0007) — exploring the environment after initial compromise to understand the target network."], e:"Reconnaissance (TA0043) covers pre-compromise information gathering. This includes techniques like Active Scanning (T1595), Search Open Websites/Domains (T1593), and Gather Victim Network Information (T1590)."},
    {c:"TA0043 Reconnaissance", q:"An adversary uses Shodan to identify internet-facing services on a target's IP range. Which ATT&CK technique does this best represent?", a:"T1596 Search Open Technical Databases — using public technical databases to gather target information.", d:["T1595 Active Scanning — directly probing the target's infrastructure to identify open ports and services.", "T1593 Search Open Websites/Domains — browsing the target's public websites for useful technical details.", "T1589 Gather Victim Identity Information — collecting employee names and email addresses from public data."], e:"Shodan is a technical database that indexes internet-connected devices. Using it to find target infrastructure falls under T1596, which covers searching publicly available technical databases like Shodan, Censys, and certificate transparency logs."},
    {c:"TA0043 Reconnaissance", q:"An adversary scans a target's IP range to identify open ports and running services. What is the ATT&CK technique ID for this activity?", a:"T1595 Active Scanning — directly probing target infrastructure to gather actionable technical information.", d:["T1592 Gather Victim Host Information — collecting details about target endpoints through passive observation.", "T1590 Gather Victim Network Information — determining the target's network topology through indirect methods.", "T1598 Phishing for Information — sending deceptive messages to extract technical details from target employees."], e:"T1595 Active Scanning includes sub-techniques for Scanning IP Blocks (T1595.001) and Vulnerability Scanning (T1595.002). This involves direct interaction with the target infrastructure, unlike passive reconnaissance techniques."},
    {c:"TA0043 Reconnaissance", q:"An adversary reviews LinkedIn profiles of a target company's IT staff to identify the technologies they manage. Which technique is this?", a:"T1593 Search Open Websites/Domains, using social media and professional networking sites for intelligence.", d:["T1589 Gather Victim Identity Information, specifically collecting employee names from corporate directories.", "T1591 Gather Victim Org Information, determining the company's physical locations and business relationships.", "T1597 Search Closed Sources, accessing paid intelligence services to gather non-public employee data."], e:"Searching LinkedIn (an open website) for technology keywords in employee profiles falls under T1593 Search Open Websites/Domains. Sub-technique T1593.001 specifically covers social media reconnaissance."},
    {c:"TA0043 Reconnaissance", q:"How does T1598 Phishing for Information differ from standard phishing under Initial Access?", a:"T1598 gathers information (like credentials or system details) rather than delivering malware or gaining access.", d:["T1598 uses only voice-based phishing (vishing), while Initial Access phishing is exclusively email-based.", "T1598 targets only cloud-based email platforms, while standard phishing targets on-premises mail servers.", "T1598 is performed by automated tools without human interaction, unlike manual social engineering phishing."], e:"T1598 Phishing for Information is a Reconnaissance technique where the goal is to elicit information (credentials, network details, software versions) from targets. Standard T1566 Phishing under Initial Access aims to deliver payloads or gain direct access."},
    {c:"TA0043 Reconnaissance", q:"An adversary queries DNS records to identify a target's mail servers and name servers. Which ATT&CK technique and sub-technique does this represent?", a:"T1590.002 Gather Victim Network Information: DNS — extracting network infrastructure details from DNS records.", d:["T1596.002 Search Open Technical Databases: WHOIS — querying domain registration databases for ownership data.", "T1595.001 Active Scanning: Scanning IP Blocks — probing the target's IP address range for responsive hosts.", "T1592.004 Gather Victim Host Information: Client Configurations — identifying endpoint software configurations."], e:"T1590 Gather Victim Network Information has sub-technique T1590.002 (DNS) which covers querying DNS for MX, NS, A, CNAME, and other records to map a target's network infrastructure — including mail servers, name servers, and subdomains."},
    {c:"TA0043 Reconnaissance", q:"What distinguishes 'active' reconnaissance techniques from 'passive' ones in the ATT&CK framework?", a:"Active techniques involve direct interaction with target systems, while passive techniques use third-party sources.", d:["Active techniques are performed during business hours, while passive techniques are conducted outside of them.", "Active techniques require insider access to the target, while passive techniques work from external positions.", "Active techniques target cloud environments specifically, while passive techniques focus on on-premises systems."], e:"Active reconnaissance (like T1595 Active Scanning) directly probes the target. Passive reconnaissance (like T1593 Search Open Websites) gathers information from public sources without touching the target's infrastructure."},
    {c:"TA0043 Reconnaissance", q:"An adversary purchases stolen credentials from a dark web marketplace to use against a target organisation. Which technique does this fall under?", a:"T1597 Search Closed Sources — gathering information from threat intelligence vendors, dark web, or private data.", d:["T1589 Gather Victim Identity Information — collecting employee credential information from public sources.", "T1078 Valid Accounts — using previously obtained legitimate credentials to authenticate to target systems.", "T1586 Compromise Accounts — taking over existing accounts on external services for use in the operation."], e:"T1597 Search Closed Sources covers accessing non-public data sources including dark web forums, paste sites, and private databases. T1597.002 specifically covers purchasing information from these sources. T1078 Valid Accounts would cover the actual use of those credentials."},

    // ===== TA0042 RESOURCE DEVELOPMENT (6) =====
    {c:"TA0042 Resource Development", q:"An adversary registers look-alike domains mimicking a target's brand for use in a phishing campaign. Which ATT&CK technique does this represent?", a:"T1583.001 Acquire Infrastructure: Domains — purchasing or registering domain names for adversary operations.", d:["T1584.001 Compromise Infrastructure: Domains — hijacking existing legitimate domains via DNS manipulation.", "T1608.005 Stage Capabilities: Link Target — preparing malicious links on infrastructure for phishing delivery.", "T1585.001 Establish Accounts: Social Media Accounts — creating fake profiles to support social engineering."], e:"T1583 Acquire Infrastructure covers adversaries obtaining infrastructure (domains, servers, web services) for operations. Sub-technique T1583.001 specifically addresses registering domain names, including typosquatting and look-alike domains."},
    {c:"TA0042 Resource Development", q:"What is the difference between T1583 (Acquire Infrastructure) and T1584 (Compromise Infrastructure)?", a:"T1583 involves purchasing or renting new infrastructure, while T1584 involves hijacking existing third-party infrastructure.", d:["T1583 covers cloud infrastructure only, while T1584 covers on-premises physical servers and hardware.", "T1583 is used during initial access, while T1584 is used exclusively during the lateral movement phase.", "T1583 describes free infrastructure like email services, while T1584 covers paid enterprise hosting platforms."], e:"T1583 Acquire Infrastructure = adversary buys/rents their own servers, domains, or services. T1584 Compromise Infrastructure = adversary takes over someone else's existing infrastructure (e.g., compromised web servers, hijacked domains) for their operations."},
    {c:"TA0042 Resource Development", q:"An adversary develops a custom RAT (Remote Access Trojan) tailored for a specific target. Which ATT&CK technique does this describe?", a:"T1587.001 Develop Capabilities: Malware — creating custom malicious software for use in adversary operations.", d:["T1588.001 Obtain Capabilities: Malware — acquiring existing malware from public repositories or dark web markets.", "T1608.001 Stage Capabilities: Upload Malware — placing pre-built malicious tools on staging infrastructure.", "T1059 Command and Scripting Interpreter — executing scripts and commands on compromised target systems."], e:"T1587 Develop Capabilities covers adversaries building their own tools rather than using off-the-shelf options. T1587.001 specifically addresses custom malware development. T1588 covers obtaining pre-existing tools rather than developing them."},
    {c:"TA0042 Resource Development", q:"An adversary obtains a legitimate code signing certificate to sign their malware. Which sub-technique does this represent?", a:"T1587.002 Develop Capabilities: Code Signing Certificates — acquiring or creating certificates for signing code.", d:["T1553.002 Subvert Trust Controls: Code Signing — bypassing security controls by using signed malicious binaries.", "T1588.004 Obtain Capabilities: Digital Certificates — purchasing SSL/TLS certificates for infrastructure setup.", "T1583.006 Acquire Infrastructure: Web Services — obtaining web hosting to deliver signed malicious payloads."], e:"T1587.002 covers developing or acquiring code signing certificates. T1588.003 covers obtaining existing certificates. T1553.002 covers the actual use of code signing to bypass security controls during execution — these are distinct stages of the attack lifecycle."},
    {c:"TA0042 Resource Development", q:"An adversary creates a fake GitHub account and populates it with legitimate-looking repositories before using it in a supply chain attack. Which technique applies?", a:"T1585.001 Establish Accounts: Social Media Accounts — creating personas on platforms to support future operations.", d:["T1199 Trusted Relationship — exploiting an existing relationship between the target and a third-party entity.", "T1195.002 Supply Chain Compromise: Compromise Software Supply Chain — inserting malicious code into packages.", "T1583.006 Acquire Infrastructure: Web Services — obtaining accounts on legitimate web services for staging."], e:"T1585 Establish Accounts covers creating accounts on third-party services (social media, email, code repositories) to build credibility for future operations. The actual supply chain compromise (T1195) would be a separate, subsequent technique."},
    {c:"TA0042 Resource Development", q:"Why does MITRE ATT&CK include Resource Development as a separate tactic, given that these activities occur before the intrusion?", a:"It captures the adversary's preparation activities, enabling defenders to detect and disrupt operations before initial access.", d:["It serves as a historical archive of past attack infrastructure with no practical defensive application for teams.", "It is included only for completeness in academic research and has no relevance to operational security monitoring.", "It duplicates Reconnaissance activities under a different name to provide an alternative classification taxonomy."], e:"Resource Development (TA0042) captures infrastructure acquisition, capability development, and account creation that precede the attack. Defenders can use this to identify adversary infrastructure (e.g., newly registered domains, VPS patterns) and disrupt attacks proactively."},

    // ===== TA0001 INITIAL ACCESS (8) =====
    {c:"TA0001 Initial Access", q:"An employee receives an email with a malicious Word document attached that drops malware when macros are enabled. Which ATT&CK technique is this?", a:"T1566.001 Phishing: Spearphishing Attachment — delivering a malicious file via email to gain initial access.", d:["T1566.002 Phishing: Spearphishing Link — including a malicious URL in an email to direct the victim to a payload.", "T1566.003 Phishing: Spearphishing via Service — using third-party messaging platforms to deliver malicious content.", "T1204.002 User Execution: Malicious File — the victim executes a malicious file that was delivered to them."], e:"T1566.001 Spearphishing Attachment covers malicious files sent via email. T1204.002 User Execution: Malicious File is the companion technique (under Execution) that describes the victim opening the file. Both may apply, but the initial access method is T1566.001."},
    {c:"TA0001 Initial Access", q:"An adversary exploits a known vulnerability in an internet-facing Apache web server to gain a foothold. Which technique does this represent?", a:"T1190 Exploit Public-Facing Application — leveraging vulnerabilities in internet-accessible services for access.", d:["T1133 External Remote Services — using legitimate remote access services like VPN or RDP to enter the network.", "T1189 Drive-by Compromise — compromising a website visited by the target to deliver an exploit to their browser.", "T1195 Supply Chain Compromise — inserting malicious code into a trusted vendor's software update mechanism."], e:"T1190 Exploit Public-Facing Application covers exploiting vulnerabilities in internet-facing systems like web servers, email servers, VPN appliances, and firewalls. This is one of the most common initial access vectors."},
    {c:"TA0001 Initial Access", q:"An adversary gains access to a target's network by logging in through a VPN using stolen credentials. Which technique best describes this?", a:"T1133 External Remote Services — using legitimate remote access mechanisms to authenticate into the network.", d:["T1078 Valid Accounts — using compromised credentials to maintain persistence within an already accessed network.", "T1190 Exploit Public-Facing Application — exploiting a vulnerability in the VPN software to bypass authentication.", "T1199 Trusted Relationship — leveraging a managed service provider's access to the target's network infrastructure."], e:"T1133 External Remote Services covers VPN, Citrix, RDP, and other remote access services used for initial entry. T1078 Valid Accounts is the supporting technique that describes the use of the stolen credentials themselves. Both techniques often apply together."},
    {c:"TA0001 Initial Access", q:"Adversaries compromise a popular software library used by their target and inject malicious code into an update. What technique is this?", a:"T1195.002 Supply Chain Compromise: Compromise Software Supply Chain — tampering with trusted software delivery.", d:["T1189 Drive-by Compromise — exploiting vulnerabilities in the target's web browser during routine web browsing.", "T1199 Trusted Relationship — abusing a third-party organisation's privileged access to the target's environment.", "T1059.006 Command and Scripting Interpreter: Python — using Python-based scripts for payload delivery and execution."], e:"T1195 Supply Chain Compromise specifically covers manipulation of software or hardware supply chains before delivery to the target. The SolarWinds and 3CX incidents are notable examples of T1195.002 Compromise Software Supply Chain."},
    {c:"TA0001 Initial Access", q:"A user visits a legitimate news website that has been compromised with a browser exploit kit. Which technique does this represent?", a:"T1189 Drive-by Compromise — exploiting vulnerabilities through a user's normal web browsing activity.", d:["T1566.002 Phishing: Spearphishing Link — directing the user to click on a malicious URL sent via email.", "T1190 Exploit Public-Facing Application — targeting a vulnerability in the organisation's own web server.", "T1195.002 Supply Chain Compromise — injecting malicious code into a trusted software update mechanism."], e:"T1189 Drive-by Compromise occurs when a user visits a compromised website (often called a 'watering hole') that delivers exploits through the browser. The user does not need to click a malicious link or download a file explicitly."},
    {c:"TA0001 Initial Access", q:"An adversary uses a compromised managed service provider (MSP) to access their ultimate target's network. Which technique applies?", a:"T1199 Trusted Relationship — exploiting a third party's trusted network connection to reach the target.", d:["T1133 External Remote Services — authenticating to the target's VPN or remote desktop using stolen credentials.", "T1078 Valid Accounts — using the MSP's legitimate admin credentials to log in to the target's systems directly.", "T1195.001 Supply Chain Compromise: Compromise Software Dependencies — modifying shared libraries to gain access."], e:"T1199 Trusted Relationship covers adversaries exploiting trusted third-party relationships (MSPs, contractors, business partners) that have privileged access to the target's environment. Notable examples include the Kaseya supply chain attack vector."},
    {c:"TA0001 Initial Access", q:"An adversary plugs a malicious USB device into an unattended workstation in a target's office. Which Initial Access technique is this?", a:"T1091 Replication Through Removable Media — using physical media to introduce malware into an air-gapped or target network.", d:["T1200 Hardware Additions — adding rogue physical devices like network implants or keyloggers to the infrastructure.", "T1195.003 Supply Chain Compromise: Compromise Hardware Supply Chain — modifying hardware during manufacturing.", "T1566.001 Phishing: Spearphishing Attachment — delivering a malicious file as an email attachment to the target."], e:"T1091 Replication Through Removable Media covers initial access via USB drives, external hard drives, and other removable media. T1200 Hardware Additions covers rogue devices like network taps or implants, which is a distinct technique."},
    {c:"TA0001 Initial Access", q:"An adversary creates a convincing fake login page for Microsoft 365 and sends the link to target employees. Which two techniques work together here?", a:"T1566.002 Spearphishing Link for the email delivery, and T1598.003 Phishing for Information: Spearphishing Link for credential harvesting.", d:["T1189 Drive-by Compromise for the fake page, and T1190 Exploit Public-Facing Application for capturing the credentials.", "T1195 Supply Chain Compromise for the fake infrastructure, and T1078 Valid Accounts for using the captured credentials.", "T1199 Trusted Relationship for impersonating Microsoft, and T1133 External Remote Services for accessing the target's VPN."], e:"The adversary uses T1566.002 (Spearphishing Link) to deliver the link via email. If the goal is capturing credentials (rather than installing malware), T1598.003 Phishing for Information also applies. T1078 Valid Accounts would then cover using those credentials."},

    // ===== TA0002 EXECUTION (8) =====
    {c:"TA0002 Execution", q:"An adversary uses PowerShell to download and execute a payload on a compromised Windows host. Which ATT&CK technique and sub-technique is this?", a:"T1059.001 Command and Scripting Interpreter: PowerShell — using the PowerShell scripting engine for execution.", d:["T1059.003 Command and Scripting Interpreter: Windows Command Shell — using cmd.exe for command execution.", "T1059.005 Command and Scripting Interpreter: Visual Basic — using VBScript for payload delivery and execution.", "T1047 Windows Management Instrumentation — using WMI to remotely execute commands on target systems."], e:"T1059 Command and Scripting Interpreter has sub-techniques for each interpreter. T1059.001 is PowerShell, T1059.003 is Windows Command Shell (cmd), T1059.005 is Visual Basic, T1059.006 is Python, and T1059.007 is JavaScript."},
    {c:"TA0002 Execution", q:"An adversary uses Windows Management Instrumentation (WMI) to execute commands on a remote system. Which technique does this describe?", a:"T1047 Windows Management Instrumentation — leveraging WMI for remote and local command execution on Windows.", d:["T1059.001 Command and Scripting Interpreter: PowerShell — using PowerShell scripts to execute remote commands.", "T1569.002 System Services: Service Execution — creating or manipulating Windows services to run malicious code.", "T1053.005 Scheduled Task/Job: Scheduled Task — creating a Windows scheduled task for deferred code execution."], e:"T1047 covers the use of WMI (wmic.exe, wmiexec, WMI event subscriptions) for both local and remote execution. WMI is a legitimate Windows management framework commonly abused by adversaries for fileless execution."},
    {c:"TA0002 Execution", q:"A malicious Word document uses an embedded macro to launch a payload when the user clicks 'Enable Content'. Which technique pair applies?", a:"T1204.002 User Execution: Malicious File (user opens it) and T1059.005 Command and Scripting Interpreter: Visual Basic (macro executes).", d:["T1566.001 Phishing: Spearphishing Attachment (file delivery) and T1203 Exploitation for Client Execution (macro exploits a vulnerability).", "T1218.011 System Binary Proxy Execution: Rundll32 (loading the DLL) and T1055 Process Injection (injecting into a process).", "T1204.001 User Execution: Malicious Link (user clicks the link) and T1059.001 Command and Scripting Interpreter: PowerShell."], e:"T1204.002 covers the user being tricked into opening the malicious file. The macro itself (VBA) is classified under T1059.005 Command and Scripting Interpreter: Visual Basic. These two techniques work together in the common macro-based attack chain."},
    {c:"TA0002 Execution", q:"An adversary deploys a webshell on a compromised web server. Under which tactic and technique is this execution mechanism classified?", a:"T1505.003 Server Software Component: Web Shell — installing a web-accessible script for persistent command execution.", d:["T1059.004 Command and Scripting Interpreter: Unix Shell — executing commands through a Linux shell on the server.", "T1190 Exploit Public-Facing Application — exploiting a vulnerability in the web application to gain initial access.", "T1072 Software Deployment Tools — using legitimate IT administration tools to deploy malicious scripts remotely."], e:"T1505.003 Web Shell is classified under Persistence, not Execution, because it provides a persistent mechanism for command execution. However, the execution of commands through the webshell would involve techniques like T1059 Command and Scripting Interpreter."},
    {c:"TA0002 Execution", q:"An adversary uses the Windows Task Scheduler to execute a malicious payload at a specified time. Which technique is this?", a:"T1053.005 Scheduled Task/Job: Scheduled Task — using the Windows Task Scheduler for code execution and persistence.", d:["T1547.001 Boot or Logon Autostart Execution: Registry Run Keys — adding a registry entry to execute at system startup.", "T1543.003 Create or Modify System Process: Windows Service — installing a malicious service for persistent execution.", "T1569.002 System Services: Service Execution — using the Windows Service Control Manager to start a malicious process."], e:"T1053.005 covers using Windows Task Scheduler (schtasks.exe, at.exe) to execute code. This technique appears under both Execution and Persistence tactics because scheduled tasks can serve both immediate execution and recurring persistence."},
    {c:"TA0002 Execution", q:"What distinguishes T1203 (Exploitation for Client Execution) from T1190 (Exploit Public-Facing Application)?", a:"T1203 exploits vulnerabilities in client software (browsers, readers), while T1190 targets server-side internet-facing applications.", d:["T1203 is used only on Windows clients, while T1190 applies only to Linux-based web servers and services.", "T1203 requires social engineering interaction, while T1190 is always fully automated without user involvement.", "T1203 targets zero-day vulnerabilities exclusively, while T1190 covers only vulnerabilities with existing patches."], e:"T1203 Exploitation for Client Execution targets client-side software (web browsers, PDF readers, Office applications) typically triggered when a user opens a malicious file or visits a malicious website. T1190 targets server-side applications exposed to the internet."},
    {c:"TA0002 Execution", q:"An adversary uses Python to execute malicious scripts on a compromised Linux server. Which sub-technique is this?", a:"T1059.006 Command and Scripting Interpreter: Python — using the Python interpreter for adversary code execution.", d:["T1059.004 Command and Scripting Interpreter: Unix Shell — using bash or sh to execute commands on the server.", "T1059.007 Command and Scripting Interpreter: JavaScript — using a JavaScript runtime for server-side execution.", "T1072 Software Deployment Tools — using deployment automation frameworks to distribute and execute scripts."], e:"T1059.006 specifically covers using Python for execution. Python is commonly pre-installed on Linux systems and offers powerful libraries for networking, file manipulation, and system interaction, making it a popular adversary tool."},
    {c:"TA0002 Execution", q:"An adversary uses inter-process communication mechanisms like Component Object Model (COM) to execute code. Which technique is this?", a:"T1559 Inter-Process Communication — abusing IPC mechanisms like COM, DDE, or XPC Services for execution.", d:["T1055 Process Injection — injecting malicious code directly into the memory space of a running legitimate process.", "T1106 Native API — directly invoking operating system API functions to execute code without using shell commands.", "T1129 Shared Modules — loading malicious code through shared library or DLL loading during process initialisation."], e:"T1559 Inter-Process Communication covers adversaries abusing IPC mechanisms. Sub-techniques include T1559.001 (Component Object Model) and T1559.002 (Dynamic Data Exchange/DDE). These allow execution through legitimate inter-process communication channels."},

    // ===== TA0003 PERSISTENCE (8) =====
    {c:"TA0003 Persistence", q:"An adversary adds a Registry Run key entry pointing to their malware to survive reboots. Which technique is this?", a:"T1547.001 Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder — persisting via startup entries.", d:["T1053.005 Scheduled Task/Job: Scheduled Task — creating a recurring task to re-execute the payload after reboot.", "T1543.003 Create or Modify System Process: Windows Service — installing a Windows service for automatic startup.", "T1136.001 Create Account: Local Account — creating a new local user account to maintain access after reboots."], e:"T1547.001 covers adding entries to Registry Run/RunOnce keys (HKLM/HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run) or the Startup folder. These execute automatically at user logon, providing persistence across reboots."},
    {c:"TA0003 Persistence", q:"An adversary installs a malicious Windows service that starts automatically at boot. Which ATT&CK technique does this represent?", a:"T1543.003 Create or Modify System Process: Windows Service — creating a service for persistent elevated execution.", d:["T1547.001 Boot or Logon Autostart Execution: Registry Run Keys — adding a startup entry for the user's login session.", "T1053.005 Scheduled Task/Job: Scheduled Task — configuring a scheduled task to run the payload at system startup.", "T1546.015 Event Triggered Execution: Component Object Model Hijacking — replacing COM objects for code execution."], e:"T1543.003 covers creating or modifying Windows services (using sc.exe, New-Service, or direct registry manipulation). Services run as SYSTEM by default and start automatically, providing both persistence and elevated privileges."},
    {c:"TA0003 Persistence", q:"An adversary modifies the .bashrc file on a Linux system to execute their payload every time a user opens a terminal. Which technique is this?", a:"T1546.004 Event Triggered Execution: Unix Shell Configuration Modification — altering shell startup files for persistence.", d:["T1053.003 Scheduled Task/Job: Cron — adding a cron job entry to execute the payload at regular time intervals.", "T1547.006 Boot or Logon Autostart Execution: Kernel Modules and Extensions — loading a malicious kernel module.", "T1136.001 Create Account: Local Account — creating a backdoor user account with access to the compromised system."], e:"T1546.004 covers modifying shell configuration files like .bashrc, .bash_profile, .zshrc, and /etc/profile. Commands in these files execute each time a shell session starts, providing user-level persistence on Unix/Linux systems."},
    {c:"TA0003 Persistence", q:"An adversary creates a new domain admin account on a compromised Active Directory domain controller. Which technique is this?", a:"T1136.002 Create Account: Domain Account — creating a new account in the domain for persistent privileged access.", d:["T1098 Account Manipulation — modifying an existing account's properties to maintain access to the domain.", "T1078.002 Valid Accounts: Domain Accounts — using pre-existing legitimate domain credentials for continued access.", "T1556 Modify Authentication Process — altering the authentication mechanism to allow access without valid credentials."], e:"T1136 Create Account has three sub-techniques: T1136.001 Local Account, T1136.002 Domain Account, and T1136.003 Cloud Account. Creating a domain admin account provides the adversary with a persistent, highly privileged backdoor."},
    {c:"TA0003 Persistence", q:"An adversary replaces a legitimate DLL loaded by a Windows service with a malicious version. Which technique does this represent?", a:"T1574.001 Hijack Execution Flow: DLL Search Order Hijacking — placing a malicious DLL in a higher priority search path.", d:["T1055.001 Process Injection: Dynamic-link Library Injection — injecting a DLL into the address space of a running process.", "T1547.001 Boot or Logon Autostart Execution: Registry Run Keys — adding the DLL path to the system startup entries.", "T1218.011 System Binary Proxy Execution: Rundll32 — using rundll32.exe to load and execute the malicious DLL directly."], e:"T1574 Hijack Execution Flow covers multiple methods: DLL Search Order Hijacking (T1574.001), DLL Side-Loading (T1574.002), and Path Interception (T1574.007-009). The adversary abuses how applications locate and load dependencies."},
    {c:"TA0003 Persistence", q:"An adversary configures a WMI event subscription that triggers their payload when a specific system event occurs. Which technique is this?", a:"T1546.003 Event Triggered Execution: Windows Management Instrumentation Event Subscription — using WMI events for persistence.", d:["T1047 Windows Management Instrumentation — using WMI to execute commands on local or remote Windows systems.", "T1053.005 Scheduled Task/Job: Scheduled Task — creating a scheduled task triggered by a specific Windows event.", "T1543.003 Create or Modify System Process: Windows Service — configuring a service to start based on system events."], e:"T1546.003 covers WMI event subscriptions (using Event Filters, Event Consumers, and Filter-to-Consumer Bindings) for persistence. WMI subscriptions survive reboots and can trigger on events like user logon, process creation, or timer intervals."},
    {c:"TA0003 Persistence", q:"What makes BITS Jobs (T1197) an effective persistence mechanism for adversaries on Windows systems?", a:"BITS is a legitimate Windows service for file transfers that survives reboots, can run as SYSTEM, and evades many security tools.", d:["BITS provides kernel-level rootkit capabilities that hide malicious processes from all user-mode detection tools.", "BITS encrypts all transferred payloads using the system's BitLocker key, preventing forensic analysis of the files.", "BITS automatically propagates malware to all domain-joined machines through the Windows Update distribution channel."], e:"BITS (Background Intelligent Transfer Service) is a legitimate Windows file transfer service. Adversaries abuse it because BITS jobs persist across reboots, can be scheduled, run as SYSTEM, and many security tools don't monitor BITS job creation."},
    {c:"TA0003 Persistence", q:"An adversary implants a bootkit that modifies the Master Boot Record (MBR) of a compromised system. Which technique is this?", a:"T1542.003 Pre-OS Boot: Bootkit — modifying boot records to execute malicious code before the operating system loads.", d:["T1547.001 Boot or Logon Autostart Execution: Registry Run Keys — adding entries that execute during the OS boot phase.", "T1014 Rootkit — installing kernel-level code that hides adversary presence after the operating system has loaded.", "T1562.001 Impair Defenses: Disable or Modify Tools — disabling security software that runs during the boot process."], e:"T1542.003 Bootkit covers modification of the MBR, Volume Boot Record (VBR), or UEFI firmware to execute code before the OS loads. This provides extremely persistent access that survives OS reinstallation if the bootkit targets firmware."},

    // ===== TA0004 PRIVILEGE ESCALATION (8) =====
    {c:"TA0004 Privilege Escalation", q:"An adversary exploits a vulnerability in a kernel driver to escalate from user-level to SYSTEM-level privileges. Which technique is this?", a:"T1068 Exploitation for Privilege Escalation — exploiting software vulnerabilities to gain elevated access on the system.", d:["T1548.002 Abuse Elevation Control Mechanism: Bypass User Account Control — circumventing UAC to elevate privileges.", "T1134.001 Access Token Manipulation: Token Impersonation/Theft — stealing tokens from higher-privileged processes.", "T1055 Process Injection — injecting code into a higher-privileged process to execute commands in its security context."], e:"T1068 covers exploiting software vulnerabilities (kernel, driver, service) to escalate privileges. This is distinct from abusing misconfigurations or legitimate features — it specifically involves exploiting bugs in code."},
    {c:"TA0004 Privilege Escalation", q:"An adversary uses the Windows UAC bypass technique 'fodhelper.exe' to elevate privileges without a UAC prompt. Which technique is this?", a:"T1548.002 Abuse Elevation Control Mechanism: Bypass User Account Control — circumventing UAC through trusted binaries.", d:["T1068 Exploitation for Privilege Escalation — exploiting a vulnerability in the UAC implementation to bypass controls.", "T1134 Access Token Manipulation — modifying the access token to include higher-privilege group memberships.", "T1574.002 Hijack Execution Flow: DLL Side-Loading — loading a malicious DLL via a legitimate elevated application."], e:"T1548.002 covers UAC bypass techniques. Fodhelper.exe is a Windows binary that auto-elevates and checks a registry key for its associated application. Adversaries can modify this registry key to execute their payload with elevated privileges."},
    {c:"TA0004 Privilege Escalation", q:"An adversary on a Linux system exploits a SUID binary to gain root access. Which ATT&CK technique does this fall under?", a:"T1548.001 Abuse Elevation Control Mechanism: Setuid and Setgid — exploiting SUID/SGID permissions for privilege escalation.", d:["T1068 Exploitation for Privilege Escalation — using a buffer overflow in the binary to gain root-level code execution.", "T1574 Hijack Execution Flow — replacing the SUID binary with a malicious version that executes as the root user.", "T1053.003 Scheduled Task/Job: Cron — exploiting a root-owned cron job to execute commands with root privileges."], e:"T1548.001 covers abusing SUID/SGID permissions. When a SUID binary owned by root can be abused (e.g., GTFOBins-listed binaries like find, vim, nmap with SUID), it allows arbitrary command execution with root privileges."},
    {c:"TA0004 Privilege Escalation", q:"An adversary steals a SYSTEM-level process token and uses it to impersonate that process's security context. Which technique is this?", a:"T1134.001 Access Token Manipulation: Token Impersonation/Theft — using stolen tokens to assume higher privileges.", d:["T1055.001 Process Injection: Dynamic-link Library Injection — injecting code into the SYSTEM process's memory space.", "T1078 Valid Accounts — using legitimate SYSTEM account credentials to authenticate with elevated access rights.", "T1068 Exploitation for Privilege Escalation — exploiting a vulnerability in the token management subsystem."], e:"T1134 Access Token Manipulation covers modifying or stealing Windows access tokens. Sub-technique T1134.001 (Token Impersonation/Theft) involves stealing tokens from high-privilege processes using tools like Incognito or mimikatz's token module."},
    {c:"TA0004 Privilege Escalation", q:"An adversary modifies a Group Policy Object to execute their payload with SYSTEM privileges across domain machines. Which technique applies?", a:"T1484.001 Domain or Tenant Policy Modification: Group Policy Modification — abusing GPOs for domain-wide privilege escalation.", d:["T1098 Account Manipulation — changing domain account properties to grant administrative access across the domain.", "T1053.005 Scheduled Task/Job: Scheduled Task — creating scheduled tasks via GPO for executing code domain-wide.", "T1136.002 Create Account: Domain Account — using GPO to distribute new administrative accounts to all machines."], e:"T1484.001 covers modifying domain or cloud tenant policies. Adversaries with domain admin access can modify GPOs to execute payloads as SYSTEM on all domain-joined machines, deploy malicious logon scripts, or modify security settings domain-wide."},
    {c:"TA0004 Privilege Escalation", q:"Why does Process Injection (T1055) appear under both Privilege Escalation and Defense Evasion tactics?", a:"Injecting code into a privileged process elevates access (PrivEsc) and executing within a legitimate process hides activity (DefEvas).", d:["The technique was accidentally duplicated across both tactics and has not yet been corrected in the framework.", "Process Injection under PrivEsc targets SYSTEM processes, while under DefEvas it targets user-level processes.", "PrivEsc uses DLL injection specifically, while DefEvas uses process hollowing, and they are technically different."], e:"ATT&CK maps techniques to multiple tactics when they serve multiple objectives. Process Injection achieves Privilege Escalation by running code in a higher-privileged process's context, and Defense Evasion by blending into legitimate process activity."},
    {c:"TA0004 Privilege Escalation", q:"An adversary discovers a Windows service with a writable binary path and replaces it with their payload. Which technique applies?", a:"T1574.010 Hijack Execution Flow: Services File Permissions Weakness — exploiting writable service binary paths.", d:["T1543.003 Create or Modify System Process: Windows Service — creating a new service with a malicious binary path.", "T1547.001 Boot or Logon Autostart Execution: Registry Run Keys — adding a registry entry that points to the payload.", "T1068 Exploitation for Privilege Escalation — exploiting a buffer overflow vulnerability in the Windows service binary."], e:"T1574 Hijack Execution Flow has multiple sub-techniques for different file permission weaknesses. Writable service binaries, unquoted service paths (T1574.009), and DLL search order issues (T1574.001) all allow privilege escalation through legitimate service execution."},
    {c:"TA0004 Privilege Escalation", q:"An adversary exploits a container escape vulnerability to gain access to the underlying host system. Which technique does this represent?", a:"T1611 Escape to Host — breaking out of a container or sandbox environment to access the host operating system.", d:["T1068 Exploitation for Privilege Escalation — exploiting a software vulnerability within the container runtime.", "T1610 Deploy Container — deploying a malicious container to execute code within the container orchestration platform.", "T1053.007 Scheduled Task/Job: Container Orchestration Job — using Kubernetes cron jobs to escalate container privileges."], e:"T1611 Escape to Host covers techniques for breaking out of virtualised environments (containers, sandboxes) to reach the underlying host. This includes exploiting kernel vulnerabilities from within containers, abusing privileged containers, or manipulating container runtimes."},

    // ===== TA0005 DEFENSE EVASION (10) =====
    {c:"TA0005 Defense Evasion", q:"An adversary uses Process Hollowing to replace the memory of a legitimate process with malicious code. Which sub-technique is this?", a:"T1055.012 Process Injection: Process Hollowing — creating a suspended process, replacing its memory, and resuming execution.", d:["T1055.001 Process Injection: Dynamic-link Library Injection — loading a malicious DLL into a running process's address space.", "T1055.002 Process Injection: Portable Executable Injection — writing PE code into the virtual memory of a running process.", "T1055.003 Process Injection: Thread Execution Hijacking — modifying a thread's execution context to run malicious code."], e:"T1055.012 Process Hollowing specifically involves creating a process in a suspended state, unmapping its original code, writing malicious code into the empty process, and resuming execution. The process appears legitimate in task lists."},
    {c:"TA0005 Defense Evasion", q:"An adversary uses certutil.exe to decode a Base64-encoded payload. Which ATT&CK technique does this represent?", a:"T1140 Deobfuscate/Decode Files or Information — using tools to reveal concealed or obfuscated malicious content.", d:["T1027 Obfuscated Files or Information — encoding the payload in Base64 to evade signature-based detection systems.", "T1218 System Binary Proxy Execution — using a signed Microsoft binary to execute arbitrary malicious commands.", "T1036 Masquerading — disguising the payload as a legitimate certificate file to evade manual inspection."], e:"T1140 covers decoding/deobfuscating payloads that were previously encoded (T1027). Using certutil.exe to decode Base64 is a common example. Note that the encoding itself would be T1027, while the decoding is T1140 — they are complementary."},
    {c:"TA0005 Defense Evasion", q:"An adversary disables Windows Defender using PowerShell commands before deploying their payload. Which technique is this?", a:"T1562.001 Impair Defenses: Disable or Modify Tools — deactivating security software to prevent detection and blocking.", d:["T1027 Obfuscated Files or Information — encoding the payload to bypass Windows Defender's signature-based scanning.", "T1070.004 Indicator Removal: File Deletion — removing security software executables from the file system entirely.", "T1036.005 Masquerading: Match Legitimate Name or Location — renaming the payload to appear as a Defender component."], e:"T1562.001 covers disabling or modifying security tools including antivirus, EDR, host firewalls, and audit logging. Common methods include Set-MpPreference -DisableRealtimeMonitoring $true for Windows Defender."},
    {c:"TA0005 Defense Evasion", q:"An adversary renames their malicious executable to 'svchost.exe' and places it in a non-standard directory. Which technique is this?", a:"T1036.005 Masquerading: Match Legitimate Name or Location — using names of legitimate processes to disguise malware.", d:["T1014 Rootkit — hiding the malicious process from the operating system's process listing and file system views.", "T1070 Indicator Removal — deleting evidence of the original malicious file name from the file system metadata.", "T1027.002 Obfuscated Files or Information: Software Packing — compressing the executable to avoid static analysis."], e:"T1036 Masquerading covers disguising adversary artefacts. T1036.005 specifically addresses naming malicious files or processes to match legitimate ones (like svchost.exe, csrss.exe, lsass.exe) to blend in with normal system activity."},
    {c:"TA0005 Defense Evasion", q:"An adversary uses Rundll32.exe to execute a malicious DLL. Why is this classified under Defense Evasion?", a:"T1218.011 System Binary Proxy Execution: Rundll32 — using a signed system binary to proxy-execute untrusted code.", d:["T1059.003 Command and Scripting Interpreter: Windows Command Shell — using cmd.exe to call rundll32 for execution.", "T1574.001 Hijack Execution Flow: DLL Search Order Hijacking — exploiting how rundll32 locates DLL files to load.", "T1055.001 Process Injection: DLL Injection — injecting a malicious DLL into the rundll32 process's memory space."], e:"T1218 System Binary Proxy Execution covers using trusted, signed Windows binaries to execute potentially malicious code. Since rundll32.exe is a legitimate signed Microsoft binary, security tools may trust its execution, providing evasion."},
    {c:"TA0005 Defense Evasion", q:"An adversary clears the Windows Security Event Log after escalating privileges. Which technique is this?", a:"T1070.001 Indicator Removal: Clear Windows Event Logs — deleting log entries to remove evidence of adversary activity.", d:["T1562.002 Impair Defenses: Disable Windows Event Logging — stopping the event logging service to prevent new entries.", "T1112 Modify Registry — editing registry keys that store event log configuration and retention policy settings.", "T1070.004 Indicator Removal: File Deletion — deleting the event log files directly from the Windows file system."], e:"T1070.001 specifically covers clearing Windows Event Logs (Security, System, Application). Tools like wevtutil.exe cl Security or Clear-EventLog are commonly used. T1562.002 covers disabling logging prospectively, which is a different technique."},
    {c:"TA0005 Defense Evasion", q:"An adversary modifies the timestamp of their malicious file to match legitimate system files. Which technique is this?", a:"T1070.006 Indicator Removal: Timestomp — modifying file timestamps to blend in with legitimate files during forensics.", d:["T1036.005 Masquerading: Match Legitimate Name or Location — changing the file name to resemble a legitimate system file.", "T1070.004 Indicator Removal: File Deletion — removing the original timestamp metadata from the file system entirely.", "T1027 Obfuscated Files or Information — encoding the file metadata to prevent forensic tools from reading timestamps."], e:"T1070.006 Timestomping modifies file timestamps (Created, Modified, Accessed, Entry Modified) to match surrounding legitimate files. This hinders forensic timeline analysis by making the malicious file appear to have existed longer."},
    {c:"TA0005 Defense Evasion", q:"An adversary uses reflective DLL loading to execute code entirely in memory without writing a DLL to disk. Which technique is this?", a:"T1620 Reflective Code Loading — loading code directly into a process's memory without using standard OS loader functions.", d:["T1055.001 Process Injection: Dynamic-link Library Injection — using the OS API to inject a disk-based DLL into a process.", "T1027.002 Obfuscated Files or Information: Software Packing — compressing the DLL to reduce its detectable footprint.", "T1106 Native API — using low-level operating system API calls to load libraries without standard loader mechanisms."], e:"T1620 Reflective Code Loading covers loading code (DLLs, executables) directly in memory without writing to disk or using standard OS loaders. This evades file-based detection and is used by tools like Cobalt Strike's Beacon and Metasploit's Meterpreter."},
    {c:"TA0005 Defense Evasion", q:"An adversary uses a valid, stolen code-signing certificate to sign their malware. Which technique is this?", a:"T1553.002 Subvert Trust Controls: Code Signing — using digital signatures to make malicious code appear legitimate.", d:["T1587.002 Develop Capabilities: Code Signing Certificates — acquiring the certificate for use in the operation.", "T1218 System Binary Proxy Execution — using a signed system binary as a proxy to execute the unsigned malware.", "T1036 Masquerading — disguising the malware to visually appear as a legitimately signed application to users."], e:"T1553.002 covers the use of code signing (regardless of how the certificate was obtained) to bypass security controls that check digital signatures. Many security tools and OS features trust signed code, making this an effective evasion technique."},
    {c:"TA0005 Defense Evasion", q:"What is the purpose of T1497 Virtualization/Sandbox Evasion in the context of adversary behaviour?", a:"Malware detects virtual machines or sandbox environments and alters behaviour to avoid analysis by security researchers.", d:["Adversaries exploit hypervisor vulnerabilities to escape virtual machines and access the underlying host system.", "Malware disables sandbox-based security tools on endpoints to prevent real-time scanning of executed files.", "Adversaries deploy their own virtual machines on compromised hosts to create isolated execution environments."], e:"T1497 covers techniques used by malware to detect analysis environments (VMs, sandboxes, debuggers). If detected, the malware may exit, sleep, or behave benignly. Sub-techniques include T1497.001 (System Checks), T1497.002 (User Activity Based), T1497.003 (Time Based)."},

    // ===== TA0006 CREDENTIAL ACCESS (8) =====
    {c:"TA0006 Credential Access", q:"An adversary runs mimikatz to extract plaintext passwords from the LSASS process on a Windows system. Which technique is this?", a:"T1003.001 OS Credential Dumping: LSASS Memory — extracting credential material from the LSASS process in memory.", d:["T1003.002 OS Credential Dumping: Security Account Manager — extracting password hashes from the local SAM database.", "T1003.003 OS Credential Dumping: NTDS — extracting Active Directory credential data from the NTDS.dit database file.", "T1555.003 Credentials from Password Stores: Credentials from Web Browsers — extracting saved browser passwords."], e:"T1003.001 covers dumping credentials from LSASS memory. Tools like mimikatz (sekurlsa::logonpasswords), procdump, and comsvcs.dll MiniDump are commonly used. LSASS stores passwords, Kerberos tickets, and NTLM hashes in memory."},
    {c:"TA0006 Credential Access", q:"An adversary performs a Kerberoasting attack to obtain service account password hashes. Which technique does this represent?", a:"T1558.003 Steal or Forge Kerberos Tickets: Kerberoasting — requesting TGS tickets to crack service account passwords offline.", d:["T1558.001 Steal or Forge Kerberos Tickets: Golden Ticket — forging Kerberos TGTs using a compromised KRBTGT hash.", "T1110.002 Brute Force: Password Cracking — cracking intercepted password hashes using dictionary or brute-force methods.", "T1557.001 Adversary-in-the-Middle: LLMNR/NBT-NS Poisoning — capturing NTLMv2 hashes through name resolution spoofing."], e:"T1558.003 Kerberoasting involves requesting TGS tickets for accounts with SPNs, then cracking the tickets offline to recover service account passwords. Any authenticated domain user can request these tickets, making it a low-barrier attack."},
    {c:"TA0006 Credential Access", q:"An adversary uses Responder to capture NTLMv2 hashes on a Windows network. Which technique does this fall under?", a:"T1557.001 Adversary-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay — capturing hashes via name resolution poisoning.", d:["T1040 Network Sniffing — passively capturing network traffic to extract credential material from unencrypted protocols.", "T1003.001 OS Credential Dumping: LSASS Memory — using a tool to extract credentials from the LSASS process memory.", "T1110 Brute Force — systematically attempting password combinations against network authentication services."], e:"T1557.001 covers LLMNR/NBT-NS/mDNS poisoning to perform adversary-in-the-middle attacks and capture NTLMv2 hashes. Responder is the quintessential tool for this technique, responding to broadcast name resolution queries with the attacker's IP."},
    {c:"TA0006 Credential Access", q:"An adversary extracts the NTDS.dit file from an Active Directory domain controller. What does this provide?", a:"T1003.003 OS Credential Dumping: NTDS — obtaining password hashes for every domain account in Active Directory.", d:["T1003.002 OS Credential Dumping: Security Account Manager — extracting local account hashes from individual machines.", "T1558.001 Steal or Forge Kerberos Tickets: Golden Ticket — obtaining the KRBTGT key to forge unlimited Kerberos tickets.", "T1552.004 Unsecured Credentials: Private Keys — extracting certificate private keys stored on the domain controller."], e:"NTDS.dit is the Active Directory database containing all domain user account information including password hashes. Extracting it (via ntdsutil, secretsdump, Volume Shadow Copy) provides hashes for every domain user — a catastrophic breach."},
    {c:"TA0006 Credential Access", q:"An adversary installs a keylogger on a compromised workstation to capture the user's credentials as they type. Which technique is this?", a:"T1056.001 Input Capture: Keylogging — recording keystrokes to capture credentials and other sensitive information.", d:["T1040 Network Sniffing — intercepting network traffic to capture credentials transmitted over the local network.", "T1555 Credentials from Password Stores — extracting stored passwords from browser password managers or vaults.", "T1557 Adversary-in-the-Middle — intercepting authentication traffic between the user and the authentication server."], e:"T1056.001 Keylogging covers capturing keystrokes through software keyloggers (API hooking, kernel drivers) or hardware devices. This captures credentials as the user types them, regardless of encryption used for transmission."},
    {c:"TA0006 Credential Access", q:"An adversary creates a forged Kerberos Ticket Granting Ticket (TGT) using a compromised KRBTGT account hash. What attack is this?", a:"T1558.001 Steal or Forge Kerberos Tickets: Golden Ticket — forging TGTs to access any service in the domain.", d:["T1558.003 Steal or Forge Kerberos Tickets: Kerberoasting — requesting service tickets to crack passwords offline.", "T1558.002 Steal or Forge Kerberos Tickets: Silver Ticket — forging service tickets for specific individual services.", "T1550.003 Use Alternate Authentication Material: Pass the Ticket — reusing a stolen existing Kerberos ticket."], e:"T1558.001 Golden Ticket attacks use the KRBTGT hash to forge TGTs for any user (including non-existent ones) with any privileges. This provides effectively unlimited access to the domain for as long as the KRBTGT hash remains unchanged."},
    {c:"TA0006 Credential Access", q:"An adversary extracts saved passwords from Google Chrome's credential store on a compromised workstation. Which technique is this?", a:"T1555.003 Credentials from Password Stores: Credentials from Web Browsers — extracting saved browser passwords.", d:["T1056.001 Input Capture: Keylogging — capturing password keystrokes as the user types them into the browser.", "T1539 Steal Web Session Cookie — extracting session cookies from the browser to hijack authenticated web sessions.", "T1552.001 Unsecured Credentials: Credentials In Files — finding plaintext passwords in configuration or log files."], e:"T1555.003 covers extracting passwords from browser credential stores. Chrome stores passwords encrypted with DPAPI. Tools like mimikatz, LaZagne, and SharpChrome can decrypt and extract these stored credentials."},
    {c:"TA0006 Credential Access", q:"An adversary performs a DCSync attack to replicate Active Directory data. Which technique does this represent?", a:"T1003.006 OS Credential Dumping: DCSync — using domain replication protocols to extract password hashes remotely.", d:["T1003.003 OS Credential Dumping: NTDS — directly accessing the NTDS.dit database file on the domain controller.", "T1558.001 Steal or Forge Kerberos Tickets: Golden Ticket — using replicated KRBTGT credentials to forge tickets.", "T1557 Adversary-in-the-Middle — intercepting replication traffic between domain controllers to extract hashes."], e:"T1003.006 DCSync uses the Directory Replication Service (DRS) protocol to request password data from a domain controller as if it were a replication partner. This does not require code execution on the DC itself — only appropriate replication privileges."},

    // ===== TA0007 DISCOVERY (8) =====
    {c:"TA0007 Discovery", q:"An adversary runs 'systeminfo' and 'ipconfig' on a compromised Windows host. Which ATT&CK technique does this represent?", a:"T1082 System Information Discovery — collecting details about the operating system, hardware, and network configuration.", d:["T1016 System Network Configuration Discovery — specifically gathering network settings and interface information.", "T1057 Process Discovery — listing running processes to identify security tools and potential privilege targets.", "T1518 Software Discovery — enumerating installed applications and their versions on the compromised endpoint."], e:"T1082 System Information Discovery covers commands like systeminfo, hostname, uname, and similar that collect system details (OS version, architecture, patch level, domain membership). T1016 specifically covers network configuration discovery."},
    {c:"TA0007 Discovery", q:"An adversary queries Active Directory for all user accounts and group memberships. Which technique is this?", a:"T1087.002 Account Discovery: Domain Account — enumerating domain user accounts and their properties.", d:["T1069.002 Permission Groups Discovery: Domain Groups — identifying domain security groups and their members.", "T1482 Domain Trust Discovery — mapping trust relationships between domains in a multi-domain environment.", "T1018 Remote System Discovery — identifying other hosts on the network that may be accessible for lateral movement."], e:"T1087.002 covers enumerating domain accounts using tools like net user /domain, PowerView's Get-DomainUser, LDAP queries, or BloodHound. T1069.002 specifically covers group enumeration, which is a related but distinct technique."},
    {c:"TA0007 Discovery", q:"An adversary uses BloodHound to map attack paths through an Active Directory environment. Which Discovery techniques does this primarily leverage?", a:"Multiple techniques including T1087.002 (Account Discovery), T1069.002 (Permission Groups), and T1482 (Domain Trust Discovery).", d:["Only T1087 Account Discovery, as BloodHound exclusively focuses on enumerating user accounts in the domain.", "Only T1018 Remote System Discovery, as BloodHound maps network connectivity between systems in the domain.", "Only T1082 System Information Discovery, as BloodHound collects operating system details from all domain hosts."], e:"BloodHound uses SharpHound to collect AD data spanning multiple techniques: account enumeration (T1087), group enumeration (T1069), trust mapping (T1482), session enumeration (T1049), and admin access mapping. It then graphs attack paths to high-value targets."},
    {c:"TA0007 Discovery", q:"An adversary runs 'arp -a' and 'net view' on a compromised Windows machine. What are they doing?", a:"T1018 Remote System Discovery — identifying other hosts on the network for potential lateral movement targets.", d:["T1016 System Network Configuration Discovery — determining the local machine's IP address and routing table.", "T1049 System Network Connections Discovery — listing active TCP connections and listening ports on the local host.", "T1135 Network Share Discovery — enumerating accessible file shares on remote systems across the network."], e:"T1018 Remote System Discovery covers techniques to identify other systems on the network. 'arp -a' reveals hosts in the ARP cache, 'net view' lists network neighbours. This information supports lateral movement planning."},
    {c:"TA0007 Discovery", q:"An adversary scans the compromised network for SMB shares containing sensitive documents. Which technique is this?", a:"T1135 Network Share Discovery — enumerating network file shares that may contain valuable data for collection.", d:["T1083 File and Directory Discovery — browsing the local file system for interesting files and directory structures.", "T1005 Data from Local System — collecting data from files on the local compromised system's file system.", "T1039 Data from Network Shared Drive — actually collecting and staging data from the discovered network shares."], e:"T1135 Network Share Discovery covers enumerating SMB/CIFS shares, NFS exports, and other network file shares. Tools like net share, smbclient, and PowerView's Find-DomainShare are commonly used. T1039 covers the actual data collection from those shares."},
    {c:"TA0007 Discovery", q:"An adversary checks which security tools are running on a compromised host by listing all processes. Which two techniques apply?", a:"T1057 Process Discovery (listing processes) and T1518.001 Software Discovery: Security Software Discovery (identifying security tools).", d:["T1082 System Information Discovery (collecting system details) and T1016 System Network Configuration Discovery (checking network).", "T1083 File and Directory Discovery (browsing files) and T1049 System Network Connections Discovery (checking connections).", "T1012 Query Registry (reading registry keys) and T1007 System Service Discovery (enumerating Windows services)."], e:"T1057 Process Discovery covers listing running processes (tasklist, Get-Process, ps). T1518.001 Security Software Discovery specifically covers identifying security products (AV, EDR, firewalls) to understand what defences must be evaded."},
    {c:"TA0007 Discovery", q:"An adversary maps trust relationships between Active Directory domains in a multi-forest environment. Which technique is this?", a:"T1482 Domain Trust Discovery — enumerating domain and forest trust relationships to identify potential access paths.", d:["T1087.002 Account Discovery: Domain Account — listing all user accounts across trusted domains in the forest.", "T1018 Remote System Discovery — identifying domain controllers and key servers in each trusted domain.", "T1069.002 Permission Groups Discovery: Domain Groups — enumerating group memberships across domain boundaries."], e:"T1482 Domain Trust Discovery covers using tools like nltest /domain_trusts, PowerView's Get-DomainTrust, and .NET classes to map trust relationships. Understanding trusts reveals paths for lateral movement across domain boundaries."},
    {c:"TA0007 Discovery", q:"An adversary runs 'whoami /all' on a compromised Windows system. What information does this provide and which technique does it map to?", a:"T1033 System Owner/User Discovery — identifying the current user, their privileges, and group memberships.", d:["T1087.001 Account Discovery: Local Account — enumerating all local user accounts configured on the system.", "T1082 System Information Discovery — collecting details about the operating system version and configuration.", "T1069.001 Permission Groups Discovery: Local Groups — listing all local security groups and their current members."], e:"T1033 System Owner/User Discovery covers determining the identity and context of the current user. 'whoami /all' reveals username, SID, group memberships, and privileges — critical for understanding what the adversary can do with their current access level."},

    // ===== TA0008 LATERAL MOVEMENT (8) =====
    {c:"TA0008 Lateral Movement", q:"An adversary uses stolen NTLM hashes to authenticate to other systems without knowing the plaintext password. Which technique is this?", a:"T1550.002 Use Alternate Authentication Material: Pass the Hash — authenticating using password hashes instead of cleartext.", d:["T1110 Brute Force — systematically attempting password combinations until a valid credential is found for the target.", "T1078 Valid Accounts — using compromised username and plaintext password combinations to access remote systems.", "T1021.002 Remote Services: SMB/Windows Admin Shares — connecting to administrative shares on remote Windows hosts."], e:"T1550.002 Pass the Hash uses NTLM hashes directly for authentication without cracking them to plaintext. Tools like mimikatz, pth-winexe, and CrackMapExec support this. The hash is sufficient for NTLM authentication protocol negotiation."},
    {c:"TA0008 Lateral Movement", q:"An adversary uses PsExec to execute commands on a remote Windows system. Which technique does this represent?", a:"T1021.002 Remote Services: SMB/Windows Admin Shares — using SMB and the ADMIN$ share for remote code execution.", d:["T1047 Windows Management Instrumentation — using WMI to remotely execute commands on target Windows systems.", "T1053.005 Scheduled Task/Job: Scheduled Task — creating a remote scheduled task for code execution on the target.", "T1570 Lateral Tool Transfer — copying tools and files to the remote system for execution during lateral movement."], e:"PsExec works by connecting to the ADMIN$ share over SMB, uploading a service binary, and creating/starting a remote service. This falls under T1021.002 (SMB/Windows Admin Shares) for the lateral movement, and T1569.002 (Service Execution) for the execution method."},
    {c:"TA0008 Lateral Movement", q:"An adversary uses RDP to interactively control a remote system using compromised credentials. Which technique is this?", a:"T1021.001 Remote Services: Remote Desktop Protocol — using RDP for interactive lateral movement within the network.", d:["T1021.004 Remote Services: SSH — using secure shell to connect to a remote system for interactive command execution.", "T1021.006 Remote Services: Windows Remote Management — using WinRM for remote PowerShell command execution.", "T1219 Remote Access Software — installing third-party remote access tools for interactive control of the system."], e:"T1021.001 covers using RDP for lateral movement. RDP provides a full interactive desktop session on the remote system. Adversaries often use compromised domain credentials or local admin accounts to RDP to additional systems."},
    {c:"TA0008 Lateral Movement", q:"An adversary copies their tools from the initial compromised host to another system on the network. Which technique is this?", a:"T1570 Lateral Tool Transfer — transferring tools and payloads between compromised systems within the network.", d:["T1105 Ingress Tool Transfer — downloading tools from an external server to the initially compromised system.", "T1021.002 Remote Services: SMB/Windows Admin Shares — connecting to remote shares for administrative access.", "T1071.002 Application Layer Protocol: File Transfer Protocols — using FTP to transfer data to external servers."], e:"T1570 Lateral Tool Transfer covers adversaries moving tools between internal systems (e.g., via SMB, SCP, or shared network drives). This is distinct from T1105 Ingress Tool Transfer, which covers downloading tools from external infrastructure."},
    {c:"TA0008 Lateral Movement", q:"An adversary exploits an internal-only service vulnerability to gain access to another system on the network. Which technique is this?", a:"T1210 Exploitation of Remote Services — exploiting vulnerabilities in services accessible only within the internal network.", d:["T1190 Exploit Public-Facing Application — exploiting vulnerabilities in internet-facing services for initial access.", "T1068 Exploitation for Privilege Escalation — exploiting local vulnerabilities to gain higher privileges on the current host.", "T1211 Exploitation for Defense Evasion — exploiting vulnerabilities in security tools to bypass detection mechanisms."], e:"T1210 covers exploiting vulnerabilities in internal network services for lateral movement (e.g., EternalBlue/MS17-010 against internal SMB, BlueKeep against internal RDP). This is distinct from T1190 which targets internet-facing services."},
    {c:"TA0008 Lateral Movement", q:"An adversary uses WinRM (Windows Remote Management) to execute PowerShell commands on remote systems. Which technique is this?", a:"T1021.006 Remote Services: Windows Remote Management — using WinRM/PSRemoting for remote command execution.", d:["T1047 Windows Management Instrumentation — using WMI for remote command execution on Windows target systems.", "T1059.001 Command and Scripting Interpreter: PowerShell — using PowerShell to execute commands on the local system.", "T1021.002 Remote Services: SMB/Windows Admin Shares — connecting to ADMIN$ shares for remote service creation."], e:"T1021.006 covers WinRM (typically port 5985/5986) and PowerShell Remoting (PSRemoting/Enter-PSSession/Invoke-Command). WinRM provides remote command execution capabilities and is increasingly used by adversaries and legitimate administrators."},
    {c:"TA0008 Lateral Movement", q:"An adversary steals a Kerberos TGS ticket and replays it to access a service. Which technique is this?", a:"T1550.003 Use Alternate Authentication Material: Pass the Ticket — reusing stolen Kerberos tickets for authentication.", d:["T1558.003 Steal or Forge Kerberos Tickets: Kerberoasting — cracking TGS tickets to recover service account passwords.", "T1550.002 Use Alternate Authentication Material: Pass the Hash — using NTLM hashes directly for network authentication.", "T1558.001 Steal or Forge Kerberos Tickets: Golden Ticket — forging TGTs using the compromised KRBTGT account hash."], e:"T1550.003 Pass the Ticket covers reusing (replaying) stolen Kerberos tickets (TGT or TGS) to authenticate to services without knowing the underlying password. This is distinct from Kerberoasting (cracking tickets) or Golden/Silver tickets (forging tickets)."},
    {c:"TA0008 Lateral Movement", q:"What is the key difference between T1021 (Remote Services) and T1072 (Software Deployment Tools) for lateral movement?", a:"T1021 uses standard remote access protocols, while T1072 abuses enterprise software deployment and management tools.", d:["T1021 is used only for Windows lateral movement, while T1072 covers cross-platform movement to Linux systems.", "T1021 requires valid credentials for authentication, while T1072 exploits vulnerabilities and needs no credentials.", "T1021 targets individual systems one at a time, while T1072 is exclusively used for mass deployment across networks."], e:"T1021 covers using standard protocols (RDP, SSH, SMB, WinRM, VNC). T1072 covers abusing enterprise tools like SCCM, Puppet, Chef, Ansible, or GPO deployment to push malicious payloads to multiple systems — leveraging the tool's existing trusted access."},

    // ===== TA0009 COLLECTION (5) =====
    {c:"TA0009 Collection", q:"An adversary captures screenshots of a user's desktop on a compromised system at regular intervals. Which technique is this?", a:"T1113 Screen Capture — recording the visual contents of the display to collect information shown on screen.", d:["T1056.001 Input Capture: Keylogging — recording the user's keystrokes to capture typed credentials and data.", "T1123 Audio Capture — recording audio from the compromised system's microphone for surveillance purposes.", "T1125 Video Capture — recording video from the compromised system's webcam for visual surveillance activity."], e:"T1113 Screen Capture covers taking screenshots or recording the screen. This can capture information displayed on screen including sensitive documents, emails, and application content that wouldn't be captured by keylogging."},
    {c:"TA0009 Collection", q:"An adversary searches for files containing 'password' or 'confidential' on a compromised system. Which technique is this?", a:"T1005 Data from Local System — collecting files and data of interest from the local compromised file system.", d:["T1083 File and Directory Discovery — browsing the file system structure to identify locations of interesting files.", "T1119 Automated Collection — using scripts to systematically gather predefined types of data from the system.", "T1074.001 Data Staged: Local Data Staging — preparing collected data in a central location before exfiltration."], e:"T1005 Data from Local System covers the actual collection of data from local files. T1083 (Discovery) covers finding where files are. T1119 covers automating the collection process. T1074 covers staging collected data for exfiltration. These are related but distinct steps."},
    {c:"TA0009 Collection", q:"An adversary sets up email forwarding rules to copy all of a target executive's incoming emails to an external address. Which technique is this?", a:"T1114.003 Email Collection: Email Forwarding Rule — creating mail rules to automatically forward copies of email messages.", d:["T1114.002 Email Collection: Remote Email Collection — accessing a mail server to directly read and download email messages.", "T1114.001 Email Collection: Local Email Collection — extracting emails from local email client data files on disk.", "T1071.003 Application Layer Protocol: Mail Protocols — using SMTP/IMAP protocols for command and control communication."], e:"T1114.003 covers adversaries creating email forwarding or transport rules (e.g., Exchange Inbox Rules, Gmail filters) to silently redirect copies of emails. This provides ongoing collection without repeated access to the mail server."},
    {c:"TA0009 Collection", q:"An adversary compresses and encrypts collected data before moving it to an exfiltration staging directory. Which technique does the staging represent?", a:"T1074.001 Data Staged: Local Data Staging — organising collected data in a local location in preparation for exfiltration.", d:["T1560.001 Archive Collected Data: Archive via Utility — using tools like 7zip or tar to compress and package collected files.", "T1048 Exfiltration Over Alternative Protocol — transferring the staged data out of the network using non-standard channels.", "T1041 Exfiltration Over C2 Channel — sending the collected data through the existing command and control communication."], e:"T1074 Data Staged covers placing collected data in a central location before exfiltration. T1560 covers the archiving/compression step. T1041/T1048 cover the actual exfiltration. These are separate techniques that often form a sequential chain."},
    {c:"TA0009 Collection", q:"An adversary uses clipboard monitoring to capture data that users copy and paste. Which technique is this?", a:"T1115 Clipboard Data — monitoring and collecting data stored in the system clipboard during user activity.", d:["T1056.001 Input Capture: Keylogging — recording individual keystrokes typed by the user on the keyboard.", "T1113 Screen Capture — capturing visual screenshots of the user's current display and active applications.", "T1005 Data from Local System — searching the file system for files containing sensitive data and credentials."], e:"T1115 Clipboard Data covers monitoring the system clipboard for copied passwords, sensitive text, cryptocurrency addresses, and other data. Users often copy-paste sensitive information, making this a valuable collection technique."},

    // ===== TA0011 COMMAND AND CONTROL (7) =====
    {c:"TA0011 Command & Control", q:"An adversary's malware communicates with its C2 server over HTTPS on port 443. Which technique does this represent?", a:"T1071.001 Application Layer Protocol: Web Protocols — using HTTP/HTTPS for command and control communications.", d:["T1573.001 Encrypted Channel: Symmetric Cryptography — encrypting C2 traffic with symmetric encryption algorithms.", "T1095 Non-Application Layer Protocol — using raw TCP or UDP sockets for direct command and control traffic.", "T1572 Protocol Tunneling — encapsulating C2 traffic within a different protocol to evade network monitoring."], e:"T1071.001 covers C2 communication over HTTP/HTTPS. Port 443 is a common choice because HTTPS traffic is allowed through most firewalls and the encryption prevents payload inspection. T1573 (Encrypted Channel) may also apply for the TLS encryption."},
    {c:"TA0011 Command & Control", q:"An adversary's implant uses DNS queries to exfiltrate data and receive commands. Which technique is this?", a:"T1071.004 Application Layer Protocol: DNS — using DNS queries and responses for command and control communication.", d:["T1048.001 Exfiltration Over Alternative Protocol: Exfiltration Over Symmetric Encrypted Non-C2 Protocol — using DNS for data theft.", "T1568.001 Dynamic Resolution: Fast Flux DNS — rapidly rotating C2 server IP addresses to evade DNS-based blocking.", "T1583.001 Acquire Infrastructure: Domains — registering domain names to establish DNS-based C2 infrastructure."], e:"T1071.004 covers using DNS for C2. Data is encoded in DNS queries (subdomains, TXT records) and responses. DNS traffic is rarely blocked and often not inspected, making it an effective covert channel. Tools like DNScat2 and Cobalt Strike DNS Beacon use this."},
    {c:"TA0011 Command & Control", q:"An adversary uses a legitimate cloud service (like Google Drive or Dropbox) as their C2 channel. Which technique applies?", a:"T1102 Web Service — using legitimate external web services for command and control to blend with normal traffic.", d:["T1071.001 Application Layer Protocol: Web Protocols — using HTTP/HTTPS protocols for standard web-based C2 communication.", "T1568 Dynamic Resolution — using cloud services to dynamically resolve the current C2 server address for the implant.", "T1104 Multi-Stage Channels — establishing multiple separate communication channels for different phases of the operation."], e:"T1102 Web Service covers using legitimate services (Google Drive, Dropbox, Twitter, GitHub, Slack) for C2. Traffic to these domains is typically trusted and allowed through firewalls, providing excellent blending with normal corporate traffic."},
    {c:"TA0011 Command & Control", q:"An adversary's malware uses domain generation algorithms (DGAs) to determine its C2 server address. Which technique is this?", a:"T1568.002 Dynamic Resolution: Domain Generation Algorithms — algorithmically generating domain names for C2 resolution.", d:["T1568.001 Dynamic Resolution: Fast Flux DNS — rapidly changing DNS records to rotate C2 server IP addresses.", "T1071.004 Application Layer Protocol: DNS — using DNS queries as the transport mechanism for C2 communications.", "T1583.001 Acquire Infrastructure: Domains — pre-registering multiple domains for use as C2 server addresses."], e:"T1568.002 covers DGAs that generate pseudo-random domain names based on seeds (date, counter). The adversary registers a subset of generated domains. This makes C2 infrastructure resilient against takedowns — the malware always generates new domains."},
    {c:"TA0011 Command & Control", q:"An adversary tunnels their C2 traffic through an SSH connection to evade network detection. Which technique does this represent?", a:"T1572 Protocol Tunneling — encapsulating C2 communications within another protocol to bypass network monitoring.", d:["T1573.002 Encrypted Channel: Asymmetric Cryptography — using asymmetric encryption for securing C2 communications.", "T1090.001 Proxy: Internal Proxy — routing C2 traffic through an internal system to reach the external C2 server.", "T1021.004 Remote Services: SSH — using SSH to connect to a remote system for interactive command execution."], e:"T1572 Protocol Tunneling covers wrapping C2 traffic inside another protocol (SSH, DNS, ICMP, HTTP). This differs from simply encrypting traffic (T1573) — the key distinction is encapsulating one protocol's traffic within another protocol's channel."},
    {c:"TA0011 Command & Control", q:"An adversary configures their implant to beacon to the C2 server at random intervals between 30 and 90 minutes. What is the purpose of this?", a:"Jitter in beacon timing evades detection by making C2 traffic patterns irregular and harder to identify algorithmically.", d:["The random interval improves network throughput by distributing beacon traffic evenly across the time period.", "Beacon timing is randomised to synchronise with the target's business hours for maximum data collection.", "The variable interval prevents the C2 server from being overwhelmed by simultaneous beacons from many implants."], e:"C2 frameworks like Cobalt Strike use jitter (randomised timing) to prevent network monitoring tools from detecting regular beaconing patterns. Fixed-interval beacons create detectable periodic traffic that network detection systems can identify statistically."},
    {c:"TA0011 Command & Control", q:"An adversary routes their C2 traffic through a chain of compromised systems acting as proxies. Which technique is this?", a:"T1090.003 Proxy: Multi-hop Proxy — routing C2 traffic through multiple intermediate systems to obscure the true C2 server.", d:["T1090.001 Proxy: Internal Proxy — using a single internal host to relay C2 traffic between the implant and the server.", "T1104 Multi-Stage Channels — using different C2 channels for different stages of the adversary's attack operation.", "T1572 Protocol Tunneling — encapsulating C2 traffic within another protocol's communication channel for evasion."], e:"T1090.003 Multi-hop Proxy covers routing C2 through multiple intermediary systems (proxies, VPNs, Tor, compromised hosts) to hide the true source. This makes attribution and takedown significantly more difficult for defenders and law enforcement."},

    // ===== TA0010 EXFILTRATION (5) =====
    {c:"TA0010 Exfiltration", q:"An adversary sends stolen data out of the network through their existing C2 channel. Which technique is this?", a:"T1041 Exfiltration Over C2 Channel — using the established command and control connection to transfer collected data.", d:["T1048 Exfiltration Over Alternative Protocol — using a different protocol than C2 to transfer data out of the network.", "T1567 Exfiltration Over Web Service — uploading stolen data to legitimate cloud storage or web services for retrieval.", "T1052 Exfiltration Over Physical Medium — copying stolen data to removable media for physical removal from the site."], e:"T1041 is the simplest exfiltration method — reusing the existing C2 channel. This avoids opening new network connections that might be detected. The trade-off is that large data transfers may be noticed as anomalous C2 traffic volume."},
    {c:"TA0010 Exfiltration", q:"An adversary uploads stolen data to a personal Dropbox account using the Dropbox API. Which technique is this?", a:"T1567.002 Exfiltration Over Web Service: Exfiltration to Cloud Storage — uploading data to cloud storage platforms.", d:["T1041 Exfiltration Over C2 Channel — sending data through the existing command and control communication channel.", "T1048.003 Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol — using plaintext protocols.", "T1102 Web Service — using legitimate web services as a command and control channel for the adversary's implant."], e:"T1567.002 covers exfiltration to cloud storage services (Dropbox, Google Drive, OneDrive, Box). Traffic to these services is typically trusted and allowed by corporate firewalls, making detection difficult without deep content inspection."},
    {c:"TA0010 Exfiltration", q:"An adversary encodes stolen data in DNS TXT record queries to slowly exfiltrate it from the target network. Which technique is this?", a:"T1048.001 Exfiltration Over Alternative Protocol: Exfiltration Over Symmetric Encrypted Non-C2 Protocol — using DNS for data exfiltration.", d:["T1071.004 Application Layer Protocol: DNS — using DNS for command and control communications with the C2 server.", "T1567 Exfiltration Over Web Service — uploading data to a web service using DNS-over-HTTPS for transport encryption.", "T1041 Exfiltration Over C2 Channel — exfiltrating data through the primary command and control DNS-based channel."], e:"Using DNS for exfiltration falls under T1048 when it's a separate exfiltration channel (distinct from C2). Data is encoded in DNS queries and sent to an adversary-controlled authoritative name server. If DNS is also the C2 channel, T1041 may apply instead."},
    {c:"TA0010 Exfiltration", q:"An adversary limits the size and frequency of their data exfiltration to avoid triggering network DLP alerts. Which technique is this?", a:"T1030 Data Transfer Size Limits — breaking exfiltrated data into small chunks to evade detection thresholds.", d:["T1029 Scheduled Transfer — transferring data only at specific times to coincide with legitimate traffic patterns.", "T1560 Archive Collected Data — compressing data before exfiltration to reduce the total volume transferred.", "T1048 Exfiltration Over Alternative Protocol — using a different protocol to bypass DLP monitoring entirely."], e:"T1030 covers adversaries limiting data transfer sizes to stay below detection thresholds. Combined with T1029 (Scheduled Transfer — timing exfiltration to blend with normal traffic), these techniques make exfiltration harder to detect via volumetric analysis."},
    {c:"TA0010 Exfiltration", q:"An adversary copies stolen data to a USB drive for physical removal from a secure, air-gapped facility. Which technique is this?", a:"T1052.001 Exfiltration Over Physical Medium: Exfiltration over USB — using removable storage to physically remove data.", d:["T1091 Replication Through Removable Media — using USB devices to spread malware to other systems in the facility.", "T1200 Hardware Additions — connecting rogue hardware devices to the network for data collection and exfiltration.", "T1567 Exfiltration Over Web Service — uploading data to cloud storage via a USB-tethered mobile data connection."], e:"T1052.001 covers physical exfiltration via USB drives, external hard drives, or other removable media. This is particularly relevant for air-gapped environments where network-based exfiltration is not possible."},

    // ===== TA0040 IMPACT (6) =====
    {c:"TA0040 Impact", q:"An adversary encrypts all files on a compromised system and demands payment for the decryption key. Which technique is this?", a:"T1486 Data Encrypted for Impact — encrypting data to disrupt availability and typically demand a ransom payment.", d:["T1485 Data Destruction — irreversibly destroying data on the compromised system to cause permanent data loss.", "T1490 Inhibit System Recovery — deleting backups and shadow copies to prevent the victim from restoring their data.", "T1561.002 Disk Wipe: Disk Structure Wipe — overwriting disk structures to render the system completely unbootable."], e:"T1486 Data Encrypted for Impact is the primary technique for ransomware. It's often combined with T1490 (Inhibit System Recovery — deleting backups/shadow copies) and T1489 (Service Stop — stopping backup services) for maximum impact."},
    {c:"TA0040 Impact", q:"An adversary deletes Volume Shadow Copies and disables Windows Recovery before deploying ransomware. Which technique is this?", a:"T1490 Inhibit System Recovery — removing backup capabilities to prevent the victim from restoring encrypted data.", d:["T1486 Data Encrypted for Impact — encrypting files to make them inaccessible until a ransom payment is made.", "T1485 Data Destruction — permanently destroying data by overwriting or deleting files beyond any recovery method.", "T1562.001 Impair Defenses: Disable or Modify Tools — disabling security software to prevent detection of the attack."], e:"T1490 covers actions like 'vssadmin delete shadows', disabling Windows Recovery, deleting backup catalogs, and stopping backup services. This is a standard pre-ransomware step that maximises the pressure on victims to pay the ransom."},
    {c:"TA0040 Impact", q:"An adversary defaces a target organisation's public website with political messaging. Which technique does this represent?", a:"T1491.002 Defacement: External Defacement — modifying externally visible content to deliver messaging to a public audience.", d:["T1491.001 Defacement: Internal Defacement — modifying internal-facing content to intimidate or demoralise employees.", "T1485 Data Destruction — destroying the website's content and backend data to cause lasting operational disruption.", "T1498 Network Denial of Service — overwhelming the web server with traffic to make the website unavailable to users."], e:"T1491.002 External Defacement covers modifying websites, social media pages, or other externally visible content. This is often used by hacktivists and nation-state actors for psychological impact and public messaging."},
    {c:"TA0040 Impact", q:"An adversary stops critical database and email services on compromised servers before deploying their ransomware. Which technique is this?", a:"T1489 Service Stop — stopping services to free files for encryption and maximise the operational impact of the attack.", d:["T1499 Endpoint Denial of Service — overwhelming individual endpoints with traffic to make their services unavailable.", "T1498 Network Denial of Service — flooding the network to disrupt all communication and connectivity between systems.", "T1529 System Shutdown/Reboot — forcing systems to shut down or reboot to cause temporary disruption of all services."], e:"T1489 Service Stop covers adversaries stopping services (particularly database, email, and backup services) before deploying ransomware. This ensures files are not locked by running services and cannot be recovered from active backup processes."},
    {c:"TA0040 Impact", q:"An adversary wipes the Master Boot Record (MBR) of all systems in a target network, rendering them unbootable. Which technique is this?", a:"T1561.002 Disk Wipe: Disk Structure Wipe — overwriting or erasing critical disk structures to prevent system booting.", d:["T1561.001 Disk Wipe: Disk Content Wipe — overwriting all data on the disk sectors to destroy stored file contents.", "T1485 Data Destruction — deleting individual files and directories to cause data loss without affecting system boot.", "T1486 Data Encrypted for Impact — encrypting the boot record to demand a ransom for the decryption key."], e:"T1561.002 Disk Structure Wipe covers destructive wiping of MBR, partition tables, or volume boot records. Examples include NotPetya and Shamoon (Disttrack), which wiped disk structures to cause mass, irrecoverable system destruction."},
    {c:"TA0040 Impact", q:"An adversary manipulates financial data in a database to cause the target organisation to make incorrect business decisions. Which technique is this?", a:"T1565.001 Data Manipulation: Stored Data Manipulation — modifying data at rest to compromise its integrity and reliability.", d:["T1485 Data Destruction — deleting the financial records entirely to prevent the organisation from accessing their data.", "T1486 Data Encrypted for Impact — encrypting the financial database and demanding payment for the decryption key.", "T1005 Data from Local System — collecting financial data from the database for exfiltration to an external server."], e:"T1565 Data Manipulation covers modifying data to compromise integrity. T1565.001 (Stored Data Manipulation) alters data at rest, T1565.002 (Transmitted Data Manipulation) alters data in transit, and T1565.003 (Runtime Data Manipulation) alters data in memory."},

    // ===== DETECTION & PRACTICAL APPLICATION (8) =====
    {c:"Detection & Application", q:"A security analyst detects multiple failed Kerberos TGS requests for different SPNs from a single user in a short timeframe. What ATT&CK technique is likely being attempted?", a:"T1558.003 Kerberoasting — the analyst is observing bulk TGS ticket requests indicative of service account password cracking.", d:["T1110.001 Brute Force: Password Guessing — the user is attempting to guess passwords for multiple service accounts.", "T1078 Valid Accounts — the user is testing stolen credentials against multiple services to find valid access paths.", "T1087.002 Account Discovery: Domain Account — the user is enumerating domain accounts to identify potential targets."], e:"Bulk TGS requests for different SPNs from a single account is a key indicator of Kerberoasting (T1558.003). Detection involves monitoring Event ID 4769 (Kerberos Service Ticket Operations) for anomalous patterns."},
    {c:"Detection & Application", q:"A SIEM alert fires when a process named 'svchost.exe' is observed running from the C:\\Users\\Public directory. Which technique is being detected?", a:"T1036.005 Masquerading: Match Legitimate Name or Location — the binary uses a legitimate name but runs from an unusual path.", d:["T1543.003 Create or Modify System Process: Windows Service — a malicious Windows service has been installed on the system.", "T1059.003 Command and Scripting Interpreter: Windows Command Shell — cmd.exe is being used to execute malicious commands.", "T1055 Process Injection — malicious code has been injected into the legitimate svchost.exe process in system memory."], e:"Legitimate svchost.exe runs from C:\\Windows\\System32. Detecting instances running from other locations (like user directories) is a strong indicator of T1036.005 Masquerading. Path-based detection rules are effective for catching this technique."},
    {c:"Detection & Application", q:"How should a security team use the MITRE ATT&CK framework to assess their detection coverage gaps?", a:"Map existing detection rules and data sources against the ATT&CK matrix to identify techniques with no monitoring.", d:["Run every ATT&CK technique against production systems and check which ones trigger alerts in the security stack.", "Compare the organisation's security budget against MITRE's recommended spending guidelines for each technique.", "Count the total number of ATT&CK techniques and divide by the number of security tools to calculate coverage."], e:"Gap analysis involves mapping detection capabilities (SIEM rules, EDR detections, log sources) to ATT&CK techniques using the Navigator. Unmapped techniques represent blind spots. Teams then prioritise based on threat intelligence about relevant adversaries."},
    {c:"Detection & Application", q:"An analyst observes a scheduled task created via 'schtasks.exe /create' on a server that typically has no scheduled tasks. Which ATT&CK techniques should they investigate?", a:"T1053.005 Scheduled Task/Job: Scheduled Task (for persistence/execution) and potentially T1059 for the payload being scheduled.", d:["Only T1082 System Information Discovery, as schtasks is commonly used for system reconnaissance activity on servers.", "Only T1070 Indicator Removal, as creating a scheduled task is a common method for covering tracks after an intrusion.", "Only T1547.001 Boot or Logon Autostart Execution: Registry Run Keys, since scheduled tasks and registry keys are equivalent."], e:"schtasks.exe creation on an unusual host warrants investigating T1053.005 (the scheduling itself), the scheduled command/payload (potentially T1059 Command and Scripting Interpreter), and whether it indicates persistence or lateral movement."},
    {c:"Detection & Application", q:"What Windows Event ID is most useful for detecting the creation of new services, which may indicate T1543.003?", a:"Event ID 7045 (A service was installed in the system) from the System Event Log records new service creation.", d:["Event ID 4624 (An account was successfully logged on) from the Security Log tracks all authentication events.", "Event ID 4688 (A new process has been created) from the Security Log records all new process creation events.", "Event ID 1102 (The audit log was cleared) from the Security Log indicates that event log tampering occurred."], e:"Windows Event ID 7045 in the System log records when a new service is installed, capturing the service name, path, and account. This is the primary detection for T1543.003 (Windows Service persistence) and tools like PsExec."},
    {c:"Detection & Application", q:"A security team wants to emulate APT29 (Cozy Bear) to test their defences. How should they use ATT&CK for this?", a:"Reference APT29's ATT&CK Group page to identify their documented techniques, then build an emulation plan replicating those TTPs.", d:["Use automated vulnerability scanning tools to test for all known CVEs associated with APT29's historical campaigns.", "Focus exclusively on detecting APT29's known malware signatures and indicators of compromise in network traffic.", "Run a standard penetration test against internet-facing systems, as APT29 primarily targets external infrastructure."], e:"ATT&CK's Group pages document each threat actor's known techniques, software, and procedures. MITRE also publishes detailed adversary emulation plans (e.g., APT29 Evaluation) that red teams can follow to test whether defences detect specific adversary tradecraft."},
    {c:"Detection & Application", q:"What is the value of mapping incident response findings to MITRE ATT&CK techniques during post-incident analysis?", a:"It creates a structured record of adversary behaviour that enables gap analysis and improves future detection capabilities.", d:["It automatically generates a compliance report that satisfies all major regulatory and audit framework requirements.", "It replaces the need for traditional forensic analysis by providing a pre-built timeline of the adversary's actions.", "It identifies the specific vulnerability that was exploited, eliminating the need for separate vulnerability assessment."], e:"Mapping IR findings to ATT&CK provides a common language for the incident, enables identification of detection gaps (techniques that were not alerted on), supports threat intelligence sharing, and helps prioritise security improvements."},
    {c:"Detection & Application", q:"A purple team exercise reveals that the security stack fails to detect T1003.001 (LSASS Memory Credential Dumping). What mitigations should be considered?", a:"Enable Credential Guard, restrict debug privileges, deploy LSASS process protection, and create detection rules for LSASS access.", d:["Disable LSASS entirely on all workstations since it is only required on domain controllers for authentication.", "Implement network-level encryption to prevent credential hashes from being intercepted during network transmission.", "Focus detection efforts exclusively on the exfiltration phase, as credential dumping cannot be reliably prevented."], e:"ATT&CK's mitigation for T1003.001 includes M1043 Credential Access Protection (Credential Guard), restricting SeDebugPrivilege, enabling LSASS Protected Process Light (PPL), and monitoring for suspicious access to the LSASS process (Sysmon Event ID 10)."}
];

// ==============================================================
// ENGINE
// ==============================================================
const TOTAL = 120;
let examQs = [], answered = {}, userAns = {}, flagged = {}, curr = 0;

function shuffle(arr) {
    for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
}

function initExam() {
    const shuffled = shuffle([...pool]);
    examQs = shuffled.slice(0, TOTAL);
    answered = {}; userAns = {}; flagged = {}; curr = 0;

    examQs.forEach((q, i) => {
        const opts = shuffle([q.a, ...q.d]);
        examQs[i]._opts = opts;
    });

    document.getElementById('start-screen').style.display='none';
    document.getElementById('results-screen').style.display='none';
    document.getElementById('exam-ui').style.display='flex';
    document.getElementById('footer').style.display='flex';

    renderSide(); loadQ(0); updateProgress();
}

function updateProgress() {
    const cnt = Object.keys(answered).length;
    document.getElementById('progress-display').innerText = `${cnt} / ${TOTAL}`;
    document.getElementById('finish-btn').style.display = cnt === TOTAL ? 'inline-block' : 'none';
}

function renderSide() {
    const sb = document.getElementById('sidebar'); sb.innerHTML='';
    examQs.forEach((q,i) => {
        const b = document.createElement('button');
        b.className = 'nav-btn'; b.innerText = i+1;
        b.id = `nav-${i}`; b.onclick = () => loadQ(i);
        sb.appendChild(b);
    });
}

function loadQ(i) {
    curr = i;
    const q = examQs[i];

    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
    document.getElementById(`nav-${i}`).classList.add('active');
    document.getElementById('status').innerText = `Q ${i+1} / ${TOTAL}`;

    const con = document.getElementById('question-container'); con.innerHTML='';
    const card = document.createElement('div'); card.className='card';

    let html = `<div class="q-meta"><span class="tag">${q.c}</span><span class="q-num">#${i+1}</span></div><div class="q-text">${q.q}</div>`;

    const isAnswered = answered[i] !== undefined;

    q._opts.forEach((o, oi) => {
        let cls = 'option';
        if (isAnswered) {
            cls += ' locked';
            if (o === q.a) cls += ' opt-correct';
            else if (o === userAns[i]) cls += ' opt-wrong';
            else cls += ' opt-dim';
        }
        const clickHandler = isAnswered ? '' : `onclick="ans(${i}, ${oi})"`;
        html += `<div class="${cls}" ${clickHandler}>${o}</div>`;
    });

    if (isAnswered) {
        const wasCorrect = userAns[i] === q.a;
        html += `<div class="explanation-box"><strong>${wasCorrect ? '✓ Correct' : '✗ Incorrect'}</strong><br>${q.e}</div>`;
        if (i < TOTAL - 1) {
            html += `<div class="next-btn-wrap"><button class="btn btn-p" onclick="loadQ(${i+1})">Next Question →</button></div>`;
        }
    }

    card.innerHTML = html; con.appendChild(card);
    con.scrollTop = 0;
}

function ans(qi, optIdx) {
    const q = examQs[qi];
    userAns[qi] = q._opts[optIdx];
    answered[qi] = true;

    const navBtn = document.getElementById(`nav-${qi}`);
    if (userAns[qi] === q.a) {
        navBtn.classList.add('answered-correct');
    } else {
        navBtn.classList.add('answered-wrong');
    }

    loadQ(qi);
    updateProgress();
}

function nav(d) {
    const n = curr + d;
    if(n >= 0 && n < TOTAL) loadQ(n);
}

function flag() {
    flagged[curr] = !flagged[curr];
    const b = document.getElementById(`nav-${curr}`);
    if(flagged[curr]) b.classList.add('flagged'); else b.classList.remove('flagged');
}

function finish() {
    if(!confirm('Finish the quiz and see your results?')) return;
    document.getElementById('exam-ui').style.display='none';
    document.getElementById('footer').style.display='none';

    const resScreen = document.getElementById('results-screen');
    resScreen.style.display='block';
    resScreen.scrollTop = 0;

    let score = 0;
    let html = '';

    examQs.forEach((q, i) => {
        const correct = userAns[i] === q.a;
        if(correct) score++;
        html += `<div class="review-item ${correct?'correct':'wrong'}">
            <strong>Q${i+1} [${q.c}]: ${q.q}</strong><br>
            Your Answer: <b style="color:${correct?'#4ade80':'#f87171'}">${userAns[i]||'Skipped'}</b><br>
            ${!correct ? `Correct Answer: <b style="color:#4ade80">${q.a}</b>` : ''}
            <div class="review-explanation">Rationale: ${q.e}</div>
        </div>`;
    });

    const pct = Math.round((score/TOTAL)*100);

    document.getElementById('score-circle').innerText = `${pct}%`;
    document.getElementById('raw-score').innerText = `You answered ${score} out of ${TOTAL} questions correctly.`;
    document.getElementById('review-list').innerHTML = html;
}
</script>
</body>
</html>
