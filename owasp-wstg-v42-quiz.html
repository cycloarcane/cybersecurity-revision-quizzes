<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OWASP WSTG v4.2 — Web Security Testing Knowledge Quiz</title>
<style>
    @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Source+Sans+3:wght@400;600;700;900&display=swap');
    :root { --header:#1a1a2e; --bg:#0f0f1a; --white:#16213e; --primary:#e94560; --success:#0f9b58; --danger:#e94560; --warning:#f5a623; --text:#e0e0e0; --card:#16213e; --accent:#533483; --border:#2a2a4a; }
    ::-webkit-scrollbar { width:10px; } ::-webkit-scrollbar-track { background:#0a0a15; } ::-webkit-scrollbar-thumb { background:#533483; border-radius:5px; border:2px solid #0a0a15; }
    * { box-sizing:border-box; }
    body { font-family:'Source Sans 3',sans-serif; background:var(--bg); color:var(--text); margin:0; display:flex; flex-direction:column; height:100vh; overflow:hidden; }
    .header { background:linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%); color:#fff; padding:15px 30px; display:flex; justify-content:space-between; align-items:center; box-shadow:0 4px 20px rgba(233,69,96,0.15); flex-shrink:0; z-index:10; border-bottom:2px solid var(--primary); }
    .header-title { font-family:'JetBrains Mono',monospace; font-size:1.4em; font-weight:700; letter-spacing:1px; }
    .header-title span { color:var(--primary); }
    .progress-text { font-family:'JetBrains Mono',monospace; font-size:1.1em; font-weight:700; color:var(--warning); background:rgba(0,0,0,0.4); padding:6px 18px; border-radius:6px; border:1px solid rgba(245,166,35,0.3); }
    .main { display:flex; flex:1; overflow:hidden; }
    .sidebar { width:260px; background:#111125; border-right:1px solid var(--border); overflow-y:auto; padding:12px; display:grid; grid-template-columns:repeat(5,1fr); gap:6px; align-content:start; flex-shrink:0; }
    .nav-btn { height:34px; border:1px solid var(--border); background:#1a1a2e; cursor:pointer; font-weight:700; font-size:0.82em; border-radius:5px; transition:all 0.15s; color:#8888aa; font-family:'JetBrains Mono',monospace; }
    .nav-btn:hover { background:#2a2a4a; color:#ccc; border-color:#533483; }
    .nav-btn.active { background:var(--primary); color:white; border-color:var(--primary); box-shadow:0 0 10px rgba(233,69,96,0.4); }
    .nav-btn.answered-correct { background:#0d2818; border-color:var(--success); color:#4ade80; }
    .nav-btn.answered-wrong { background:#2d1018; border-color:var(--danger); color:#f87171; }
    .nav-btn.flagged { border:2px solid var(--warning); box-shadow:0 0 8px rgba(245,166,35,0.3); }
    .content { flex:1; padding:35px; overflow-y:auto; display:flex; justify-content:center; align-items:flex-start; }
    .card { background:var(--card); max-width:900px; width:100%; padding:45px; border-radius:12px; box-shadow:0 8px 32px rgba(0,0,0,0.3); margin-bottom:40px; border:1px solid var(--border); }
    .q-meta { display:flex; justify-content:space-between; align-items:center; margin-bottom:22px; border-bottom:1px solid var(--border); padding-bottom:14px; }
    .tag { background:var(--primary); color:white; padding:5px 14px; border-radius:20px; font-size:0.8em; font-weight:700; text-transform:uppercase; letter-spacing:1px; font-family:'JetBrains Mono',monospace; }
    .q-num { color:#666; font-family:'JetBrains Mono',monospace; font-size:0.9em; }
    .q-text { font-size:1.25em; font-weight:600; margin-bottom:30px; line-height:1.55; color:#e8e8e8; }
    .option { width:100%; text-align:left; padding:16px 22px; margin-bottom:12px; background:#111125; border:2px solid var(--border); border-radius:8px; cursor:pointer; font-size:1.05em; transition:all 0.2s; color:#c0c0d0; display:block; font-family:'Source Sans 3',sans-serif; }
    .option:hover:not(.locked) { border-color:#533483; background:#1a1a35; color:#e0e0e0; }
    .option.locked { cursor:default; }
    .option.opt-correct { border-color:var(--success); background:rgba(15,155,88,0.15); color:#4ade80; font-weight:700; }
    .option.opt-wrong { border-color:var(--danger); background:rgba(233,69,96,0.1); color:#f87171; }
    .option.opt-dim { opacity:0.5; }
    .explanation-box { margin-top:24px; padding:18px 22px; background:rgba(83,52,131,0.15); border:1px solid rgba(83,52,131,0.3); border-radius:8px; font-size:1em; color:#c8c0d8; line-height:1.6; }
    .explanation-box strong { color:#e0d0f0; }
    .next-btn-wrap { text-align:center; margin-top:22px; }
    .footer { background:#111125; padding:14px 35px; border-top:1px solid var(--border); display:flex; justify-content:space-between; align-items:center; flex-shrink:0; }
    .btn { padding:11px 28px; border:none; border-radius:6px; font-size:1.05em; font-weight:700; cursor:pointer; color:white; font-family:'Source Sans 3',sans-serif; transition:all 0.2s; }
    .btn:hover { transform:translateY(-1px); }
    .btn-s { background:#2a2a4a; } .btn-s:hover { background:#3a3a5a; }
    .btn-p { background:var(--primary); } .btn-p:hover { background:#d13555; }
    .btn-w { background:var(--warning); color:#111; } .btn-w:hover { background:#e09515; }
    .btn-g { background:var(--success); } .btn-g:hover { background:#0d8a4e; }
    #start-screen, #results-screen { position:fixed; top:0; left:0; width:100%; height:100%; background:var(--bg); z-index:2000; overflow-y:auto; }
    .center-wrapper { display:flex; flex-direction:column; align-items:center; justify-content:center; min-height:100vh; padding:40px; box-sizing:border-box; }
    .start-box { background:var(--card); padding:60px; border-radius:16px; box-shadow:0 20px 60px rgba(0,0,0,0.4); max-width:850px; text-align:center; border:1px solid var(--border); position:relative; overflow:hidden; }
    .start-box::before { content:''; position:absolute; top:0; left:0; right:0; height:4px; background:linear-gradient(90deg, var(--primary), var(--accent), var(--primary)); }
    .start-box h1 { color:#fff; margin-bottom:8px; font-size:2.8em; font-family:'JetBrains Mono',monospace; letter-spacing:2px; }
    .start-box h1 span { color:var(--primary); }
    .start-box .subtitle { font-size:1em; color:#666; margin-bottom:30px; font-family:'JetBrains Mono',monospace; letter-spacing:3px; text-transform:uppercase; }
    .start-box p { font-size:1.15em; line-height:1.7; color:#999; margin:25px 0; }
    .start-box .stats { display:flex; justify-content:center; gap:40px; margin:30px 0; }
    .start-box .stat { text-align:center; }
    .start-box .stat-num { font-size:2.2em; font-weight:900; color:var(--primary); font-family:'JetBrains Mono',monospace; }
    .start-box .stat-label { font-size:0.85em; color:#666; text-transform:uppercase; letter-spacing:2px; margin-top:4px; }
    .score-circle { width:200px; height:200px; border-radius:50%; display:flex; justify-content:center; align-items:center; font-size:3.8em; font-weight:900; color:white; margin:20px auto; box-shadow:0 10px 30px rgba(0,0,0,0.3); font-family:'JetBrains Mono',monospace; background:linear-gradient(135deg, var(--accent), #3a2066); border:6px solid #2a1850; }
    .review-item { text-align:left; background:var(--card); padding:22px; margin-bottom:16px; border-radius:10px; border-left:6px solid #444; width:100%; max-width:800px; box-shadow:0 2px 10px rgba(0,0,0,0.2); border:1px solid var(--border); }
    .review-item.correct { border-left-color:var(--success); }
    .review-item.wrong { border-left-color:var(--danger); }
    .review-item strong { color:#e0e0e0; }
    .review-explanation { margin-top:12px; font-size:0.92em; color:#aaa; background:rgba(83,52,131,0.15); padding:14px; border-radius:6px; border:1px solid rgba(83,52,131,0.3); }
    #status { font-weight:700; color:#666; font-size:1.05em; font-family:'JetBrains Mono',monospace; }
</style>
</head>
<body>
<div id="start-screen">
    <div class="center-wrapper">
        <div class="start-box">
            <h1><span>OWASP</span> WSTG v4.2</h1>
            <div class="subtitle">Web Security Testing Guide Quiz</div>
            <div class="stats">
                <div class="stat"><div class="stat-num">120</div><div class="stat-label">Questions</div></div>
                <div class="stat"><div class="stat-num">Self-paced</div><div class="stat-label">No Timer</div></div>
            </div>
            <p>
                Covers all 12 testing categories: Information Gathering, Configuration &amp; Deployment,
                Identity Management, Authentication, Authorization, Session Management,
                Input Validation, Error Handling, Cryptography, Business Logic, Client-side &amp; API Testing.<br>
                <em style="color:#666;">120 questions drawn from a pool. Explanation shown after each answer.</em>
            </p>
            <button class="btn btn-p" onclick="initExam()" style="padding:16px 55px; font-size:1.25em; margin-top:10px;">Start Quiz</button>
        </div>
    </div>
</div>
<div class="header">
    <div class="header-title"><span>WSTG</span> v4.2 Quiz</div>
    <div id="progress-display" class="progress-text">0 / 120</div>
</div>
<div class="main" id="exam-ui" style="display:none;">
    <div class="sidebar" id="sidebar"></div>
    <div class="content" id="question-container"></div>
</div>
<div class="footer" id="footer" style="display:none;">
    <div><button class="btn btn-s" onclick="nav(-1)">Previous</button> <button class="btn btn-w" onclick="flag()" style="margin-left:10px;">Flag</button></div>
    <div id="status">Q 1 / 120</div>
    <div><button class="btn btn-g" id="finish-btn" onclick="finish()" style="display:none;">Finish Quiz</button></div>
</div>
<div id="results-screen" style="display:none;">
    <div class="center-wrapper" style="justify-content:flex-start; padding-top:50px;">
        <div style="background:var(--card); padding:40px; border-radius:12px; max-width:800px; width:100%; box-shadow:0 10px 40px rgba(0,0,0,0.3); text-align:center; border:1px solid var(--border);">
            <h1 style="margin:0; color:#fff; font-family:'JetBrains Mono',monospace;">Quiz Results</h1>
            <div id="score-circle" class="score-circle">0%</div>
            <div id="raw-score" style="font-size:1.2em; color:#aaa; margin-bottom:25px; font-family:'JetBrains Mono',monospace;"></div>
            <button class="btn btn-p" onclick="location.reload()">Take New Quiz</button>
        </div>
        <div id="review-list" style="width:100%; max-width:800px; margin-top:25px;"></div>
    </div>
</div>
<script>
const allQuestions = [
// --- 4.1 INFORMATION GATHERING (WSTG-INFO) — 12 questions ---
{c:"INFO — Information Gathering", q:"What is the WSTG identifier format for the second Information Gathering test scenario?", a:"WSTG-INFO-02, where INFO is the category and 02 is the test number.", d:["WSTG-CONF-02, where CONF is the category and 02 is the test number.", "WSTG-INPT-02, where INPT is the category and 02 is the test number.", "WSTG-SESS-02, where SESS is the category and 02 is the test number."], e:"WSTG identifiers follow the format WSTG-&lt;category&gt;-&lt;number&gt;. The Information Gathering category uses the INFO prefix, so the second test is WSTG-INFO-02."},
{c:"INFO — Information Gathering", q:"When performing search engine reconnaissance (WSTG-INFO-01), what technique chains search operators to find sensitive files?", a:"Google hacking or Dorking, combining operators to find specific information.", d:["DNS zone transfer enumeration, using dig queries to uncover hidden subdomains.", "Banner grabbing via netcat, using raw socket connections to fingerprint servers.", "Passive certificate transparency log analysis to discover internal host names."], e:"The WSTG describes Google hacking (Dorking) as combining search operators like site:, filetype:, and inurl: to discover sensitive files and information leakage."},
{c:"INFO — Information Gathering", q:"According to WSTG-INFO-01, which database is specifically mentioned for finding search operator discovery queries?", a:"The Google Hacking Database (GHDB), cataloguing dorks by multiple categories.", d:["The National Vulnerability Database (NVD), cataloguing CVEs by severity rating.", "The Exploit Database (EDB), cataloguing proof-of-concept exploit code samples.", "The Common Weakness Enumeration (CWE), cataloguing software weakness patterns."], e:"The WSTG explicitly mentions the Google Hacking Database as a useful resource containing categorised dorks for various types of information discovery."},
{c:"INFO — Information Gathering", q:"Which file should a tester review to understand what directories a site owner has attempted to exclude from crawlers?", a:"The robots.txt file, which contains Disallow directives for crawler exclusion.", d:["The sitemap.xml file, which contains URL priority values for search indexing.", "The .htaccess file, which contains directory-level access control configurations.", "The security.txt file, which contains vulnerability disclosure contact information."], e:"The WSTG describes robots.txt as a key metafile to review, as its Disallow directives may reveal sensitive directories the site owner wants hidden from crawlers."},
{c:"INFO — Information Gathering", q:"When fingerprinting a web server (WSTG-INFO-02), which HTTP header is the primary indicator of the server software?", a:"The Server response header, which typically identifies the software and version.", d:["The Content-Type response header, which identifies the MIME type of the body.", "The X-Frame-Options response header, which controls iframe embedding policies.", "The Cache-Control response header, which specifies caching behaviour directives."], e:"The Server HTTP response header (e.g., 'Apache/2.4.41' or 'nginx/1.18.0') is the primary indicator used when fingerprinting web server software."},
{c:"INFO — Information Gathering", q:"What does the WSTG recommend reviewing in HTML source code to find information leakage (WSTG-INFO-05)?", a:"HTML comments, JavaScript files, source maps, and any embedded metadata.", d:["Only the visible rendered text content displayed to standard end users.", "Exclusively the HTTP response headers returned alongside each page request.", "Just the URL parameters and query strings appended to the navigation links."], e:"WSTG-INFO-05 recommends checking HTML comments, JavaScript code, source map files, and metadata for leaked information like SQL queries, internal IPs, and credentials."},
{c:"INFO — Information Gathering", q:"Which search engine operators does the WSTG describe as commonly supported for performing reconnaissance?", a:"site:, inurl:, intitle:, intext:/inbody:, and filetype: search operators.", d:["WHOIS, nslookup, traceroute, ping, and reverse DNS lookup utility tools.", "nmap -sV, nmap -sS, nmap -O, nmap -A, and nmap --script based scans.", "sqlmap, nikto, dirb, gobuster, and wfuzz command-line scanning utilities."], e:"The WSTG explicitly lists site:, inurl:, intitle:, intext:/inbody:, and filetype: as commonly supported search operators for reconnaissance."},
{c:"INFO — Information Gathering", q:"What can reviewing metadata embedded in public files like images and documents reveal, according to the WSTG?", a:"Internal usernames, file system paths, software versions, and GPS location data.", d:["Only the generic file creation date and the standard application used to save.", "Just the pixel dimensions of image files and the total page count of documents.", "The server operating system kernel version and installed security patch status."], e:"The WSTG states file metadata (extracted with tools like ExifTool) may reveal internal usernames, file paths, software versions, device details, and physical locations."},
{c:"INFO — Information Gathering", q:"When mapping application architecture (WSTG-INFO-10), what components should a tester identify?", a:"Web servers, application servers, databases, load balancers, and network firewalls.", d:["Only the front-end JavaScript framework and its specific installed version number.", "Exclusively the SSL certificate authority chain and its trust hierarchy structure.", "Just the DNS registrar details and the domain name registration expiry dates."], e:"WSTG-INFO-10 covers mapping the full application architecture including web servers, app servers, databases, reverse proxies, load balancers, and WAFs."},
{c:"INFO — Information Gathering", q:"What approach does the WSTG recommend for identifying all application entry points (WSTG-INFO-06)?", a:"Enumerate all request parameters, headers, and body fields in each request.", d:["Only test the main login page and the primary search field for input handling.", "Rely exclusively on automated crawlers without any form of manual review.", "Restrict analysis to URL query string parameters visible in the browser bar."], e:"WSTG-INFO-06 recommends identifying all entry points by examining request parameters, HTTP headers, POST body content, and hidden form fields across all functions."},
{c:"INFO — Information Gathering", q:"Which privacy-focused search engines does the WSTG mention can reduce information leakage about the tester?", a:"DuckDuckGo and Startpage, which avoid using trackers or keeping search logs.", d:["Tor Browser and I2P Search, which route all traffic through onion relay nodes.", "Shodan and Censys, which scan internet-facing services and open network ports.", "VirusTotal and URLScan, which analyse submitted URLs for known malicious code."], e:"The WSTG specifically mentions DuckDuckGo and Startpage as search engines offering increased privacy by not utilising trackers or keeping logs."},
{c:"INFO — Information Gathering", q:"What file in the .well-known/ directory can provide testers with vulnerability disclosure policy information?", a:"The security.txt file, containing contact details and disclosure policy links.", d:["The robots.txt file, containing crawler directives and disallowed server paths.", "The humans.txt file, containing credits for the website development team only.", "The assetlinks.json file, containing Android application link verification data."], e:"The WSTG notes that security.txt (RFC 9116) may be in the .well-known/ directory and provides vulnerability disclosure contact and policy information."},

// --- 4.2 CONFIGURATION & DEPLOYMENT (WSTG-CONF) — 12 questions ---
{c:"CONF — Config & Deployment", q:"When testing HTTP methods (WSTG-CONF-06), which method discovers the HTTP verbs a server supports on a resource?", a:"The OPTIONS method, which returns allowed methods in the Allow response header.", d:["The TRACE method, which echoes back the complete received request for debugging.", "The PATCH method, which applies partial modifications to an existing server resource.", "The CONNECT method, which establishes a tunnel through an HTTP proxy connection."], e:"The WSTG describes using the OPTIONS HTTP method to discover supported methods. The server responds with an Allow header listing available verbs like GET, POST, PUT, DELETE."},
{c:"CONF — Config & Deployment", q:"What does the WSTG recommend testing regarding HTTP Strict Transport Security (WSTG-CONF-07)?", a:"Verify the Strict-Transport-Security header is present with correct max-age settings.", d:["Confirm that the server accepts both HTTP and HTTPS connections at the same time.", "Ensure the X-Content-Type-Options header is set to the nosniff directive value.", "Validate that the Cross-Origin-Resource-Policy permits all external domain access."], e:"WSTG-CONF-07 specifically covers testing for the presence and correct configuration of the Strict-Transport-Security header, including max-age, includeSubDomains, and preload."},
{c:"CONF — Config & Deployment", q:"What is the risk of leaving .bak, .old, or .copy files accessible on the web server (WSTG-CONF-04)?", a:"They may expose application source code, credentials, or configuration settings.", d:["They consume excessive disk space causing overall server performance degradation.", "They trigger browser compatibility issues and corrupt the client application cache.", "They only affect search engine rankings through the creation of duplicate content."], e:"WSTG-CONF-04 warns that backup files (.bak, .old, .copy, ~) can expose application source code, database credentials, and configuration data to attackers."},
{c:"CONF — Config & Deployment", q:"What should a tester look for when enumerating admin interfaces (WSTG-CONF-05)?", a:"Common admin paths, default management ports, and exposed administrative panels.", d:["Only publicly documented API endpoints listed in the official developer portal.", "Exclusively the main application login page and its password reset functionality.", "Just the HTTP response codes returned when accessing the application home page."], e:"WSTG-CONF-05 covers discovering administrative interfaces through common paths (/admin, /manager, /console), non-standard ports, and directory brute-forcing."},
{c:"CONF — Config & Deployment", q:"When testing for subdomain takeover (WSTG-CONF-10), what condition makes a subdomain vulnerable?", a:"A DNS record pointing to an external service that has since been deprovisioned.", d:["A subdomain configured with a valid A record pointing to an active running server.", "A subdomain protected by a wildcard TLS certificate issued by a trusted authority.", "A subdomain registered in the DNS zone file with a short time-to-live TTL value."], e:"WSTG-CONF-10 describes subdomain takeover when DNS records point to deprovisioned external services (e.g., S3, Azure, Heroku) that an attacker can then claim."},
{c:"CONF — Config & Deployment", q:"What should be tested regarding file extensions handling on the server (WSTG-CONF-03)?", a:"Whether the server processes or reveals source code for unexpected file extension types.", d:["Whether the browser correctly renders image files using the standard JPEG encoding.", "Whether the CDN compresses all JavaScript files using the gzip transfer algorithm.", "Whether email attachments are stripped by the server-side outbound mail gateway."], e:"WSTG-CONF-03 tests whether requesting files with altered extensions (e.g., .php.bak, .asp.old) causes the server to reveal source code rather than executing or denying it."},
{c:"CONF — Config & Deployment", q:"When testing cloud storage security (WSTG-CONF-11), what is the primary risk being assessed?", a:"Misconfigured bucket permissions allowing unauthorised public read or write access.", d:["The geographic region selected for data storage within the cloud service provider.", "The choice between solid-state and magnetic storage media for the storage bucket.", "The monthly billing costs associated with cloud data transfer and storage quotas."], e:"WSTG-CONF-11 focuses on testing cloud storage (S3, Azure Blobs, GCS) for misconfigured permissions that allow public listing, reading, or writing of objects."},
{c:"CONF — Config & Deployment", q:"What is a RIA cross-domain policy file and why should it be tested (WSTG-CONF-08)?", a:"A crossdomain.xml or clientaccesspolicy.xml file controlling cross-domain data access.", d:["A CORS preflight response header controlling JavaScript cross-origin fetch requests.", "A Content-Security-Policy header directive restricting inline script execution scope.", "A Subresource Integrity hash attribute verifying the checksums of external scripts."], e:"WSTG-CONF-08 covers testing crossdomain.xml (Flash/Silverlight) and clientaccesspolicy.xml files, which can grant overly permissive cross-domain access if misconfigured."},
{c:"CONF — Config & Deployment", q:"When testing network infrastructure (WSTG-CONF-01), what should a tester primarily assess?", a:"Known vulnerabilities in the server software and its current patch level status.", d:["Only the visual design and layout of the application public-facing web pages.", "Exclusively the programming language used to write the application back-end.", "Just the total number of registered users currently stored in the database."], e:"WSTG-CONF-01 involves testing for known vulnerabilities, default configurations, and missing patches in web servers, application servers, and related infrastructure."},
{c:"CONF — Config & Deployment", q:"What does the WSTG recommend verifying regarding file permissions on the server (WSTG-CONF-09)?", a:"Files and directories follow restrictive permissions based on the least privilege principle.", d:["All web-accessible files are set to world-readable and world-writable permissions.", "The web server process is granted root-level access to simplify file path handling.", "Identical permissions are configured on every file regardless of role or content."], e:"WSTG-CONF-09 tests that file and directory permissions follow least privilege, ensuring sensitive files are not world-readable and directories are not listable."},
{c:"CONF — Config & Deployment", q:"Which dangerous HTTP method could allow an attacker to upload arbitrary content to the server?", a:"The PUT method, which can write uploaded content to a specified URI on the server.", d:["The GET method, which retrieves a representation of the specified resource object.", "The HEAD method, which returns only response headers without any message body.", "The POST method, which submits standard form data to the application endpoint."], e:"The WSTG warns that the PUT method, if enabled without proper access controls, can allow attackers to upload files including web shells directly to the server."},
{c:"CONF — Config & Deployment", q:"What issue does the WSTG highlight regarding default error pages in platform configuration (WSTG-CONF-02)?", a:"Default error pages may reveal server software names, versions, and internal paths.", d:["Default error pages always return a standard HTTP 200 OK status to all clients.", "Default error pages are only visible when accessed from the server localhost only.", "Default error pages are automatically removed when the application gets deployed."], e:"WSTG-CONF-02 notes that default or verbose error pages can leak information about the platform, framework version, file paths, and database types."},

// --- 4.3 IDENTITY MANAGEMENT (WSTG-IDNT) — 8 questions ---
{c:"IDNT — Identity Management", q:"What does testing for account enumeration (WSTG-IDNT-04) attempt to determine?", a:"Whether the application reveals if a specific username or account actually exists.", d:["Whether the application enforces a minimum password character length requirement.", "Whether the application logs all successful user authentication events to a file.", "Whether the application encrypts database records using column-level key rotation."], e:"WSTG-IDNT-04 tests whether different error messages, response codes, or timing differences reveal whether a given username exists, enabling attackers to enumerate valid accounts."},
{c:"IDNT — Identity Management", q:"When testing role definitions (WSTG-IDNT-01), what is the tester trying to identify?", a:"All defined roles, their associated permissions, and their access control boundaries.", d:["Only the total number of user accounts currently registered in the application.", "Exclusively the password hashing algorithm used for storing user credentials.", "Just the names of the database tables that store the session token values."], e:"WSTG-IDNT-01 involves identifying all roles (admin, user, moderator, etc.), understanding what permissions each grants, and testing the boundaries between them."},
{c:"IDNT — Identity Management", q:"What should a tester verify about the user registration process (WSTG-IDNT-02)?", a:"Whether registration can be abused for identity spoofing or automated bulk creation.", d:["Whether the registration page uses a particular front-end CSS framework library.", "Whether the registration form contains exactly three fields and one submit button.", "Whether the registration page loads within two hundred milliseconds on average."], e:"WSTG-IDNT-02 tests the registration process for allowing duplicate identities, lack of CAPTCHA, insufficient email verification, and predictable user ID assignment."},
{c:"IDNT — Identity Management", q:"How might an application inadvertently reveal valid usernames during the login process?", a:"By returning different error messages for invalid usernames versus wrong passwords.", d:["By requiring all users to authenticate with a hardware security token at every login.", "By enforcing multi-factor authentication across all user accounts without exception.", "By using a content delivery network to serve the static login page to all regions."], e:"Messages like 'User not found' vs 'Invalid password' allow attackers to distinguish between non-existent and existing accounts, enabling enumeration."},
{c:"IDNT — Identity Management", q:"What does WSTG-IDNT-03 test regarding the account provisioning and deprovisioning process?", a:"Whether accounts can be provisioned or deprovisioned in an unauthorised manner.", d:["Whether the application backup schedule runs at the correct configured interval.", "Whether the database connection pool is sized appropriately for peak traffic loads.", "Whether the monitoring dashboard displays accurate real-time server CPU utilisation."], e:"WSTG-IDNT-03 examines whether attackers can create, modify, or delete accounts without proper authorisation, and whether deprovisioning properly revokes all access."},
{c:"IDNT — Identity Management", q:"Which technique does the WSTG describe for detecting account enumeration via timing differences?", a:"Measuring response times, since valid usernames may trigger slower password hash lookups.", d:["Counting the number of HTTP redirects returned when submitting randomly generated input.", "Comparing the TLS certificate expiry dates across different application login subdomains.", "Analysing the JavaScript bundle size differences between various error page responses."], e:"Timing-based enumeration occurs when the application performs password hashing only for valid accounts, causing measurably slower responses for existing usernames."},
{c:"IDNT — Identity Management", q:"What does testing for weak or unenforced username policy (WSTG-IDNT-05) assess?", a:"Whether the application enforces consistent format, uniqueness, and naming rules.", d:["Whether the application restricts the geographic location of all connecting user IPs.", "Whether the application rate-limits all outbound API calls to third-party endpoints.", "Whether the application validates image uploads using content-aware hashing alone."], e:"WSTG-IDNT-05 tests whether username policies enforce format rules (length, characters, case sensitivity) and prevent duplicates, misleading names, or username recycling."},
{c:"IDNT — Identity Management", q:"Why is account enumeration via the password reset function a security concern in the WSTG?", a:"Reset responses may confirm whether an account exists through different error messages.", d:["Reset tokens are always transmitted in plaintext over unencrypted HTTP connections.", "Reset functions invariably disable multi-factor authentication on every user account.", "Reset pages automatically lock out every account after only a single failed attempt."], e:"Password reset features often reveal account existence through messages like 'Email sent' vs 'Account not found', enabling enumeration via this alternate channel."},

// --- 4.4 AUTHENTICATION (WSTG-ATHN) — 12 questions ---
{c:"ATHN — Authentication", q:"What does WSTG-ATHN-01 test regarding the transmission of user credentials?", a:"Whether credentials are transmitted over an encrypted channel such as TLS/HTTPS.", d:["Whether the database stores credentials in a flat CSV text file on the server.", "Whether the login page background colour meets WCAG accessibility contrast ratios.", "Whether credentials are rotated automatically on a strict twenty-four hour schedule."], e:"WSTG-ATHN-01 tests that authentication credentials (username, password, tokens) are always transmitted over encrypted channels (TLS/HTTPS) and never sent in cleartext."},
{c:"ATHN — Authentication", q:"When testing for default credentials (WSTG-ATHN-02), what should a tester attempt first?", a:"Logging in with vendor-supplied default username and password combinations.", d:["Resetting the server firmware to factory defaults using the recovery boot console.", "Updating all third-party dependencies to their latest available stable release version.", "Scanning the application JavaScript source code for any hard-coded API endpoint URLs."], e:"WSTG-ATHN-02 involves testing whether default credentials (admin/admin, admin/password, etc.) for the application, frameworks, or infrastructure still work."},
{c:"ATHN — Authentication", q:"What weakness does WSTG-ATHN-03 assess in the application's account lockout mechanism?", a:"Whether brute force attacks succeed due to missing or overly lenient lockout policies.", d:["Whether locked accounts can still receive inbound email notifications from the system.", "Whether the lockout banner uses the correct brand colours specified in the style guide.", "Whether the account lockout event is displayed on the public-facing status dashboard."], e:"WSTG-ATHN-03 tests lockout mechanisms for weaknesses: no lockout at all, thresholds too high, lockouts that reset too quickly, or bypasses via alternate channels."},
{c:"ATHN — Authentication", q:"How can an attacker bypass the authentication schema according to WSTG-ATHN-04?", a:"By directly requesting protected resources or by modifying authentication parameters.", d:["By submitting a valid CAPTCHA solution on the publicly accessible login form only.", "By using the standard password reset flow with a legitimate registered email address.", "By authenticating normally and then navigating to the application home screen page."], e:"WSTG-ATHN-04 covers bypassing authentication by direct page requests, parameter modification, session ID prediction, SQL injection in login forms, and forced browsing."},
{c:"ATHN — Authentication", q:"What does testing for vulnerable 'remember password' functionality assess (WSTG-ATHN-05)?", a:"Whether stored credentials are properly protected and the remember-me token is secure.", d:["Whether the password field uses a monospaced font for improved character readability.", "Whether the browser built-in password manager popup is visually customised to match.", "Whether the remember-me checkbox is left-aligned with the submit button positioned below."], e:"WSTG-ATHN-05 tests whether 'remember me' stores credentials insecurely (e.g., in cleartext cookies) or uses predictable tokens that can be forged."},
{c:"ATHN — Authentication", q:"What browser cache weakness does WSTG-ATHN-06 specifically test for?", a:"Whether sensitive authentication data is stored in the browser cache or page history.", d:["Whether the browser renders CSS animations smoothly with hardware GPU acceleration.", "Whether the browser supports WebSocket connections for bidirectional data streaming.", "Whether the browser correctly validates extended validation TLS certificate chains."], e:"WSTG-ATHN-06 tests whether the application uses Cache-Control, Pragma, and Expires headers to prevent browsers caching sensitive pages containing authentication data."},
{c:"ATHN — Authentication", q:"When testing for weak password policy (WSTG-ATHN-07), what characteristics should be evaluated?", a:"Minimum length, complexity requirements, dictionary checks, and password history rules.", d:["Only the maximum number of characters permitted in the password input field control.", "Exclusively whether the password is hashed with the SHA-256 cryptographic digest.", "Just the colour of the password strength indicator bar displayed on the screen."], e:"WSTG-ATHN-07 assesses password policies for minimum length, complexity, dictionary word rejection, password history, and maximum age requirements."},
{c:"ATHN — Authentication", q:"What makes a security question 'weak' according to WSTG-ATHN-08?", a:"Answers that are easily guessed, publicly available, or identical for many users.", d:["Questions that are presented using a serif typeface instead of a sans-serif font.", "Questions that are displayed below the password field instead of positioned above.", "Questions that require the user to type more than twenty characters to fully answer."], e:"WSTG-ATHN-08 assesses security questions for answers being publicly discoverable, having limited answer sets, or being the same for many users."},
{c:"ATHN — Authentication", q:"What should be tested in password change and reset functionalities (WSTG-ATHN-09)?", a:"Whether the reset token is cryptographically random, time-limited, and single-use.", d:["Whether the password change form is styled consistently with the main page theme.", "Whether the reset email includes the company logo image in the email header area.", "Whether the password change page loads within a sub-second server response time."], e:"WSTG-ATHN-09 tests reset tokens for predictability, expiration, single-use enforcement, and whether the old password is required for authenticated password changes."},
{c:"ATHN — Authentication", q:"What does WSTG-ATHN-10 test regarding alternative authentication channels?", a:"Whether mobile apps, APIs, or partner portals use less rigorous authentication checks.", d:["Whether the desktop browser version of the site loads faster than the mobile edition.", "Whether the application CDN caches authenticated pages at edge server locations.", "Whether alternative DNS resolvers return different IP addresses for the domain name."], e:"WSTG-ATHN-10 checks whether alternative channels (mobile apps, call centres, partner APIs) have weaker authentication than the primary web application."},
{c:"ATHN — Authentication", q:"A tester sends a login request directly to the backend API without a session token and receives authenticated data. Which test is relevant?", a:"WSTG-ATHN-04, testing for bypassing the authentication schema in the application.", d:["WSTG-ATHN-01, testing for credentials transported over an encrypted HTTPS channel.", "WSTG-ATHN-07, testing for weak password policy enforcement across user accounts.", "WSTG-ATHN-02, testing for default credentials on the application or its framework."], e:"Directly accessing protected resources without proper authentication tokens is a classic authentication bypass, covered by WSTG-ATHN-04."},
{c:"ATHN — Authentication", q:"Why does the WSTG recommend testing whether the current password is required before allowing a change?", a:"Without it, an attacker with a hijacked session can permanently change the password.", d:["Without it, the application cannot display the current password in plain text form.", "Without it, the password hash algorithm cannot be upgraded during the change flow.", "Without it, the browser password manager will not offer to save the new credentials."], e:"WSTG-ATHN-09 notes that requiring the current password during changes prevents session hijackers from permanently taking over accounts."},

// --- 4.5 AUTHORIZATION (WSTG-ATHZ) — 8 questions ---
{c:"ATHZ — Authorization", q:"What is the objective of testing for directory traversal (WSTG-ATHZ-01)?", a:"Determine if the application allows accessing files outside the intended directory path.", d:["Determine if the application correctly renders directory listing index pages for users.", "Determine if the application supports WebDAV protocol for remote document management.", "Determine if the application logs all directory access events to the system audit log."], e:"WSTG-ATHZ-01 tests whether path traversal sequences (like ../ or ..\\) allow attackers to read files outside the web root, such as /etc/passwd or configuration files."},
{c:"ATHZ — Authorization", q:"When testing for authorization bypass (WSTG-ATHZ-02), what technique accesses another user's data by modifying an identifier?", a:"Horizontal privilege escalation, achieved by changing a resource ID like a user ID.", d:["Brute-forcing the login form by submitting a dictionary of common password values.", "Injecting SQL syntax into the search field to extract records from the database.", "Performing a denial of service by flooding the server with many concurrent requests."], e:"WSTG-ATHZ-02 includes testing horizontal access control by modifying parameters (e.g., changing user_id=123 to user_id=124) to access another user's data."},
{c:"ATHZ — Authorization", q:"What does testing for privilege escalation (WSTG-ATHZ-03) verify?", a:"Whether a lower-privileged user can gain access to higher-privileged admin functions.", d:["Whether administrator accounts can successfully log in during peak server usage hours.", "Whether the database server rejects all connections from unauthorised IP address ranges.", "Whether the application firewall blocks all requests exceeding the maximum body size."], e:"WSTG-ATHZ-03 tests vertical privilege escalation by attempting to access admin functions or elevated capabilities from a standard user account."},
{c:"ATHZ — Authorization", q:"Which common payload tests for directory traversal vulnerabilities on Unix-based systems?", a:"The sequence ../../etc/passwd to attempt reading the system's local password file.", d:["The string &lt;script&gt;alert(1)&lt;/script&gt; to trigger a cross-site scripting popup.", "The query ' OR 1=1 -- to manipulate the back-end SQL query logic and condition.", "The command ; cat /etc/shadow to chain an operating system command injection."], e:"The classic directory traversal test payload ../../etc/passwd attempts to escape the web root and read the Unix password file, confirming the vulnerability."},
{c:"ATHZ — Authorization", q:"What does WSTG-ATHZ-04 test regarding insecure direct object references?", a:"Whether users can access objects by manipulating identifiers without any authorisation.", d:["Whether the application uses a relational database management system on the backend.", "Whether file upload functions validate the MIME type of all submitted file attachments.", "Whether the logging framework captures the client IP address in each audit log record."], e:"WSTG-ATHZ-04 tests IDOR by manipulating object references (file names, record IDs, keys) in requests to determine if the application enforces access control."},
{c:"ATHZ — Authorization", q:"A tester changes 'role=user' to 'role=admin' in a request parameter and gains admin access. Which test succeeded?", a:"Privilege escalation (WSTG-ATHZ-03), achieving a vertical access control bypass.", d:["Session fixation (WSTG-SESS-03), forcing a pre-set session cookie on the target.", "SQL injection (WSTG-INPT-05), manipulating database queries through user input.", "Clickjacking (WSTG-CLNT-09), overlaying a transparent iframe on the visible page."], e:"Modifying a role parameter to elevate from user to admin is a vertical privilege escalation attack, directly covered by WSTG-ATHZ-03."},
{c:"ATHZ — Authorization", q:"What encoding bypass techniques should testers try when directory traversal payloads are blocked?", a:"URL encoding (%2e%2e%2f), double encoding, and Unicode character representations.", d:["Base64-encoding the entire HTTP request body including all header field key values.", "Compressing the payload with gzip and then sending it as a binary POST attachment.", "Encrypting the traversal string with AES-256 before including it in the URL query."], e:"The WSTG recommends trying URL encoding, double encoding (%252e%252e%252f), and Unicode representations to bypass filters blocking directory traversal."},
{c:"ATHZ — Authorization", q:"Why is it important to test authorisation with multiple user roles according to the WSTG?", a:"Each role may have different access control gaps only visible at that privilege level.", d:["All user roles always share exactly the same session management implementation code.", "Only the administrator role is ever capable of triggering any input validation weakness.", "Authorisation testing only needs a single account because all roles behave identically."], e:"The WSTG recommends testing with multiple roles because access control flaws often only manifest when testing transitions between privilege levels."},

// --- 4.6 SESSION MANAGEMENT (WSTG-SESS) — 12 questions ---
{c:"SESS — Session Management", q:"What are the three main steps in a cookie-based session attack pattern according to the WSTG?", a:"Cookie collection, cookie reverse engineering, then cookie manipulation and forging.", d:["Cookie deletion, cookie regeneration, then cookie validation on the client browser.", "Cookie encryption, cookie transmission, then cookie storage in a server-side database.", "Cookie creation, cookie compression, then cookie archival for regulatory compliance."], e:"WSTG-SESS-01 describes the attack pattern as: (1) cookie collection, (2) cookie reverse engineering — analysing the algorithm, and (3) cookie manipulation — forging valid cookies."},
{c:"SESS — Session Management", q:"What is session fixation, as described by the WSTG (WSTG-SESS-03)?", a:"An attack where the session ID is not renewed after login, letting an attacker reuse it.", d:["An attack where the session cookie is encrypted using a weak symmetric cipher suite.", "An attack where the session timeout is extended by modifying client cookie expiry dates.", "An attack where multiple sessions are created simultaneously to exhaust server memory."], e:"Session fixation occurs when the application preserves the same session cookie before and after login, allowing an attacker who obtained a pre-auth session ID to hijack the post-auth session."},
{c:"SESS — Session Management", q:"What is the primary remediation for session fixation described in the WSTG?", a:"Invalidate the existing session ID and issue a completely new one after authentication.", d:["Increase the entropy of the session identifier from 64-bit to 128-bit random values.", "Store the session identifier in a URL query string parameter instead of in a cookie.", "Add the user IP address to the session record and validate it on every single request."], e:"The application should always first invalidate the existing session ID before authenticating a user, and if authentication succeeds, provide a new session ID."},
{c:"SESS — Session Management", q:"When testing cookie attributes (WSTG-SESS-02), which attribute prevents JavaScript from accessing the cookie?", a:"The HttpOnly attribute, which blocks client-side script access to the cookie value.", d:["The Secure attribute, which restricts cookie transmission to encrypted HTTPS only.", "The SameSite attribute, which controls cross-origin request cookie attachment rules.", "The Path attribute, which limits cookie transmission to a specific URL path scope."], e:"The HttpOnly cookie attribute prevents client-side JavaScript (document.cookie) from reading the cookie, mitigating session theft via XSS attacks."},
{c:"SESS — Session Management", q:"What does the WSTG say about using POST requests alone as a defence against CSRF attacks?", a:"POST alone is insufficient because POST requests can be automated via JavaScript code.", d:["POST provides complete protection since browsers block all automated cross-origin POSTs.", "POST data cannot be submitted from external HTML pages under any known circumstances.", "POST is the recommended standalone CSRF defence mechanism described in the OWASP guide."], e:"The WSTG states that 'the use of POST alone is not enough to correct the occurrence of CSRF vulnerabilities' since POST requests can be automated with JavaScript."},
{c:"SESS — Session Management", q:"According to the WSTG, what condition must be met for a CSRF attack to be successful?", a:"Session management must rely only on client-side values such as cookies or HTTP auth.", d:["The target application must be running on an unpatched version of the Apache Struts.", "The victim must be using a browser with JavaScript completely disabled in settings.", "The attacker must have physical access to the victim's device to install a key logger."], e:"The WSTG states that if session management relies only on client-side values (cookies, HTTP auth credentials), the application is vulnerable to CSRF."},
{c:"SESS — Session Management", q:"What does the WSTG recommend testing regarding session timeout functionality (WSTG-SESS-07)?", a:"That idle sessions are invalidated server-side after an appropriate inactivity period.", d:["That sessions remain active permanently until the user explicitly clicks logout button.", "That session timeouts are only enforced by cookie expiry dates set in the user browser.", "That all sessions across every application feature share the same 24-hour timeout value."], e:"WSTG-SESS-07 tests that session timeouts are enforced server-side, are appropriate for data sensitivity, and that session data is properly destroyed."},
{c:"SESS — Session Management", q:"When testing logout functionality (WSTG-SESS-06), what must a tester verify?", a:"That the session token is properly invalidated server-side and cannot be replayed.", d:["That the logout button is displayed in a red colour to indicate a destructive action.", "That the logout page includes an animated transition before redirecting to the home.", "That the logout event is announced by an audible browser notification sound to users."], e:"WSTG-SESS-06 tests that logout properly destroys the server-side session, invalidates tokens, clears cookies, and that old session IDs cannot be replayed."},
{c:"SESS — Session Management", q:"What is session puzzling or session variable overloading (WSTG-SESS-08)?", a:"Exploiting shared session variables used for different purposes to bypass security logic.", d:["Encrypting session identifiers with a puzzle-based cryptographic proof-of-work scheme.", "Splitting a single session token across multiple cookies for fault tolerance purposes.", "Generating session IDs using a cryptographic hash of the user's public key material."], e:"Session puzzling occurs when an application uses the same session variable for different purposes, allowing attackers to manipulate one context to affect another."},
{c:"SESS — Session Management", q:"What role does the Secure cookie attribute play in preventing session hijacking?", a:"It ensures the cookie is only sent over HTTPS, preventing interception on plain HTTP.", d:["It encrypts the cookie value using AES before the browser stores it in the cookie jar.", "It adds a digital signature to the cookie to prevent any tampering on the server side.", "It restricts the cookie to first-party contexts, blocking all third-party domain access."], e:"The Secure attribute ensures session cookies are only transmitted over encrypted HTTPS connections, preventing network attackers from intercepting them via HTTP."},
{c:"SESS — Session Management", q:"A user leaves a public computer without logging out and another person accesses their session. Which weakness does this exploit?", a:"Insufficient session timeout combined with missing server-side logout invalidation.", d:["Weak session ID entropy that allows brute-force prediction of active token values.", "Cross-site scripting that enables remote extraction of session cookies via script.", "HTTP response splitting that enables injection of additional Set-Cookie header lines."], e:"The WSTG uses this public computer scenario to illustrate the importance of both proper idle session timeouts and server-side session invalidation on logout."},
{c:"SESS — Session Management", q:"Why does the WSTG recommend full HSTS adoption with includeSubDomains for session cookie integrity?", a:"Without includeSubDomains, HTTP requests to subdomains can leak session cookies.", d:["Without includeSubDomains, the server cannot issue valid TLS certificates at all.", "Without includeSubDomains, browsers refuse to cache any resources from the domain.", "Without includeSubDomains, Content-Security-Policy header becomes totally ineffective."], e:"Partial HSTS (without includeSubDomains) allows attackers to force HTTP requests to subdomains, potentially leaking session cookies set with the Domain attribute."},

// --- 4.7 INPUT VALIDATION (WSTG-INPT) — 18 questions ---
{c:"INPT — Input Validation", q:"What is reflected cross-site scripting as described by the WSTG (WSTG-INPT-01)?", a:"An attack where injected script is returned in the server's immediate HTTP response.", d:["An attack where malicious script is permanently stored in the application database.", "An attack where the DOM is manipulated entirely client-side without server contact.", "An attack where script is injected into a log file and executed by an admin viewer."], e:"Reflected XSS occurs when user input is immediately included in the HTTP response without proper sanitisation, executing in the victim's browser via a crafted link."},
{c:"INPT — Input Validation", q:"What makes stored XSS (WSTG-INPT-02) more dangerous than reflected XSS, according to the WSTG?", a:"The malicious payload persists in the data store and triggers for every visiting user.", d:["The payload only executes once for a single user who clicks on a specific link.", "The payload requires the attacker to maintain a live server hosting the exploit code.", "The payload is blocked by all modern browsers through their built-in XSS auditors."], e:"The WSTG states stored XSS is the most dangerous type because the malicious input is saved and served to all users who view the affected page."},
{c:"INPT — Input Validation", q:"What three black-box testing phases does the WSTG describe for reflected XSS testing?", a:"Detect input vectors, analyse each vector for vulnerabilities, and assess exploitability.", d:["Run an automated scanner, review the scanner report, and file all found vulnerabilities.", "Check the source code, compile the entire application, and deploy it to a test server.", "Interview the developers, review the design documents, and approve the risk register."], e:"The WSTG describes three phases: (1) detect input vectors, (2) analyse each with crafted input, and (3) assess whether results have realistic security impact."},
{c:"INPT — Input Validation", q:"When testing for SQL injection (WSTG-INPT-05), what is the initial purpose of submitting a single quote?", a:"To check whether input breaks the SQL query syntax and causes an error response.", d:["To validate that the database server uses Unicode UTF-8 character set encoding.", "To verify that the application correctly escapes quotation marks for display only.", "To confirm that the web application firewall blocks all special character inputs."], e:"A single quote (') is a classic SQL injection probe — if it causes a database error or changes application behaviour, it indicates input is being incorporated into SQL queries unsafely."},
{c:"INPT — Input Validation", q:"What does the WSTG describe as HTTP parameter pollution (WSTG-INPT-04)?", a:"Submitting multiple parameters with the same name to trigger unexpected server handling.", d:["Encrypting all HTTP parameters using TLS before they are transmitted to the server.", "Removing all query string parameters from the URL to test the default page rendering.", "Compressing HTTP parameter values with gzip to reduce the overall request payload."], e:"WSTG-INPT-04 describes HPP as supplying duplicate parameters (e.g., id=1&id=2), which different server technologies handle differently, potentially bypassing validation."},
{c:"INPT — Input Validation", q:"When testing for LDAP injection (WSTG-INPT-06), what characters should a tester inject?", a:"Special LDAP metacharacters such as parentheses, asterisks, and logical operators.", d:["Only standard alphanumeric ASCII characters and the most common punctuation marks.", "Exclusively binary data encoded as hexadecimal escape sequences in the URL string.", "Just HTML entity references such as &amp;amp; and &amp;lt; in the form field input."], e:"WSTG-INPT-06 involves injecting LDAP metacharacters like (, ), *, |, and & to manipulate LDAP queries and potentially bypass authentication or extract data."},
{c:"INPT — Input Validation", q:"What is Server-Side Template Injection as described by the WSTG (WSTG-INPT-18)?", a:"Injecting template engine syntax that is executed server-side to achieve code execution.", d:["Modifying the HTML template rendered by the client browser's JavaScript engine only.", "Replacing the email notification template stored in the application admin settings page.", "Uploading a custom CSS template file that overrides the application's default theme."], e:"WSTG-INPT-18 describes SSTI as injecting template syntax (e.g., {{7*7}}) that is processed by a server-side template engine, potentially leading to remote code execution."},
{c:"INPT — Input Validation", q:"What initial payload can confirm the presence of an SSTI vulnerability in a Jinja2 template engine?", a:"The expression {{7*7}}, which renders as the value '49' if the engine evaluates it.", d:["The string &lt;script&gt;alert(7)&lt;/script&gt;, which triggers a JavaScript popup.", "The sequence ../../etc/passwd, which reads the server's local user account password file.", "The command ; whoami, which directly executes an operating system shell command."], e:"Submitting {{7*7}} and receiving '49' confirms the Jinja2 template engine is evaluating user input, indicating an SSTI vulnerability."},
{c:"INPT — Input Validation", q:"What does testing for command injection (WSTG-INPT-12) aim to identify?", a:"Whether user input is passed to operating system shell commands without sanitisation.", d:["Whether the application administrator can execute scheduled database migration scripts.", "Whether the server cron job scheduler processes all background tasks at correct times.", "Whether container orchestration commands are logged by the CI/CD deployment pipeline."], e:"WSTG-INPT-12 tests whether the application passes user input to OS commands (via system(), exec(), etc.) without sanitisation, enabling arbitrary command execution."},
{c:"INPT — Input Validation", q:"Which characters are common OS command injection separators that testers should try?", a:"The semicolon (;) and pipe (|) characters to chain additional shell commands.", d:["The equals sign (=) to assign a new value to an operating system environment variable.", "The forward slash (/) to specify an absolute filesystem path on the server disk.", "The at symbol (@) to reference an email address within a web form input field."], e:"Command injection typically uses shell metacharacters like ; (separator), | (pipe), && (AND), || (OR), or backticks to chain malicious commands after legitimate input."},
{c:"INPT — Input Validation", q:"What is HTTP verb tampering as described by the WSTG (WSTG-INPT-03)?", a:"Sending requests with unexpected HTTP methods to bypass access controls or WAF rules.", d:["Changing the HTTP version from 1.1 to 2.0 in a request to improve load performance.", "Modifying the Accept-Language header to request web content in a different locale.", "Altering the User-Agent string to impersonate a different browser or a web crawler."], e:"WSTG-INPT-03 describes using unexpected methods (e.g., HEAD instead of GET, or arbitrary verbs) to bypass security controls that only check specific methods."},
{c:"INPT — Input Validation", q:"What does the WSTG say about testing for Server-Side Request Forgery (WSTG-INPT-19)?", a:"Test whether the application can be coerced to send requests to internal or unintended hosts.", d:["Test whether the client browser can be tricked into sending cookies to a third party site.", "Test whether the DNS server resolves internal hostnames to their external public addresses.", "Test whether outbound email messages are correctly routed through the SMTP relay gateway."], e:"WSTG-INPT-19 tests whether attackers can manipulate server-side requests to target internal services, cloud metadata endpoints, or other unintended destinations."},
{c:"INPT — Input Validation", q:"What does the WSTG describe as an incubated vulnerability (WSTG-INPT-14)?", a:"A stored payload that is triggered later when a different user or process retrieves it.", d:["A vulnerability discovered during the design phase before any application code exists.", "A weakness that only manifests on servers running for more than thirty consecutive days.", "A flaw that requires the attacker to wait for a scheduled maintenance window to exploit."], e:"WSTG-INPT-14 describes incubated vulnerabilities where malicious input is planted and triggered later when another user or system component processes it."},
{c:"INPT — Input Validation", q:"When testing for XML injection (WSTG-INPT-07), what attack can lead to local file disclosure or denial of service?", a:"XML External Entity (XXE) injection, which processes dangerous external entity references.", d:["XML Schema Definition manipulation, which only changes the document validation rules.", "XSLT transformation injection, which exclusively alters the visual output presentation.", "XML namespace collision, which causes parsing errors in the document type header only."], e:"XXE allows external entity references that can read local files (e.g., file:///etc/passwd), perform SSRF, or cause DoS via entity expansion (billion laughs attack)."},
{c:"INPT — Input Validation", q:"What does the WSTG recommend as the primary defence against cross-site scripting attacks?", a:"Proper input validation combined with context-aware output encoding for all user data.", d:["Relying exclusively on a deny-list filter that strips the word 'script' from all input.", "Disabling JavaScript entirely in the web application for all authenticated user sessions.", "Implementing a client-side-only sanitisation library without any server-side validation."], e:"The WSTG recommends input validation and context-specific output encoding (HTML, JS, URL, CSS) as the primary defence, noting that deny-lists alone are insufficient."},
{c:"INPT — Input Validation", q:"What does the WSTG describe as HTTP request smuggling (WSTG-INPT-15)?", a:"Exploiting discrepancies in how front-end and back-end servers parse HTTP boundaries.", d:["Encrypting HTTP request payloads to bypass deep packet inspection by the firewall.", "Sending HTTP requests over a non-standard port to avoid network monitoring systems.", "Compressing the HTTP request body to exploit a decompression bomb vulnerability."], e:"WSTG-INPT-15 covers HTTP smuggling where differences in Content-Length and Transfer-Encoding handling between proxies and back-end servers allow request boundary manipulation."},
{c:"INPT — Input Validation", q:"What does testing for host header injection (WSTG-INPT-17) attempt to exploit?", a:"Application trust in the Host header for URL generation, routing, or access decisions.", d:["The client browser's local DNS cache to redirect the user to a phishing domain name.", "The server's CPU scheduling algorithm to cause a targeted denial of service condition.", "The load balancer health check endpoint to forcibly remove a node from the pool."], e:"WSTG-INPT-17 tests whether manipulating the Host header can poison password reset links, bypass virtual host access controls, or enable web cache poisoning."},
{c:"INPT — Input Validation", q:"What is the key difference between NoSQL injection and traditional SQL injection, according to the WSTG?", a:"NoSQL injection targets query operators and JSON/BSON structures instead of SQL syntax.", d:["NoSQL injection only affects applications that use the MongoDB database exclusively.", "NoSQL injection is impossible to exploit because NoSQL databases have no query language.", "NoSQL injection requires physical access to the database server filesystem to execute."], e:"WSTG-INPT-05.6 describes NoSQL injection as targeting the specific query syntax of NoSQL databases (e.g., MongoDB's $gt, $ne operators) rather than traditional SQL."},

// --- 4.8 ERROR HANDLING (WSTG-ERRH) — 6 questions ---
{c:"ERRH — Error Handling", q:"What does the WSTG test regarding improper error handling (WSTG-ERRH-01)?", a:"Whether error messages reveal internal details like stack traces, paths, or SQL code.", d:["Whether error pages use the correct corporate branding colours and logo placement.", "Whether the application returns HTTP 200 status codes for all error conditions.", "Whether error messages are translated into all officially supported user languages."], e:"WSTG-ERRH-01 tests whether the application discloses sensitive information through error messages, including technology details, paths, database structure, and code snippets."},
{c:"ERRH — Error Handling", q:"When testing for stack traces (WSTG-ERRH-02), what type of information is typically leaked?", a:"Framework versions, code file paths, line numbers, and database connection details.", d:["Only the HTTP status code number and its standard corresponding reason phrase text.", "Exclusively the client browser type and the operating system version currently in use.", "Just the current server date and time formatted in the Coordinated Universal Time zone."], e:"Stack traces can expose framework names and versions, absolute file paths, line numbers, function names, database connection strings, and internal class structures."},
{c:"ERRH — Error Handling", q:"What method does the WSTG recommend for triggering error responses during testing?", a:"Submit unexpected input like special characters, oversized data, and invalid formats.", d:["Only access the application's dedicated /error test endpoint documented in the API.", "Restart the web server process and observe the default startup page that appears.", "Switch the browser to offline mode and then capture the browser-generated error page."], e:"The WSTG recommends probing with malformed input, unexpected types, empty values, special characters, and boundary values to trigger error conditions."},
{c:"ERRH — Error Handling", q:"Why is information leakage through error messages a security concern, according to the WSTG?", a:"Leaked details help attackers map the technology stack and craft more targeted exploits.", d:["Error messages increase the application's overall page load time for all end users.", "Error messages cause the browser to consume excessive amounts of client-side memory.", "Error messages trigger antivirus software alerts on the user's local workstation."], e:"Detailed error information helps attackers understand the technology stack, database type, file structure, and logic, enabling more targeted and effective attacks."},
{c:"ERRH — Error Handling", q:"What does the WSTG recommend as the primary remediation for improper error handling?", a:"Use custom error pages with generic messages while logging full details server-side.", d:["Disable all error handling so exceptions propagate directly to the user browser.", "Configure the application to return an empty 204 No Content response for all errors.", "Show the full stack trace to users connecting from the corporate VPN network only."], e:"The WSTG recommends implementing custom error handlers that show generic messages while logging detailed error information securely on the server."},
{c:"ERRH — Error Handling", q:"A crafted SQL query in a form field returns a detailed database error with the table name and query structure. Which tests are relevant?", a:"Both WSTG-ERRH-01 (improper error handling) and WSTG-INPT-05 (SQL injection).", d:["Only WSTG-CONF-02 (platform configuration) and no additional test category applies.", "Only WSTG-ATHN-07 (weak password policy) because the form is the login page only.", "Only WSTG-SESS-01 (session management schema) since database errors affect sessions."], e:"This scenario demonstrates both SQL injection (input reaches the database) and improper error handling (the database error is shown to the user), making both tests relevant."},

// --- 4.9 CRYPTOGRAPHY (WSTG-CRYP) — 8 questions ---
{c:"CRYP — Cryptography", q:"What does WSTG-CRYP-01 test regarding transport layer security?", a:"Whether TLS is properly configured with strong protocols, ciphers, and valid certificates.", d:["Whether the application uses symmetric encryption for all database column-level values.", "Whether file uploads are encrypted at rest using the server hardware security module.", "Whether API keys are rotated on a monthly schedule defined in the operations runbook."], e:"WSTG-CRYP-01 tests TLS configuration including protocol versions (TLS 1.2+), cipher suites, certificate validity, key length, and whether weak settings are present."},
{c:"CRYP — Cryptography", q:"What is a padding oracle attack as described by the WSTG (WSTG-CRYP-02)?", a:"An attack exploiting decryption error responses to progressively recover plaintext data.", d:["An attack guessing encryption keys by measuring the CPU power consumption patterns.", "An attack replacing padding bytes in a compressed archive file with malicious content.", "An attack adding extra padding to network packets to cause a buffer overflow condition."], e:"Padding oracle attacks exploit different error responses for valid vs. invalid padding during CBC decryption, allowing an attacker to decrypt ciphertext without the key."},
{c:"CRYP — Cryptography", q:"What specific scenario does WSTG-CRYP-03 test for in web applications?", a:"Whether sensitive information such as credentials or tokens travels over unencrypted HTTP.", d:["Whether the application uses RSA-4096 keys for all internal service-to-service API calls.", "Whether database backup archives are encrypted using the AES-256-GCM cipher algorithm.", "Whether the application generates random numbers using a hardware-only entropy source."], e:"WSTG-CRYP-03 tests whether sensitive data (credentials, personal information, tokens) is transmitted over unencrypted HTTP, exposing it to network interception."},
{c:"CRYP — Cryptography", q:"When testing for weak encryption (WSTG-CRYP-04), what should a tester look for?", a:"Use of deprecated algorithms like DES, RC4, or MD5 for protecting sensitive data.", d:["Use of AES-256-GCM which is the current recommended authenticated encryption mode.", "Use of RSA with a 4096-bit key length which exceeds the minimum security standard.", "Use of TLS 1.3 with AEAD cipher suites which provides the strongest TLS security."], e:"WSTG-CRYP-04 tests for weak or deprecated algorithms like DES, 3DES, RC4, MD5, and SHA-1, which have known vulnerabilities."},
{c:"CRYP — Cryptography", q:"According to the WSTG, why should TLS 1.0 and TLS 1.1 be disabled on web servers?", a:"They have known vulnerabilities like BEAST and POODLE and are formally deprecated.", d:["They cause the web server to consume significantly more CPU during TLS handshakes.", "They are incompatible with the HTTP/2 framing protocol and therefore block performance.", "They require larger TLS certificates which increase page load bandwidth consumption."], e:"TLS 1.0 and 1.1 are vulnerable to attacks (BEAST, POODLE, Lucky13) and have been formally deprecated by RFC 8996."},
{c:"CRYP — Cryptography", q:"What type of tool does the WSTG suggest for comprehensively testing TLS configurations?", a:"Dedicated tools like testssl.sh or SSLyze that enumerate protocols and cipher suites.", d:["The browser's built-in developer tools network tab which shows basic connection info.", "The ping command-line utility which verifies basic network reachability to the server.", "The traceroute tool which maps the network path between the client and the server."], e:"The WSTG recommends tools such as testssl.sh, SSLyze, and ssllabs.com that comprehensively enumerate protocols, ciphers, certificates, and known vulnerabilities."},
{c:"CRYP — Cryptography", q:"What specific TLS issue involves a server accepting renegotiation requests initiated by clients?", a:"Client-initiated renegotiation, which can be exploited for denial of service attacks.", d:["Server Name Indication (SNI), which allows virtual hosting multiple sites on one IP.", "OCSP stapling, which lets the server cache certificate revocation status check results.", "Session resumption, which reduces overhead of repeated full TLS handshake processes."], e:"Client-initiated TLS renegotiation is a potential DoS vector since renegotiation is computationally expensive for the server and cheap for the attacker."},
{c:"CRYP — Cryptography", q:"When reviewing TLS configuration, what is the significance of testing for forward secrecy support?", a:"It ensures past sessions cannot be decrypted if the private key is compromised later.", d:["It ensures all future sessions will reuse the same encryption key for consistency.", "It ensures the TLS certificate is automatically renewed before its expiry date arrives.", "It ensures client browsers cache the encryption keys locally for faster reconnections."], e:"Forward secrecy (ECDHE/DHE) means each session uses unique ephemeral keys, so compromising the server's long-term key cannot decrypt previously captured traffic."},

// --- 4.10 BUSINESS LOGIC (WSTG-BUSL) — 10 questions ---
{c:"BUSL — Business Logic", q:"What does WSTG-BUSL-01 test regarding business logic data validation?", a:"Whether the application validates data against business rules, not just technical format.", d:["Whether the database schema enforces foreign key constraints on all table relations.", "Whether HTML form elements use the correct input type attributes for every field.", "Whether the API documentation accurately describes every endpoint's expected payload."], e:"WSTG-BUSL-01 tests whether the application enforces business-level data validation (e.g., preventing negative quantities in a cart) beyond simple type/format checking."},
{c:"BUSL — Business Logic", q:"What does testing the ability to forge requests (WSTG-BUSL-02) assess?", a:"Whether an attacker can craft requests that bypass expected application workflow steps.", d:["Whether the server correctly handles HTTP/2 push promise frames from the client side.", "Whether the application rate limiter applies consistently to all endpoints and assets.", "Whether the WAF has rules specifically for JSON payload inspection and blocking."], e:"WSTG-BUSL-02 tests whether attackers can create or modify requests to circumvent business validations, such as submitting a zero-value payment for a purchase."},
{c:"BUSL — Business Logic", q:"Why is testing integrity checks important according to WSTG-BUSL-03?", a:"To verify the application detects and rejects tampered data throughout transactions.", d:["To confirm the application uses checksums when writing entries to the audit log file.", "To validate the backup system creates byte-identical copies of the database each night.", "To ensure the CDN delivers unmodified versions of all cached JavaScript resource files."], e:"WSTG-BUSL-03 tests whether the application validates data integrity throughout workflows, detecting tampered prices, quantities, or discounts between steps."},
{c:"BUSL — Business Logic", q:"What type of flaw does WSTG-BUSL-04 (process timing) aim to identify?", a:"Race conditions and time-of-check to time-of-use (TOCTOU) exploitable windows.", d:["Slow page rendering caused by unoptimised database queries that take too long.", "Network latency between the client browser and the geographically distant server.", "Scheduled maintenance windows that overlap with peak user activity time periods."], e:"WSTG-BUSL-04 tests for race conditions where timing between validation and action can be exploited, such as redeeming a single-use coupon from two sessions simultaneously."},
{c:"BUSL — Business Logic", q:"What does WSTG-BUSL-05 test regarding function usage limits?", a:"Whether the application enforces limits on how many times a function can be executed.", d:["Whether the server has enough CPU cores to handle concurrent function call requests.", "Whether the application licence restricts the total number of registered user accounts.", "Whether the database connection pool is sized to support the expected query volume."], e:"WSTG-BUSL-05 tests whether functions have proper limits (e.g., one coupon per user, one vote per poll) and whether these can be bypassed."},
{c:"BUSL — Business Logic", q:"What does testing for workflow circumvention (WSTG-BUSL-06) involve?", a:"Attempting to skip steps in a multi-stage process and reach later stages directly.", d:["Measuring the average time each user spends on every step of the registration flow.", "Documenting the complete sequence of UI screens displayed in the workflow diagram.", "Profiling the server-side memory allocation during each step of the checkout process."], e:"WSTG-BUSL-06 tests whether attackers can skip steps (e.g., jumping from product selection to order confirmation, bypassing payment in a checkout)."},
{c:"BUSL — Business Logic", q:"What does WSTG-BUSL-07 assess regarding defences against application misuse?", a:"Whether the application detects and responds to patterns of abusive or malicious usage.", d:["Whether the application prevents users from bookmarking pages containing form fields.", "Whether the application blocks users from opening multiple browser tabs at the same.", "Whether the application restricts users from copying text content from the page display."], e:"WSTG-BUSL-07 tests whether the application detects and responds to abuse patterns like excessive account creation, automated scraping, or systematic probing."},
{c:"BUSL — Business Logic", q:"What does WSTG-BUSL-08 test regarding file upload restrictions?", a:"Whether the application properly restricts uploads to only expected and safe file types.", d:["Whether uploaded files are automatically converted to PDF format for standardisation.", "Whether the upload progress bar accurately reflects the current transfer percentage.", "Whether the maximum file upload size matches the value documented in the help guide."], e:"WSTG-BUSL-08 tests whether upload restrictions can be bypassed by changing extensions, manipulating MIME types, or uploading files processed in dangerous ways."},
{c:"BUSL — Business Logic", q:"What makes business logic vulnerabilities particularly hard for automated scanners to detect?", a:"They depend on application-specific rules that scanners cannot infer from generic tests.", d:["Automated scanners lack the network bandwidth to test every single application page.", "Automated scanners are blocked by CAPTCHA challenges on every form submission page.", "Automated scanners can only test applications written in the Java programming language."], e:"Business logic flaws are unique to each application's rules and workflows, making them invisible to generic scanners that test for known technical vulnerability patterns."},
{c:"BUSL — Business Logic", q:"A tester modifies a hidden field to change a product price from 100 to 1 and completes the purchase. Which WSTG test applies?", a:"WSTG-BUSL-01 (business logic data validation) for client-side price tampering.", d:["WSTG-INPT-05 (SQL injection) for directly manipulating the database price column.", "WSTG-ATHN-04 (authentication bypass) for accessing the checkout without logging in.", "WSTG-SESS-05 (CSRF) for forging a cross-site purchase request from another domain."], e:"Modifying a hidden price field is a business logic data validation flaw — the server should validate the price server-side rather than trusting client-submitted values."},

// --- 4.11 CLIENT-SIDE (WSTG-CLNT) — 10 questions ---
{c:"CLNT — Client-side Testing", q:"What distinguishes DOM-based XSS (WSTG-CLNT-01) from reflected and stored XSS?", a:"The payload is processed entirely by client-side JavaScript without reaching the server.", d:["The payload is stored permanently in the server's relational database for later recall.", "The payload is reflected in the server's HTTP response headers rather than the body.", "The payload requires the attacker to have direct SSH access to the application server."], e:"DOM-based XSS occurs when client-side JS processes user input (URL fragments, document.referrer) and writes it to the DOM unsafely, without the payload reaching the server."},
{c:"CLNT — Client-side Testing", q:"What does testing for clickjacking (WSTG-CLNT-09) verify?", a:"Whether the application can be loaded in an iframe to trick users into invisible clicks.", d:["Whether the application buttons have sufficient padding for mobile touch target sizes.", "Whether the application click event handlers fire within an acceptable time delay.", "Whether the application interactive elements meet colour contrast accessibility ratios."], e:"WSTG-CLNT-09 tests whether X-Frame-Options or CSP frame-ancestors prevent attackers from loading the site in a transparent iframe overlay."},
{c:"CLNT — Client-side Testing", q:"When testing browser storage (WSTG-CLNT-12), what should a tester examine?", a:"Whether localStorage, sessionStorage, or IndexedDB contain sensitive data in cleartext.", d:["Whether the browser supports the latest ECMAScript standard for JavaScript execution.", "Whether the browser cache size is configured to an appropriate limit for the device.", "Whether the browser extension marketplace offers a compatible password manager option."], e:"WSTG-CLNT-12 tests whether sensitive information (tokens, credentials, PII) is stored insecurely in browser storage mechanisms accessible to JavaScript."},
{c:"CLNT — Client-side Testing", q:"What does testing for CSS injection (WSTG-CLNT-05) aim to identify?", a:"Whether user input can modify CSS to exfiltrate sensitive data or alter page appearance.", d:["Whether the application's stylesheet is properly minified and bundled for production.", "Whether the CSS framework version is up-to-date with the latest security patch release.", "Whether the application passes W3C CSS validation without any syntax error warnings."], e:"WSTG-CLNT-05 tests whether CSS injection can exfiltrate data (via attribute selectors), deface content, or manipulate the UI for phishing purposes."},
{c:"CLNT — Client-side Testing", q:"What does testing cross-origin resource sharing (WSTG-CLNT-07) assess?", a:"Whether CORS headers are misconfigured to allow unintended cross-origin data access.", d:["Whether the application images are served from a content delivery network location.", "Whether the application JavaScript files include valid source map URL annotations.", "Whether the application uses HTTP/2 server push for critical rendering path assets."], e:"WSTG-CLNT-07 tests CORS for overly permissive Access-Control-Allow-Origin headers, reflected origins, null origin allowance, and wildcard configurations with credentials."},
{c:"CLNT — Client-side Testing", q:"What security concerns does the WSTG raise about WebSocket connections (WSTG-CLNT-10)?", a:"WebSockets may lack authentication, encryption, or input validation after the handshake.", d:["WebSockets are always encrypted by default and require no additional security measures.", "WebSockets cannot transmit binary data and are therefore completely immune to injection.", "WebSockets are automatically terminated after sixty seconds by all major browser engines."], e:"WSTG-CLNT-10 highlights that WebSocket connections may lack ongoing authentication, origin validation, input sanitisation, and may not use WSS (encrypted WebSockets)."},
{c:"CLNT — Client-side Testing", q:"What does testing for web messaging (WSTG-CLNT-11) examine?", a:"Whether the application validates the origin and content of postMessage communications.", d:["Whether the application uses web workers for running background computational tasks.", "Whether the application implements service workers for offline page caching features.", "Whether the application supports push notifications through the browser Notification API."], e:"WSTG-CLNT-11 tests whether postMessage event listeners validate the origin parameter and sanitise received data to prevent cross-origin XSS."},
{c:"CLNT — Client-side Testing", q:"What is Cross-Site Script Inclusion (XSSI) as described by the WSTG (WSTG-CLNT-13)?", a:"Including a cross-origin script tag that returns sensitive data accessible to the attacker.", d:["Loading a JavaScript library from a CDN to add interactive features to the web pages.", "Embedding a third-party analytics tracking pixel in the application footer template.", "Importing a CSS framework stylesheet from an external content delivery network URL."], e:"WSTG-CLNT-13 describes XSSI where an attacker includes a cross-origin script tag returning dynamic JS containing sensitive data, which the attacker's page can access."},
{c:"CLNT — Client-side Testing", q:"When testing for client-side URL redirect (WSTG-CLNT-04), what is the main risk?", a:"Users can be redirected to malicious sites via manipulated URL parameters or DOM values.", d:["The application internal page navigation breaks and stops working for all visitors.", "The browser address bar displays an incorrect favicon for the currently loaded page.", "The application server-side routing table becomes corrupted by invalid URL patterns."], e:"WSTG-CLNT-04 tests whether client-side redirects (window.location) use unsanitised user input, enabling phishing by redirecting users to attacker-controlled sites."},
{c:"CLNT — Client-side Testing", q:"What headers should be checked when assessing clickjacking protection?", a:"X-Frame-Options (DENY or SAMEORIGIN) or the CSP frame-ancestors directive.", d:["X-Content-Type-Options set to nosniff to prevent browser MIME type sniffing.", "X-XSS-Protection set to 1; mode=block to enable the browser XSS audit filter.", "Referrer-Policy set to no-referrer to prevent referrer information leakage."], e:"Clickjacking prevention requires X-Frame-Options (DENY/SAMEORIGIN) or CSP frame-ancestors, which control whether the page can be embedded in frames on other sites."},

// --- 4.12 API TESTING (WSTG-APIT) — 4 questions ---
{c:"APIT — API Testing", q:"What specific API technology does the WSTG dedicate a test scenario to (WSTG-APIT-01)?", a:"GraphQL, covering its unique attack surface including introspection and query abuse.", d:["gRPC, covering its binary protocol serialisation and HTTP/2 transport layer security.", "SOAP, covering its XML-based messaging format and WSDL service description documents.", "REST, covering its resource-oriented architecture and stateless HTTP-based interactions."], e:"WSTG-APIT-01 specifically covers testing GraphQL, including introspection queries, excessive data exposure, injection in queries, and denial of service through nested queries."},
{c:"APIT — API Testing", q:"According to the WSTG, why is GraphQL introspection a security concern?", a:"Introspection exposes the entire schema including all types, fields, and relationships.", d:["Introspection allows clients to execute arbitrary SQL queries against the backend database.", "Introspection automatically disables all authentication checks on the GraphQL endpoint.", "Introspection forces the server to return all database records from every table at once."], e:"GraphQL introspection queries (__schema, __type) expose the complete API schema, revealing all types, fields, mutations, and relationships, aiding attacker reconnaissance."},
{c:"APIT — API Testing", q:"What denial of service risk specific to GraphQL does the WSTG describe?", a:"Deeply nested or complex queries that consume excessive server resources to resolve.", d:["Sending extremely large numbers of HTTP OPTIONS preflight requests every second.", "Uploading binary files that exceed the maximum content length configured on the CDN.", "Establishing thousands of idle TCP connections to exhaust the server socket pool."], e:"GraphQL's flexible query language allows attackers to craft deeply nested queries (e.g., recursive relationships) that consume excessive CPU and memory on the server."},
{c:"APIT — API Testing", q:"What should be tested regarding GraphQL mutation operations according to the WSTG?", a:"Whether mutations enforce proper authorisation and input validation on all operations.", d:["Whether mutations return responses formatted in XML instead of the standard JSON.", "Whether mutations are logged to a separate database from the one used for queries.", "Whether mutations automatically trigger a full re-index of the search engine cluster."], e:"The WSTG recommends testing that GraphQL mutations enforce authorisation (preventing unauthorised data modification) and validate all input to prevent injection attacks."}
];

const TOTAL = 120;

function shuffle(arr) {
    for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
}

let examQs = [], curr = 0, answered = {}, userAns = {}, flagged = {};

function initExam() {
    examQs = shuffle([...allQuestions]).slice(0, TOTAL);
    curr = 0; answered = {}; userAns = {}; flagged = {};

    examQs.forEach((q, i) => {
        const opts = shuffle([q.a, ...q.d]);
        examQs[i]._opts = opts;
    });

    document.getElementById('start-screen').style.display='none';
    document.getElementById('results-screen').style.display='none';
    document.getElementById('exam-ui').style.display='flex';
    document.getElementById('footer').style.display='flex';

    renderSide(); loadQ(0); updateProgress();
}

function updateProgress() {
    const cnt = Object.keys(answered).length;
    document.getElementById('progress-display').innerText = cnt + ' / ' + TOTAL;
    document.getElementById('finish-btn').style.display = cnt === TOTAL ? 'inline-block' : 'none';
}

function renderSide() {
    const sb = document.getElementById('sidebar'); sb.innerHTML='';
    examQs.forEach((q,i) => {
        const b = document.createElement('button');
        b.className = 'nav-btn'; b.innerText = i+1;
        b.id = 'nav-' + i; b.onclick = () => loadQ(i);
        sb.appendChild(b);
    });
}

function loadQ(i) {
    curr = i;
    const q = examQs[i];

    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
    document.getElementById('nav-' + i).classList.add('active');
    document.getElementById('status').innerText = 'Q ' + (i+1) + ' / ' + TOTAL;

    const con = document.getElementById('question-container'); con.innerHTML='';
    const card = document.createElement('div'); card.className='card';

    let html = '<div class="q-meta"><span class="tag">' + q.c + '</span><span class="q-num">#' + (i+1) + '</span></div><div class="q-text">' + q.q + '</div>';

    const isAnswered = answered[i] !== undefined;

    q._opts.forEach((o, oi) => {
        let cls = 'option';
        if (isAnswered) {
            cls += ' locked';
            if (o === q.a) cls += ' opt-correct';
            else if (o === userAns[i]) cls += ' opt-wrong';
            else cls += ' opt-dim';
        }
        const clickHandler = isAnswered ? '' : 'onclick="ans(' + i + ',' + oi + ')"';
        html += '<div class="' + cls + '" ' + clickHandler + '>' + o + '</div>';
    });

    if (isAnswered) {
        const wasCorrect = userAns[i] === q.a;
        html += '<div class="explanation-box"><strong>' + (wasCorrect ? '\u2713 Correct' : '\u2717 Incorrect') + '</strong><br>' + q.e + '</div>';
        if (i < TOTAL - 1) {
            html += '<div class="next-btn-wrap"><button class="btn btn-p" onclick="loadQ(' + (i+1) + ')">Next Question \u2192</button></div>';
        }
    }

    card.innerHTML = html; con.appendChild(card);
    con.scrollTop = 0;
}

function ans(qi, optIdx) {
    const q = examQs[qi];
    userAns[qi] = q._opts[optIdx];
    answered[qi] = true;

    const navBtn = document.getElementById('nav-' + qi);
    if (userAns[qi] === q.a) {
        navBtn.classList.add('answered-correct');
    } else {
        navBtn.classList.add('answered-wrong');
    }

    loadQ(qi);
    updateProgress();
}

function nav(d) {
    const n = curr + d;
    if(n >= 0 && n < TOTAL) loadQ(n);
}

function flag() {
    flagged[curr] = !flagged[curr];
    const b = document.getElementById('nav-' + curr);
    if(flagged[curr]) b.classList.add('flagged'); else b.classList.remove('flagged');
}

function finish() {
    if(!confirm('Finish the quiz and see your results?')) return;
    document.getElementById('exam-ui').style.display='none';
    document.getElementById('footer').style.display='none';

    const resScreen = document.getElementById('results-screen');
    resScreen.style.display='block';
    resScreen.scrollTop = 0;

    let score = 0;
    let html = '';

    examQs.forEach((q, i) => {
        const correct = userAns[i] === q.a;
        if(correct) score++;
        html += '<div class="review-item ' + (correct?'correct':'wrong') + '">' +
            '<strong>Q' + (i+1) + ' [' + q.c + ']: ' + q.q + '</strong><br>' +
            'Your Answer: <b style="color:' + (correct?'#4ade80':'#f87171') + '">' + (userAns[i]||'Skipped') + '</b><br>' +
            (!correct ? 'Correct Answer: <b style="color:#4ade80">' + q.a + '</b>' : '') +
            '<div class="review-explanation">Rationale: ' + q.e + '</div>' +
        '</div>';
    });

    const pct = Math.round((score/TOTAL)*100);

    document.getElementById('score-circle').innerText = pct + '%';
    document.getElementById('raw-score').innerText = 'You answered ' + score + ' out of ' + TOTAL + ' questions correctly.';
    document.getElementById('review-list').innerHTML = html;
}
</script>
</body>
</html>
